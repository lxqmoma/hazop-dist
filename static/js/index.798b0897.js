(()=>{"use strict";var e={92955:function(){},68171:function(){},47164:function(e,l,a){a.d(l,{WU:()=>m,Xs:()=>u,rB:()=>r,sD:()=>s,yE:()=>d});var t=a(71342);let o="https://bj-dev.oberyun.com",n="/obrapi/LoginService",i={isProjectId:!1},d=e=>(0,t.Ko)(`${o}${n}/login/loginByPuzzle`,e,{isToken:!1,isProjectId:!1}),u=()=>(0,t.kA)(`${o}${n}/login/captchaImage`,{},{isToken:!1,isProjectId:!1}),r=()=>(0,t.kA)(`${o}${n}/login/logout`,{},i),s=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(0,t.kA)("/resource/getToken",{ifEncipher:e,ifPrivate:l},i)},m=e=>(0,t.Ko)("/resource/upload",e,{isProjectId:!1})},10475:function(e,l,a){a.d(l,{HT:()=>u,Ns:()=>n,OK:()=>d,Wn:()=>o,he:()=>i,iT:()=>r,in:()=>m,tx:()=>s});var t=a(71342);let o=e=>(0,t.e8)("/summary/update",e),n=()=>(0,t.kA)("/summary/get"),i=()=>(0,t.kA)("/summary/getChemicalHazardPropertyTitle"),d=()=>(0,t.kA)("/summary/getChemicalHazardPropertyData"),u=e=>(0,t.Ko)("/summary/saveRow",e),r=e=>(0,t.P3)(`/summary/deleteRow/${e}`),s=e=>(0,t.Ko)("/summary/saveTitle",e),m=e=>(0,t.P3)(`/summary/deleteTitle/${e}`)},35214:function(e,l,a){a.d(l,{AP:()=>n,GV:()=>r,P2:()=>o,Tz:()=>d,cI:()=>i,sk:()=>u});var t=a(71342);let o=e=>(0,t.Ko)("/device/add",e),n=e=>(0,t.Ko)("/device/delete",e),i=e=>(0,t.e8)("/device/edit",e),d=e=>(0,t.kA)(`/device/queryById/${e}`),u=e=>(0,t.Ko)("/device/page",e),r=()=>(0,t.kA)("/device/queryAll")},27900:function(e,l,a){a.d(l,{Dq:()=>d,K:()=>i,uc:()=>o,y5:()=>n});var t=a(71342);let o=e=>(0,t.Ko)("/guideword/edit",e),n=e=>(0,t.Ko)("/guideword/add",e),i=e=>(0,t.Ko)("/guideword/delete",e),d=e=>(0,t.Ko)("/guideword/queryPageList",e)},10043:function(e,l,a){a.d(l,{F4:()=>d,Fz:()=>g,GA:()=>m,Ne:()=>h,Rk:()=>n,S0:()=>o,S8:()=>S,TI:()=>c,TO:()=>W,Wu:()=>b,_Z:()=>U,_c:()=>i,_e:()=>u,fy:()=>v,hg:()=>k,hj:()=>s,jW:()=>V,ps:()=>r,qT:()=>p,tV:()=>_,uD:()=>f,uV:()=>w,v9:()=>y,yD:()=>x});var t=a(71342);let o=e=>(0,t.Ko)("/matrix/add",e),n=()=>(0,t.kA)("/matrix/list"),i=e=>(0,t.e8)("/matrix/edit",e),d=e=>(0,t.Ko)("/matrix/delete",e),u=e=>(0,t.e8)(`/project/updateMatrix/${e}`),r=e=>(0,t.kA)(`/matrix/getMatrixData/${e}`),s=e=>(0,t.e8)("/matrix/updateMatrixData",e),m=e=>(0,t.Ko)("/riskGrade/add",e),c=e=>(0,t.Ko)("/riskGrade/delete",e),p=e=>(0,t.e8)("/riskGrade/edit",e),f=e=>(0,t.kA)(`/riskGrade/list/${e}`),v=(e,l)=>(0,t.kA)(`/riskGrade/list/${e}?projectId=${l}`,{isProjectId:!1}),w=e=>(0,t.kA)(`/riskGrade/getById/${e}`),y=e=>(0,t.Ko)("/frequencySetting/add",e),g=e=>(0,t.Ko)("/frequencySetting/delete",e),h=e=>(0,t.Ko)("/frequencySetting/edit",e),U=e=>(0,t.kA)(`/frequencySetting/list/${e}`),_=e=>(0,t.kA)(`/frequencySetting/queryById/${e}`),k=e=>(0,t.kA)(`/severitySetting/getSeveritySettingTitle/${e}`),b=e=>(0,t.Ko)("/severitySetting/saveTitle",e),S=(e,l)=>(0,t.P3)(`/severitySetting/deleteTitle/${e}/${l}`),W=e=>(0,t.kA)(`/severitySetting/getSeveritySettingRow/${e}`),V=e=>(0,t.Ko)("/severitySetting/saveRow",e),x=e=>(0,t.P3)(`/severitySetting/deleteRow/${e}`)},74623:function(e,l,a){a.d(l,{$y:()=>i,Hi:()=>d,Ho:()=>u,ft:()=>r,jc:()=>o,zz:()=>n});var t=a(71342);let o=e=>(0,t.Ko)("/meeting/add",e),n=e=>(0,t.Ko)("/meeting/delete",e),i=e=>(0,t.e8)("/meeting/edit",e),d=()=>(0,t.kA)("/meeting/list"),u=e=>(0,t.kA)(`/meeting/queryById/${e}`),r=e=>(0,t.kA)(`/meeting/participants/${e}`)},39908:function(e,l,a){a.d(l,{Kr:()=>i,OW:()=>d,VJ:()=>n,oE:()=>o});var t=a(71342);let o=e=>(0,t.Ko)("/parameter/edit",e),n=e=>(0,t.Ko)("/parameter/add",e),i=e=>(0,t.Ko)("/parameter/delete",e),d=e=>(0,t.Ko)("/parameter/queryPageList",e)},95974:function(e,l,a){a.d(l,{Di:()=>p,Op:()=>n,Px:()=>m,UL:()=>r,XZ:()=>s,jW:()=>o,mv:()=>u,o_:()=>i,w4:()=>c,xS:()=>d});var t=a(71342);let o=e=>(0,t.Ko)("/person/add",e),n=e=>(0,t.Ko)("/person/delete",e),i=e=>(0,t.e8)("/person/edit",e),d=e=>(0,t.kA)(`/person/query/${e}`),u=e=>(0,t.Ko)("/person/queryPage",e),r=e=>(0,t.kA)(`/person/queryAll/${e}`),s=e=>(0,t.Ko)("/company/add",e),m=e=>(0,t.P3)(`/company/delete/${e}`),c=e=>(0,t.e8)("/company/edit",e),p=()=>(0,t.kA)("/company/getAll")},36186:function(e,l,a){a.d(l,{B1:()=>d,C2:()=>f,Cq:()=>p,El:()=>c,TA:()=>r,_Y:()=>i,aT:()=>n,co:()=>o,dB:()=>h,f:()=>g,gs:()=>m,iX:()=>_,j0:()=>W,jv:()=>u,lx:()=>b,mw:()=>w,o6:()=>v,qn:()=>k,rM:()=>S,sY:()=>y,vf:()=>s,vi:()=>U});var t=a(71342);let o=e=>(0,t.Ko)("/analyse/addNode",e),n=e=>(0,t.Ko)("/analyse/addRelationship",e),i=e=>{let{startNodeId:l,endNodeId:a}=e;return(0,t.P3)(`/analyse/deleteRelationship/${l}/${a}`)},d=e=>(0,t.P3)(`/analyse/deleteNode/${e}`),u=e=>(0,t.Ko)("/analyse/addMasterNode",e),r=e=>(0,t.e8)("/analyse/updateMasterNode",e),s=e=>(0,t.P3)(`/analyse/deleteMasterNode/${e}`),m=e=>(0,t.kA)(`/analyse/getMasterNode/${e}`),c=e=>(0,t.kA)(`/analyse/getGraph/${e}`),p=e=>(0,t.Ko)("/analyse/getIncompletePaths",e),f=e=>(0,t.Ko)("/analyse/updateNodeCoordinates",e),v=e=>(0,t.e8)("/analyse/updateCause",e),w=e=>(0,t.kA)(`/analyse/getCause/${e}`),y=e=>(0,t.e8)("/analyse/updateDeviation",e),g=e=>(0,t.kA)(`/analyse/getDeviation/${e}`),h=e=>(0,t.e8)("/analyse/updateConsequence",e),U=e=>(0,t.kA)(`/analyse/getConsequence/${e}`),_=()=>(0,t.kA)("/analyse/getHazopNodeTree"),k=e=>(0,t.kA)(`/analyse/getHazopSingleEventPath/${e}`),b=e=>(0,t.kA)(`/analyse/getHazopSingleNodePath/${e}`),S=e=>(0,t.kA)("/analyse/getHazopProjectRiskAnalysis",e),W=e=>(0,t.Ko)("/analyse/convertToLopa",e)},35373:function(e,l,a){a.d(l,{KD:()=>i,Y9:()=>d,_Z:()=>o,a0:()=>u,c9:()=>r,yp:()=>n});var t=a(71342);let o=e=>(0,t.Ko)("/causeKnowledge/add",e),n=e=>(0,t.Ko)("/causeKnowledge/delete",e),i=e=>(0,t.e8)("/causeKnowledge/edit",e),d=e=>(0,t.kA)("/causeKnowledge/queryAll",e),u=e=>(0,t.Ko)("/causeKnowledge/queryByPage",e),r=e=>(0,t.kA)(`/causeKnowledge/query/${e}`)},27140:function(e,l,a){a.d(l,{JF:()=>o,Mo:()=>u,Op:()=>i,TE:()=>n,wu:()=>r,z9:()=>d});var t=a(71342);let o=e=>(0,t.Ko)("/adverseConsequencesKnowledge/add",e),n=e=>(0,t.Ko)("/adverseConsequencesKnowledge/delete",e),i=e=>(0,t.e8)("/adverseConsequencesKnowledge/edit",e),d=e=>(0,t.kA)("/adverseConsequencesKnowledge/queryAll",e),u=e=>(0,t.Ko)("/adverseConsequencesKnowledge/queryPage",e),r=e=>(0,t.kA)(`/adverseConsequencesKnowledge/queryById/${e}`)},22570:function(e,l,a){a.d(l,{$b:()=>i,M8:()=>n,MX:()=>u,PP:()=>r,pc:()=>o,rf:()=>d});var t=a(71342);let o=e=>(0,t.Ko)("/securityMeasuresKnowledge/add",e),n=e=>(0,t.Ko)("/securityMeasuresKnowledge/delete",e),i=e=>(0,t.e8)("/securityMeasuresKnowledge/edit",e),d=e=>(0,t.kA)("/securityMeasuresKnowledge/queryAll",e),u=e=>(0,t.Ko)("/securityMeasuresKnowledge/queryPage",e),r=e=>(0,t.kA)(`/securityMeasuresKnowledge/query/${e}`)},83689:function(e,l,a){a.d(l,{Ai:()=>i,CZ:()=>r,Ot:()=>u,RN:()=>d,SU:()=>s,V6:()=>m,b7:()=>n,uJ:()=>o});var t=a(71342);let o=()=>(0,t.kA)("/analyse/getLopaTree"),n=e=>(0,t.kA)(`/analyse/getLopaSingleEventPath/${e}`),i=e=>(0,t.kA)(`/analyse/getLopaSingleNodePath/${e}`),d=()=>(0,t.kA)("/analyse/getLopaProjectRiskAnalysis"),u=(e,l)=>(0,t.kA)(`/riskAnalysisHistory/getHistory/${e}/${l}`),r=e=>(0,t.kA)(`/nodeSafetyPrecautions/getByNodeId/${e}`),s=(e,l)=>(0,t.Ko)(`/nodeSafetyPrecautions/modify/${l}`,e),m=e=>(0,t.Ko)("/nodeSafetyPrecautions/getByNodeIds",e)},57032:function(e,l,a){a.d(l,{d:()=>s});var t=a(35214),o=a(10043),n=a(74623),i=a(39908),d=a(95974),u=a(9286),r=a(35017);function s(){let e=(0,u.F)(),l=(0,r.a)(),a=async()=>{try{let e=await (0,n.Hi)();if(200===e.code){let a=e.result||[];l.setList(a,"meeting")}let a=await (0,d.UL)(2);if(200===a.code){let e=a.result||[];l.setList(e,"staff")}let o=await (0,t.GV)();if(200===o.code){let e=o.result||[];l.setList(e,"device")}}catch(e){}},s=async()=>{try{let a=await (0,o._Z)(e.matrixType);if(200===a.code){let e=a.result||[];e.forEach(e=>{e.name=e.frequency,e.value=e.id}),l.setList(e,"frequency")}let t={pageNo:1,pageSize:200,projectId:e.itemsType},n=await (0,i.OW)(t);if(200===n.code){let e=n.result.records||[];l.setList(e,"params")}}catch(e){}},m=async()=>{let a=e.matrixType;try{let e=null,t=await (0,o.hg)(a);if(200===t.code){let a=t.result||{},o=[];Object.entries(a).forEach(l=>{let[a,t]=l;["坐标值","严重性"].includes(t)?"严重性"===t&&(e=a):o.push({key:a,value:t})}),l.setList(o,"severityTitle")}let n=await (0,o.TO)(a);if(200===n.code){let a=(n.result||[]).map(l=>({key:l.rowId,value:l[e]}));l.setList(a,"severityLevel")}}catch(e){}},c=async()=>{l.hasBase&&await a(),l.hasSet&&await s(),l.hasCustom&&await m()};return{configStore:e,dataStore:l,baseData:c}}},7061:function(e,l,a){a.d(l,{V:()=>w});var t=a(38551),o=a(47164),n=a(97562),i=a(85674),d=a(53375),u=a.n(d),r=a(16483),s=a.n(r),m=a(79321);a(34847);let c={audio:{format:["mp3","wav"],size:0x6400000,sizeName:"100M",rootPath:"/Audio/"},video:{format:["mp4"],size:0x80000000,sizeName:"2G",rootPath:"/Video/"},image:{format:["jpg","jpeg","png"],size:0xa00000,sizeName:"10M",rootPath:"/Image/"},application:{format:["pdf","ppt","pptx","doc","docx","xls","xlsx"],size:0xc800000,sizeName:"200M",rootPath:"/Document/"}};async function p(e,l){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{file:t,fileName:o,rootPath:n,suffixName:i,fileSize:d,fileMd5:r,uFileName:p}=a?function(e){var l;let a=null==e?void 0:e.size,t=null==e?void 0:e.type.split("/")[0],o=e.name.toLowerCase(),n=o.lastIndexOf("."),i=e.name.substring(0,n),d=o.substring(n+1),u=o.substring(0,n),r=s()().format("YYYY/MM/DD"),p=(null==(l=c[t])?void 0:l.rootPath)||"/",f=`${(0,m.x0)()}.${d}`;return{file:e,fileMd5:"",fileSize:a,fileType:t,fileName:o,uFileName:f,rawFileName:i,suffixName:d,prefixName:u,rootPath:`/Hazop${p}${r}/`}}(e):function(e){let{file:l,fileName:a}=e,t=s()().format("YYYY/MM/DD"),o=`/Hazop/Image/${t}/`,n=a.lastIndexOf("."),i=a.substring(n+1);return{file:l,fileSize:0,rootPath:o,fileName:a,suffixName:i,uFileName:`${(0,m.x0)()}.${i}`,relativePathName:a,fileMd5:""}}(e),f=`${n}${a?p:o}`;try{let{client:e}=function(e){let{accessKeySecret:l,accessKeyId:a,bucket:t,endpoint:o,securityToken:n}=e;return{client:new(u())({endpoint:o,accessKeyId:a,accessKeySecret:l,bucket:t,stsToken:n,secure:!0,cname:!0,refreshSTSTokenInterval:36e5}),endpoint:o}}(l),{res:a,url:n}=await e.put(f,t);if(200===a.statusCode)return{fileName:o,suffixName:i,size:d,fileMd5:r,sourceUrl:n};throw Error("上传失败")}catch(e){return}}var f=a(65754);let v=(0,n.L)();function w(){let e=(0,f.qj)({backgroundcolor:"#fff",quality:1,skipAutoScale:!0}),l=async()=>{try{let e=await (0,o.sD)();if(200===e.code){let l=e.result;return(0,i.DJ)(l,v.oss.k,v.oss.v)}}catch(e){throw Error("获取签名失败")}};return{fileUpload:async function(e){let a=!(arguments.length>1)||void 0===arguments[1]||arguments[1];try{let t=await l(),n=await p(e,t,!0);if(!a)return n;let i=await (0,o.WU)(n);if(200===i.code){let e=i.result||"";return{...n,fileId:e}}return null}catch(e){throw Error("上传失败")}},snapUpload:async(a,n)=>{try{let i=await l(),d=await (0,t.SE)(a,e),u=await p({file:d,fileName:n},i),r=await (0,o.WU)(u);if(200===r.code)return u.sourceUrl;return null}catch(e){}}}}},92094:function(e,l,a){var t=a(65754),o=a(70946),n=a(23931),i=a(83806);let d=(0,t.aZ)({__name:"App",setup(e){let l=(0,t.XI)("medium");return(e,a)=>{let o=(0,t.up)("router-view"),d=n.Z;return(0,t.wg)(),(0,t.j4)(d,{global:"",locale:(0,t.SU)(i.Z),size:l.value},{default:(0,t.w5)(()=>[(0,t.Wm)(o)]),_:1},8,["locale","size"])}}});var u=a(34945),r=a(72024),s=a(56655),m=a(23490),c=a(97095),p=a(30530),f=a(12839),v=a(78459);let w=new(a.n(v)())({isCompression:!0}),y=(0,p.WB)();y.use((0,f.T)({key:e=>`hazop_${e}`,storage:{getItem:e=>w.get(e),setItem:(e,l)=>w.set(e,l),removeItem:e=>w.remove(e)}})),a(67358),a(15480),a(43363),a(95490);let g=(0,t.ri)(d);g.component("v-drawer",u.Z),g.component("v-modal",r.Z),g.component("v-table",s.Z),g.component("v-tree",m.Z),g.use(c.Z).use(y).use(o.Z).mount("#root")},97095:function(e,l,a){a.d(l,{Z:()=>X});var t=a(77504),o=a(29981),n=a.n(o),i=a(52979),d=a(9286),u=a(97562),r=a(65754),s=a(8163);let m=(0,s.default)({},[["render",function(e,l){let a=(0,r.up)("router-view");return(0,r.wg)(),(0,r.j4)(a)}]]);var c=a(43268);a(84595);var p=a(88795),f=a(46918);a(42105);var v=a(91643);a(43050);var w=a(92634),y=a(59643);a(30858);var g=a(4356);a(43363);var h=a(65250),U=a(40409),_=a(18593),k=a(2027);a(60651);var b=a(2421);a(3498);var S=a(30932),W=a(16483),V=a.n(W),x=a(47164);let Z=a.p+"static/svg/logo.bb4e1360.svg";var I=a(85674),H=a(30530),P=a(23565);let j={class:"ah-l"},z=["src"],q={class:"ah-r"},T=(0,r.aZ)({__name:"app-header",setup(e){let l=(0,i.yj)(),a=(0,i.tv)(),o=(0,u.L)(),n=(0,d.F)(),{itemsList:s}=(0,H.Jk)(n),m=(0,r.iH)(""),c=null,p=(0,r.Fl)(()=>o.user||{}),f=(0,r.Fl)(()=>n.itemsType),v=(0,r.Fl)(()=>"Dashboard"!==l.name);function W(e){n.setItemsType(e)}function T(){m.value=V()().format("YYYY-MM-DD HH:mm:ss")}function D(e){"/logout"===e?t.Z.open({title:"退出提示",content:"您即将退出系统登录，是否继续？",onOk:()=>void(0,x.rB)().then(()=>{o.$reset(),(0,I.gy)(!0),a.replace("/login")}).catch(()=>{P.Z.error("退出失败")})}):e!==l.path&&a.push(e)}return(0,r.bv)(()=>{T(),c=setInterval(T,1e3)}),(0,r.SK)(()=>{clearInterval(c)}),(e,l)=>{let a=S.Z,t=b.ZP,o=k.Z,n=_.Z,i=U.Z,d=h.Z,u=g.ZP,c=y.Z,V=w.Z;return(0,r.wg)(),(0,r.j4)(V,{class:"app-header"},{default:(0,r.w5)(()=>[(0,r._)("div",j,[(0,r._)("img",{src:(0,r.SU)(Z),alt:"logo",draggable:"false"},null,8,z),(0,r._)("span",null,(0,r.zw)((0,r.SU)("HAZOP 智能分析软件")),1)]),(0,r._)("div",q,[(0,r.Wm)(c,null,{default:(0,r.w5)(()=>[(0,r.Wm)(t,{style:{width:"200px"},"model-value":(0,r.SU)(f),placeholder:"请选择项目","allow-search":"",disabled:(0,r.SU)(v),onChange:W},{default:(0,r.w5)(()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)((0,r.SU)(s),e=>((0,r.wg)(),(0,r.j4)(a,{key:e.value,value:e.value},{default:(0,r.w5)(()=>[(0,r.Uk)((0,r.zw)(e.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["model-value","disabled"]),(0,r._)("time",null,(0,r.zw)((0,r.SU)(m)),1),(0,r.Wm)(u,{trigger:"hover",onSelect:D},{content:(0,r.w5)(()=>[(0,r.Wm)(i,{value:"/user"},{icon:(0,r.w5)(()=>[(0,r.Wm)(n)]),default:(0,r.w5)(()=>l[0]||(l[0]=[(0,r.Uk)(" 个人中心 ",-1)])),_:1}),(0,r.Wm)(i,{value:"/logout"},{icon:(0,r.w5)(()=>[(0,r.Wm)(d)]),default:(0,r.w5)(()=>l[1]||(l[1]=[(0,r.Uk)(" 退出登录 ",-1)])),_:1})]),default:(0,r.w5)(()=>[(0,r.Wm)(o,{class:"ahr-avatar",size:36},{default:(0,r.w5)(()=>[(0,r.Uk)((0,r.zw)((0,r.SU)(p).realname),1)]),_:1})]),_:1})]),_:1})])]),_:1})}}}),D=(0,s.default)(T,[["__scopeId","data-v-727bd75d"]]);var C=a(14409),F=a(47233);a(82938);var N=a(33615),E=a(40255),A=a(90553);let L=(0,r.aZ)({__name:"app-sider",setup(e){let l=(0,i.yj)(),a=(0,i.tv)(),t=(0,d.F)(),o=(0,r.iH)(18),n=(0,r.iH)(!1),u=(0,r.iH)([l.path]);(0,r.YP)(()=>l.path,e=>{var l;(l=e)!==u.value[0]&&(u.value=[l])});let s=(0,r.Fl)(()=>e=>Object.hasOwnProperty.call(e,"children")),m=(0,r.Fl)(()=>$.filter(e=>!e.hidden)),c=(e,l)=>l?`/${e}/${l}`:`/${e}`;function p(e){u.value[0]!==e&&(a.push(e),t.current||(e="/dashboard"),u.value[0]=e)}function f(e){n.value=e,t.changeFold(e)}return(0,r.bv)(()=>{n.value=t.fold}),(e,l)=>{let a=E.Z,t=N.Z,i=F.ZP,d=C.Z;return(0,r.wg)(),(0,r.j4)(d,{collapsible:"",collapsed:(0,r.SU)(n)},{default:(0,r.w5)(()=>[(0,r.Wm)(i,{collapsed:(0,r.SU)(n),"onUpdate:collapsed":l[0]||(l[0]=e=>(0,r.dq)(n)?n.value=e:null),class:"app-menu",accordion:"","auto-open-selected":"","show-collapse-button":"",breakpoint:"xl","popup-max-height":!1,"selected-keys":(0,r.SU)(u),onCollapse:f,onMenuItemClick:p},{default:(0,r.w5)(()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)((0,r.SU)(m),e=>((0,r.wg)(),(0,r.iD)(r.HY,{key:e.path},[(0,r.SU)(s)(e)?((0,r.wg)(),(0,r.j4)(t,{key:0,title:e.meta.name},{icon:(0,r.w5)(()=>[e.meta.icon?((0,r.wg)(),(0,r.j4)((0,r.LL)(A[e.meta.icon]),{key:0,size:(0,r.SU)(o)},null,8,["size"])):(0,r.kq)("",!0)]),default:(0,r.w5)(()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.children,l=>((0,r.wg)(),(0,r.j4)(a,{key:c(e.path,l.path)},{icon:(0,r.w5)(()=>[l.meta.icon?((0,r.wg)(),(0,r.j4)((0,r.LL)(A[l.meta.icon]),{key:0,size:(0,r.SU)(o)},null,8,["size"])):(0,r.kq)("",!0)]),default:(0,r.w5)(()=>[(0,r._)("span",null,(0,r.zw)(l.meta.name),1)]),_:2},1024))),128))]),_:2},1032,["title"])):((0,r.wg)(),(0,r.j4)(a,{key:c(e.path)},{icon:(0,r.w5)(()=>[e.meta.icon?((0,r.wg)(),(0,r.j4)((0,r.LL)(A[e.meta.icon]),{key:0,size:(0,r.SU)(o)},null,8,["size"])):(0,r.kq)("",!0)]),default:(0,r.w5)(()=>[(0,r._)("span",null,(0,r.zw)(e.meta.name),1)]),_:2},1024))],64))),128))]),_:1},8,["collapsed","selected-keys"])]),_:1},8,["collapsed"])}}}),M=(0,s.default)(L,[["__scopeId","data-v-1eaa3a14"]]),R=(0,r.aZ)({__name:"layout",setup:e=>(e,l)=>{let a=(0,r.up)("router-view"),t=v.Z,o=f.Z,n=p.Z,i=c.ZP;return(0,r.wg)(),(0,r.j4)(i,{class:"app-layout"},{default:(0,r.w5)(()=>[(0,r.Wm)(D),(0,r.Wm)(i,null,{default:(0,r.w5)(()=>[(0,r.Wm)(M),(0,r.Wm)(n,{class:"app-content"},{default:(0,r.w5)(()=>[(0,r.Wm)(t,{class:"app-backtop"},{default:(0,r.w5)(()=>[(0,r.Wm)(a)]),_:1}),(0,r.Wm)(o,{"target-container":".app-backtop"})]),_:1})]),_:1})]),_:1})}}),K=[{path:"user",name:"User",hidden:!0,component:()=>Promise.resolve().then(a.bind(a,46663))},{path:"/error",name:"NotFound",hidden:!0,component:()=>Promise.resolve().then(a.bind(a,33770))}],Y=[{path:"abstract",name:"BasicAbstract",meta:{name:"摘要",icon:"IconFile",mark:"录入项目基本信息"},component:()=>Promise.resolve().then(a.bind(a,76979))},{path:"staff",name:"BasicStaff",meta:{name:"人员",icon:"IconUserAdd",mark:"录入人员基本信息"},component:()=>Promise.resolve().then(a.bind(a,70658))},{path:"meeting",name:"BasicMeeting",meta:{name:"会议",icon:"IconUserGroup",mark:"创建会议流程"},component:()=>Promise.resolve().then(a.bind(a,72827))},{path:"params",name:"BasicParams",meta:{name:"参数",icon:"IconTool",mark:"添加分析所用参数"},component:()=>Promise.resolve().then(a.bind(a,52404))},{path:"guide",name:"BasicGuide",meta:{name:"引导词",icon:"IconBook",mark:""},component:()=>Promise.resolve().then(a.bind(a,60098))},{path:"deviate",name:"BasicDeviate",meta:{name:"偏离",icon:"IconFilter",mark:"筛选有效偏离"},component:()=>Promise.resolve().then(a.bind(a,79698))},{path:"device",name:"BasicDevice",meta:{name:"设备",icon:"IconDesktop",mark:"添加设备"},component:()=>Promise.resolve().then(a.bind(a,2330))},{path:"matrix",name:"BasicMatrix",meta:{name:"风险矩阵",icon:"IconMosaic",mark:"确认本项目的风险矩阵"},component:()=>Promise.resolve().then(a.bind(a,3249))},{path:"flow",name:"BasicFlow",meta:{name:"工艺流程图",icon:"IconRelation",mark:""},component:()=>Promise.resolve().then(a.bind(a,92640))}],O=[{path:"reason",name:"KnowledgeReason",meta:{name:"原因",icon:"IconQuestionCircle",mark:"常见初始原因知识库"},component:()=>Promise.resolve().then(a.bind(a,51956))},{path:"result",name:"KnowledgeResult",meta:{name:"不利后果",icon:"IconInfoCircle",mark:"常见不利后果知识库"},component:()=>Promise.resolve().then(a.bind(a,76599))},{path:"safety",name:"KnowledgeSafety",meta:{name:"安全措施",icon:"IconSafe",mark:"常见安全措施知识库"},component:()=>Promise.resolve().then(a.bind(a,31940))}],$=[{path:"dashboard",name:"Dashboard",meta:{name:"项目管理",icon:"IconApps"},component:()=>Promise.resolve().then(a.bind(a,8531))},{path:"basic",name:"Basic",meta:{name:"基本信息",icon:"IconLayers"},component:m,redirect:`basic/${Y[0].path}`,children:Y},{path:"hazop",name:"Hazop",meta:{name:"HAZOP分析",icon:"IconBranch"},component:()=>Promise.resolve().then(a.bind(a,82127))},{path:"lopa",name:"Lopa",meta:{name:"LOPA分析",icon:"IconLink"},component:()=>Promise.resolve().then(a.bind(a,73477))},{path:"knowledge",name:"Knowledge",meta:{name:"知识库",icon:"IconStorage"},component:m,redirect:`knowledge/${O[0].path}`,children:O},...K],B=[{path:"/login",name:"Login",component:()=>Promise.resolve().then(a.bind(a,5042))},{path:"/",name:"Layout",component:R,redirect:$[0].path,children:$},{path:"/:pathMatch(.*)",redirect:"/error"}];a(48858),n().configure({showSpinner:!1});let G=(0,i.p7)({history:(0,i.PO)(),routes:B,scrollBehavior:(e,l,a)=>a||{top:0},strict:!0});G.beforeEach(e=>{n().start();let l=(0,u.L)();return l.token&&"Login"===e.name?{name:"Dashboard"}:l.token||"Login"===e.name?!l||!!["/login","/dashboard","/user","/error"].includes(e.path)||!!(0,d.F)().itemsType||(t.Z.warning({title:"温馨提示",content:"请在顶部区域选择要管理的项目",maskClosable:!1,escToClose:!1}),{name:"Dashboard"}):{name:"Login"}}),G.afterEach(()=>{n().done()});let X=G},9286:function(e,l,a){a.d(l,{F:()=>t});let t=(0,a(30530).Q_)("config",{state:()=>({fold:!1,itemsList:[],itemsType:"",matrixList:[],matrixName:"",matrixType:"",status:{tree:!0,form:!0},levelList:[],levelColor:{},printList:[],printColor:{}}),actions:{changeFold(e){this.fold=e},setItemsList(e){this.itemsList=e,e.some(e=>e.value===this.itemsType)||(this.itemsType="")},setItemsType(e){let l=this.itemsList.find(l=>l.value===e);this.matrixType=(null==l?void 0:l.matrixId)||"",this.itemsType=e},setMatrixList(e){this.matrixList=e},setMatrixType(e){this.matrixName=null==e?void 0:e.name,this.matrixType=null==e?void 0:e.id},changeStatus(e,l){this.status[e]=l},changeColor(e){let l=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a={};e.length>0&&e.forEach(e=>a[e.id]=e.color),l?(this.printColor=a,this.printList=e):(this.levelColor=a,this.levelList=e)}},persist:!0})},35017:function(e,l,a){a.d(l,{a:()=>t});let t=(0,a(30530).Q_)("data",{state:()=>({meetingList:[],deviceList:[],staffList:[],hazopNodeList:[],nodeList:[],hazopNodeId:"",lopaNodeId:"",frequencyList:[],paramsList:[],severityTypeList:[],typeList:[],severityLevelList:[],levelList:[]}),getters:{hasBase:e=>{let l=0===e.deviceList.length,a=0===e.meetingList.length,t=0===e.staffList.length;return l||a||t},hasSet:e=>{let l=0===e.frequencyList.length,a=0===e.paramsList.length;return l||a},hasCustom:e=>{let l=0===e.severityTypeList.length,a=0===e.severityLevelList.length;return l||a}},actions:{setList(e,l){"meeting"===l?this.meetingList=e:"device"===l?this.deviceList=e:"staff"===l?this.staffList=e:"frequency"===l?this.frequencyList=e:"params"===l?this.paramsList=e.map(e=>({...e,value:e.id})):"severityTitle"===l?(this.severityTypeList=e,this.typeList=e.map(e=>({label:e.value,value:e.key}))):"severityLevel"===l&&(this.severityLevelList=e,this.levelList=e.map(e=>({label:e.value,value:e.key})))},setHazopList(e){this.hazopNodeList=e.map(e=>({...e,value:e.key})),this.hazopNodeId&&(e.some(e=>e.key===this.hazopNodeId)||(this.hazopNodeId=""));let l=e.map(e=>({name:`\u{8282}\u{70B9}${e.order}`,value:e.key,id:e.key}));this.nodeList=l},setHazopId(e){this.hazopNodeId=e},setLopaId(e){this.lopaNodeId=e}},persist:!0})},97562:function(e,l,a){a.d(l,{L:()=>t});let t=(0,a(30530).Q_)("user",{state:()=>({login:{k:"9765a7d1db2526d9",v:"kj8e61j8lj375094"},oss:{k:"2c2973d81279536cd1f62d2db9d1c060",v:"44e977845563bce5"},token:"",user:{}}),actions:{setToken(e){this.token=e},setUser(e){this.user=e}},persist:!0})},85674:function(e,l,a){a.d(l,{IA:()=>f,o4:()=>m,LP:()=>c,DJ:()=>v,gy:()=>p});var t=a(25778),o=a.n(t),n=a(21256),i=a(97095),d=a(9286),u=a(35017),r=a(97562);let s="GH_JWT";function m(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s;n.Z.set(l,e,{expires:7})}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return n.Z.get(e)}function p(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],l=(0,d.F)(),a=(0,u.a)(),t=(0,r.L)();l.$reset(),a.$reset(),t.$reset(),localStorage.clear(),sessionStorage.clear(),Object.keys(n.Z.get()).forEach(e=>n.Z.remove(e)),e&&i.Z.replace("/login")}function f(e,l,a){let t=o().enc.Utf8.parse(e),n=o().enc.Utf8.parse(l),i={iv:o().enc.Utf8.parse(a),mode:o().mode.CBC,padding:o().pad.ZeroPadding},d=o().AES.encrypt(t,n,i);return o().enc.Base64.stringify(d.ciphertext)}function v(e,l,a){let t=o().enc.Utf8.parse(l),n={iv:o().enc.Utf8.parse(a),mode:o().mode.CBC,padding:o().pad.Pkcs7},i=o().AES.decrypt(e,t,n);return JSON.parse(o().enc.Utf8.stringify(i))}},71342:function(e,l,a){a.d(l,{Ko:()=>m,P3:()=>p,e8:()=>c,kA:()=>s});var t=a(23565),o=a(82194),n=a(15944),i=a(9286),d=a(85674);let u={401:"认证失败，无法访问系统资源",403:"当前操作无权限",404:"访问资源不存在",503:"服务不可用",999:"登录信息已过期，请重新登录",default:"系统未知错误，请反馈给管理员"},r=o.Z.create({baseURL:"https://bj-dev.oberyun.com/obrapi/goHazopService",timeout:3e4});function s(e,l,a){let t={method:"get",url:e,params:l,headers:{}};return l||delete t.params,a&&(t.headers=a),r(t)}function m(e,l,a){let t={method:"post",url:e,data:l,headers:{}};return l||delete t.data,a&&(t.headers=a),r(t)}function c(e,l,a){let t={method:"put",url:e,data:l,headers:{}};return l||delete t.data,a&&(t.headers=a),r(t)}function p(e,l,a){let t={method:"delete",url:e,params:l,headers:{}};return l||delete t.params,a&&(t.headers=a),r(t)}r.interceptors.request.use(e=>{let l=e.headers||{},a=!1!==l.isToken,t=!1!==l.isProjectId;if(a&&(0,d.LP)()){e.headers["X-Access-Token"]=(0,d.LP)();let l=(0,i.F)();l.itemsType&&(e.headers["X-PROJECT-ID"]=l.itemsType);let a=null;t&&l.itemsType&&(a={projectId:l.itemsType}),a&&["get","post","delete","put"].includes(e.method)&&(Object.prototype.hasOwnProperty.call(e,"params")?Object.assign(e.params,a):Object.assign(e,{params:a}))}if("get"===e.method&&e.params){let l="",a=e.url.includes("?")?"&":"?";l=(l=`${e.url}${a}${(0,n.stringify)(e.params)}`).slice(0),e.params={},e.url=l}return e},e=>Promise.reject(e)),r.interceptors.response.use(e=>{let{code:l=200,message:a=""}=e.data,o=a||u[l]||u.default;if("blob"===e.request.responseType||"arraybuffer"===e.request.responseType)return{code:200,message:"",data:e};if(1e4===l)return Promise.reject(o);if(10401===l||401===l){let e=10401===l?u["999"]:o;return 10401===l&&(0,d.gy)(!0),t.Z.error(e),Promise.reject(l)}return 500===l||200!==l?(t.Z.error(o),Promise.reject(Error(o))):e.data},e=>{let{message:l,response:a,request:o,code:n}=e;return"ERR_NETWORK"===n&&(l="网络连接异常，请求发送失败"),l.includes("timeout")?l="系统接口请求超时":((null==a?void 0:a.status)===401||(null==o?void 0:o.status)===401)&&(l=u["999"],(0,d.gy)()),t.Z.error(l),Promise.reject(n)})},88468:function(e,l,a){function t(e,l){let a=new Set;return e.some(e=>{let t=e[l];return!!a.has(t)||(a.add(t),!1)})}function o(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=new Set(e),t=l;for(;a.has(t);)t++;return t}async function n(e){let l=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=await fetch(e);return l?await a.blob():new Uint8Array(await a.arrayBuffer())}a.d(l,{Dh:()=>t,Pr:()=>o,nx:()=>n})},98760:function(e,l,a){a.d(l,{Z:()=>_});var t=a(97385);a(84927);var o=a(40098);a(86911);var n=a(56299);a(53857);var i=a(35586),d=a(10849),u=a(74953);a(38499);var r=a(8176);a(86166);var s=a(49746);a(76270);var m=a(59643);a(30858);var c=a(94140),p=a(65754),f=a(10475),v=a(10043),w=a(9286),y=a(88468),g=a(30530),h=a(23565),U=a(77504);let _=(0,p.aZ)({__name:"custom-table",props:{type:{default:""},columns:{default:()=>[]},data:{default:()=>[]},height:{default:"100%"}},emits:["update","delete"],setup(e,l){let{emit:a}=l,_=(0,w.F)(),{matrixType:k}=(0,g.Jk)(_),b=(0,p.iH)(!1),S=(0,p.iH)(!1),W=(0,p.iH)(!1),V=(0,p.iH)(!0),x=(0,p.iH)(),Z=(0,p.iH)({}),I=(0,p.iH)({config:[{label:"",value:""}]}),H=(0,p.qj)({y:e.height}),P=(0,p.qj)([]),j=(0,p.qj)({}),z={required:!0,message:"必输项不能为空",trigger:"blur"},q={required:!0,message:"属性名不能为空",trigger:"blur"},T={required:!0,message:"属性值不能为空",trigger:"blur"},D={align:"center",title:"序号",width:80,slotName:"index"},C={align:"center",title:"操作",width:160,slotName:"optional"},F=(0,p.iH)([D,...e.columns,C]),N=(0,p.qj)(e.data),E=(0,p.Fl)(()=>W.value?"编辑属性配置":V.value?"新增数据":"编辑数据");function A(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],l=!(arguments.length>1)||void 0===arguments[1]||arguments[1];a("update",{isColumn:e,isData:l})}function L(){let e=[],l={};F.value.forEach(a=>{if(Object.hasOwn(a,"dataIndex")){let{title:t,dataIndex:o,required:n}=a;e.push({label:t,value:o,required:n}),l[o]=""}}),Object.assign(j,l),P.length>0&&P.splice(0),P.push(...e)}async function M(l){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===l){let l=I.value.config.map(e=>+e.value),a=+("severity"===e.type),t=`${(0,y.Pr)(l,a)}`;I.value.config.push({label:"",value:t,required:!1,default:!1})}else if(!1===I.value.config[l].default)I.value.config.splice(l,1);else{let t=null;"abstract"===e.type?t=await (0,f.in)(a):"severity"===e.type&&(t=await (0,v.S8)(a,k.value)),200===t.code&&(I.value.config.splice(l,1),h.Z.success("删除成功"))}}async function R(){if(void 0!==await x.value.validate())return;b.value=!0;let l=async()=>{let l=I.value.config;if((0,y.Dh)([...l],"label")){b.value=!1,h.Z.error("属性名不能重复");return}let a=null,t={};I.value.config.forEach(e=>{t[e.value]=e.label});try{let l=null;"abstract"===e.type?(a={...t},l=await (0,f.tx)(a)):"severity"===e.type&&(a={matrixId:k.value,titles:{0:"坐标值",...t}},l=await (0,v.Wu)(a)),200===l.code&&(S.value=!1,h.Z.success("保存成功"),A())}finally{b.value=!1}},a=async()=>{let l={};try{let a=null;"abstract"===e.type?(l=Z.value,a=await (0,f.HT)(l)):"severity"===e.type&&(l={matrixId:k.value,row:{0:"",...Z.value}},a=await (0,v.jW)(l)),200===a.code&&(h.Z.success("保存成功"),S.value=!1,A())}finally{b.value=!1}};W.value?l():a()}function K(){x.value.resetFields(),Z.value={...j.value},S.value=!1,A()}function Y(){let l=e.columns.map(e=>({label:e.title,value:e.dataIndex,required:e.required}));I.value.config=[...l],W.value=!0,S.value=!0}function O(){let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1?arguments[1]:void 0;V.value=null===l;let t=V.value?`${e.data.length+1}`:`${a+1}`;Z.value=V.value?{...j.value,0:t}:{...l,0:t},W.value=!1,S.value=!0}return(0,p.YP)(()=>e.columns,e=>{let l=[D,...e,C];F.value.splice(0),F.value.push(...l),L()},{deep:!0}),(0,p.YP)(()=>S.value,l=>{if(l){let l=[D,...e.columns,C];F.value.splice(0),F.value.push(...l),L()}}),(e,l)=>{let f=c.Z,v=m.Z,w=s.Z,y=r.ZP,g=u.ZP,h=d.Z,_=i.Z,k=n.Z,V=o.Z,j=t.Z;return(0,p.wg)(),(0,p.iD)(p.HY,null,[(0,p.Wm)(v,{direction:"vertical"},{default:(0,p.w5)(()=>[(0,p.Wm)(v,null,{default:(0,p.w5)(()=>[(0,p.Wm)(f,{type:"primary",onClick:l[0]||(l[0]=e=>O(null))},{default:(0,p.w5)(()=>l[3]||(l[3]=[(0,p.Uk)(" 添加数据 ",-1)])),_:1,__:[3]}),(0,p.Wm)(f,{type:"primary",onClick:Y},{default:(0,p.w5)(()=>l[4]||(l[4]=[(0,p.Uk)(" 属性配置 ",-1)])),_:1,__:[4]}),(0,p.Wm)(f,{type:"primary",onClick:l[1]||(l[1]=e=>A(!1))},{default:(0,p.w5)(()=>l[5]||(l[5]=[(0,p.Uk)(" 刷新 ",-1)])),_:1,__:[5]})]),_:1}),(0,p.Wm)(y,{loading:(0,p.SU)(b),columns:(0,p.SU)(F),data:(0,p.SU)(N),scroll:(0,p.SU)(H),pagination:!1,"table-layout-fixed":""},{index:(0,p.w5)(e=>{let{rowIndex:l}=e;return[(0,p.Uk)((0,p.zw)(l+1),1)]}),optional:(0,p.w5)(e=>{let{record:t,rowIndex:o}=e;return[(0,p.Wm)(w,null,{default:(0,p.w5)(()=>[(0,p.Wm)(f,{type:"text",onClick:e=>O(t,o)},{default:(0,p.w5)(()=>l[6]||(l[6]=[(0,p.Uk)(" 编辑 ",-1)])),_:2,__:[6]},1032,["onClick"]),(0,p.Wm)(f,{type:"text",status:"danger",onClick:e=>{U.Z.confirm({title:"删除提示",content:`\u{786E}\u{5B9A}\u{5220}\u{9664}\u{5F53}\u{524D}\u{9009}\u{4E2D}\u{6570}\u{636E}\u{5417}\u{FF1F}`,onOk:()=>a("delete",t)})}},{default:(0,p.w5)(()=>l[7]||(l[7]=[(0,p.Uk)(" 删除 ",-1)])),_:2,__:[7]},1032,["onClick"])]),_:2},1024)]}),_:1},8,["loading","columns","data","scroll"])]),_:1}),(0,p.Wm)(j,{width:"720px",title:(0,p.SU)(E),visible:(0,p.SU)(S),"mask-closable":!1,"esc-to-close":!1,"ok-loading":(0,p.SU)(b),onOk:R,onCancel:K},{default:(0,p.w5)(()=>[(0,p.SU)(W)?((0,p.wg)(),(0,p.j4)(V,{key:0,ref_key:"formRef",ref:x,model:(0,p.SU)(I),"auto-label-width":""},{default:(0,p.w5)(()=>[((0,p.wg)(!0),(0,p.iD)(p.HY,null,(0,p.Ko)((0,p.SU)(I).config,(e,a)=>((0,p.wg)(),(0,p.j4)(k,{key:a,gutter:12},{default:(0,p.w5)(()=>[(0,p.Wm)(_,{span:10},{default:(0,p.w5)(()=>[(0,p.Wm)(h,{field:`config[${a}].label`,label:`\u{5C5E}\u{6027}\u{540D}${a}`,rules:q},{default:(0,p.w5)(()=>[(0,p.Wm)(g,{modelValue:e.label,"onUpdate:modelValue":l=>e.label=l,modelModifiers:{trim:!0},"max-length":50,"allow-clear":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["field","label","rules"])]),_:2},1024),(0,p.Wm)(_,{span:9},{default:(0,p.w5)(()=>[(0,p.Wm)(h,{field:`config[${a}].value`,label:`\u{5C5E}\u{6027}\u{503C}${a}`,rules:T},{default:(0,p.w5)(()=>[(0,p.Wm)(g,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,modelModifiers:{trim:!0},"max-length":50,disabled:"","allow-clear":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["field","label","rules"])]),_:2},1024),(0,p.Wm)(_,{span:5},{default:(0,p.w5)(()=>[(0,p.Wm)(v,null,{default:(0,p.w5)(()=>[(0,p.Wm)(f,{type:"text",status:"danger",disabled:1===(0,p.SU)(I).config.length,onClick:l=>M(a,e.value)},{default:(0,p.w5)(()=>l[8]||(l[8]=[(0,p.Uk)(" 删除 ",-1)])),_:2,__:[8]},1032,["disabled","onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),(0,p.Wm)(v,null,{default:(0,p.w5)(()=>[(0,p.Wm)(f,{type:"primary",onClick:l[2]||(l[2]=e=>M(null))},{default:(0,p.w5)(()=>l[9]||(l[9]=[(0,p.Uk)(" 添加配置 ",-1)])),_:1,__:[9]})]),_:1})]),_:1},8,["model"])):((0,p.wg)(),(0,p.j4)(V,{key:1,ref_key:"formRef",ref:x,model:(0,p.SU)(Z),"auto-label-width":""},{default:(0,p.w5)(()=>[((0,p.wg)(!0),(0,p.iD)(p.HY,null,(0,p.Ko)((0,p.SU)(P),e=>((0,p.wg)(),(0,p.j4)(h,{key:e.value,field:e.value,label:e.label,rules:{...z,required:e.required},"show-colon":""},{default:(0,p.w5)(()=>[(0,p.Wm)(g,{modelValue:(0,p.SU)(Z)[e.value],"onUpdate:modelValue":l=>(0,p.SU)(Z)[e.value]=l,modelModifiers:{trim:!0},"max-length":50,disabled:e.label===`\u{5750}\u{6807}\u{503C}`,"allow-clear":""},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["field","label","rules"]))),128))]),_:1},8,["model"]))]),_:1},8,["title","visible","ok-loading"])],64)}}})},33770:function(e,l,a){a.r(l),a.d(l,{default:()=>r});var t=a(73251);a(53623);var o=a(59643);a(30858);var n=a(94140);a(76270);var i=a(65754),d=a(52979);let u={class:"app-error"},r=(0,i.aZ)({__name:"error",setup(e){let l=(0,d.tv)();function a(){l.back()}return(e,l)=>{let d=n.Z,r=o.Z,s=t.Z;return(0,i.wg)(),(0,i.iD)("main",u,[(0,i.Wm)(s,{status:"404",subtitle:"您访问的路径不存在"},{extra:(0,i.w5)(()=>[(0,i.Wm)(r,null,{default:(0,i.w5)(()=>[(0,i.Wm)(d,{type:"primary",onClick:a},{default:(0,i.w5)(()=>l[0]||(l[0]=[(0,i.Uk)(" 返回 ",-1)])),_:1,__:[0]})]),_:1})]),_:1})])}}})},52603:function(e,l,a){a.d(l,{Z:()=>eN});var t=a(34945),o=a(43956);a(57445);var n=a(73306),i=a(61537),d=a(36178);a(45264);var u=a(2421);a(3498);var r=a(30932),s=a(59643);a(30858);var m=a(72026),c=a(70540),p=a(63290),f=a(56851),v=a(89239);a(65206);var w=a(94140);a(76270);var y=a(54860),g=a(65754),h=a(36186),U=a(9286),_=a(35017),k=a(77504);a(15480);var b=a(86033);a(15745);var S=a(56299);a(53857);var W=a(35586),V=a(40098);a(86911);var x=a(32110);a(67328);var Z=a(42763);a(14433);var I=a(74953);a(38499);var H=a(75792);a(45508);var P=a(95557),j=a(10849),z=a(8176);a(86166);var q=a(83689),T=a(48295),D=a(27900),C=a(35373),F=a(27140),N=a(22570);let E=(0,g.aZ)({__name:"table",props:{nodeType:{type:Number,default:0},search:{type:Boolean,default:!1}},emits:["update"],setup(e,l){let{emit:a}=l,t=(0,U.F)().itemsType,o=(0,g.iH)(!1),n=(0,g.iH)(""),i=(0,g.iH)([]),d={y:440},u={height:410},r={type:"radio"},m=[{title:"原因",dataIndex:"knowledgeData"},{align:"center",width:100,title:"类别",dataIndex:"deviceName"},{align:"center",width:144,title:"发生频率/a^-1",dataIndex:"knowledgeValue"}],c=[{align:"center",title:"引导词",dataIndex:"word"}],p=[{title:"后果",dataIndex:"knowledgeData"},{align:"center",width:100,title:"类别",dataIndex:"deviceName"}],f=[{title:"措施",dataIndex:"knowledgeData"},{align:"center",title:"所属类别",width:100,dataIndex:"deviceName"},{align:"center",title:"频率消减因子",width:128,dataIndex:"knowledgeValue"}],v=(0,g.Fl)(()=>0===e.nodeType?m:1===e.nodeType?c:2===e.nodeType?p:3===e.nodeType?f:[]),w=(0,g.iH)([]);function y(){i.value=[],_()}function h(e){a("update",w.value.find(l=>l.id===e[0]))}async function _(){o.value||(o.value=!0);let l=null,a={};0===e.nodeType?(a={search:n.value.trim()},l=C.Y9):1===e.nodeType?(a={pageNo:1,pageSize:1e3,projectId:t},l=D.Dq):2===e.nodeType?(a={search:n.value.trim(),projectId:t},l=F.z9):3===e.nodeType&&(a={search:n.value.trim(),projectId:t},l=N.rf);try{let t=await l(a);if(200===t.code){let l=1===e.nodeType?t.result.records||[]:t.result||[];w.value.length>0&&w.value.splice(0),w.value=l}}finally{o.value=!1}}return(0,g.bv)(()=>{_()}),(l,a)=>{let t=T.Z,m=z.ZP,c=s.Z;return(0,g.wg)(),(0,g.j4)(c,{direction:"vertical",fill:""},{default:(0,g.w5)(()=>[(0,g.wy)((0,g.Wm)(t,{modelValue:(0,g.SU)(n),"onUpdate:modelValue":a[0]||(a[0]=e=>(0,g.dq)(n)?n.value=e:null),modelModifiers:{trim:!0},placeholder:"请输入关键字","search-button":"","allow-clear":"",onSearch:y},null,8,["modelValue"]),[[g.F8,e.search]]),(0,g.Wm)(m,{"selected-keys":(0,g.SU)(i),"onUpdate:selectedKeys":a[1]||(a[1]=e=>(0,g.dq)(i)?i.value=e:null),loading:(0,g.SU)(o),"table-layout-fixed":!0,stripe:!0,columns:(0,g.SU)(v),data:(0,g.SU)(w),"row-key":"id","row-selection":r,"virtual-list-props":u,pagination:!1,scroll:d,onSelectionChange:h},null,8,["selected-keys","loading","columns","data"])]),_:1})}}});var A=a(30530),L=a(23565);let M=(0,g.aZ)({__name:"modal",props:(0,g.Vf)({nodeType:{type:Number,default:1},nodeId:{type:String,default:""}},{modelValue:{},modelModifiers:{},measures:{type:Object,default:()=>({safety:0,advice:0,mark:""})},measuresModifiers:{}}),emits:["update:modelValue","update:measures"],setup(e){let l=(0,U.F)(),a=(0,_.a)(),t=(0,g.Fl)(()=>l.itemsType),{deviceList:o,hazopNodeList:n,hazopNodeId:i}=(0,A.Jk)(a),m=(0,g.tT)(e,"modelValue"),c=(0,g.tT)(e,"measures"),p={height:"98dvh",width:"80dvw"},f={padding:"5px",height:"calc(100% - 113px)"},v={padding:"5px"},y=(0,g.iH)(!1),h=(0,g.iH)(null),T={projectId:t,hazopNodeId:i.value,deviceId:"0",nodeId:e.nodeId,measureType:1,measuresContent:"",reductionFactor:null,number:"",executor:"",independentProtection:0},D=(0,g.iH)({...T}),C={required:{required:!0,message:"必填项不能为空",trigger:"blur"},change:{required:!0,message:"必选项不能为空",trigger:"blur"}},F=[{align:"center",width:64,title:"序号",slotName:"index"},{align:"center",title:"措施名称",dataIndex:"measuresContent"},{align:"center",title:"措施类型",dataIndex:"measureType",render:e=>{let{record:l}=e;return 1===l.measureType?"建议措施":"安全措施"}},{align:"center",title:"频率消减因子",dataIndex:"reductionFactor"},{align:"center",title:"措施执行人",dataIndex:"executor"},{align:"center",title:"独立保护层",dataIndex:"independentProtection",render:e=>{let{record:l}=e;return 1===l.independentProtection?"是":"否"}},{align:"center",width:100,title:"操作",slotName:"optional"}],N=(0,g.iH)([]);async function M(){y.value||(y.value=!0),N.value.length>0&&(N.value=[]);try{let l=await (0,q.CZ)(e.nodeId);200===l.code&&(N.value=l.result||{})}finally{y.value=!1}}async function R(e){let l={...e};N.value.push(l),L.Z.success("添加成功"),(0,g.Y3)(()=>{D.value={...T}})}async function K(){y.value||(y.value=!0),c.value.advice=0,c.value.safety=0,N.value.forEach(e=>{1===e.measureType&&(c.value.advice+=1),0===e.measureType&&(c.value.safety+=1)});try{let l=(0,g.IU)(N.value),a=await (0,q.SU)(l,e.nodeId);200===a.code&&(L.Z.success("保存成功"),m.value=!1)}finally{y.value=!1}}function Y(e){D.value.measuresContent=e.knowledgeData}return(0,g.YP)(()=>m.value,e=>{e&&M()}),(e,l)=>{let a=P.Z,t=H.Z,i=j.Z,U=r.Z,_=u.ZP,q=I.ZP,T=Z.Z,A=x.Z,L=w.Z,M=V.Z,O=d.ZP,$=W.Z,B=S.Z,G=s.Z,X=z.ZP,J=b.Z,Q=k.Z;return(0,g.wg)(),(0,g.j4)(Q,{visible:m.value,"onUpdate:visible":l[8]||(l[8]=e=>m.value=e),title:"安全措施设置","modal-style":p,"body-style":f,closable:!1,"esc-to-close":!1,"mask-closable":!1,"unmount-on-close":!0,onOk:K},{default:(0,g.w5)(()=>[(0,g.Wm)(J,{loading:(0,g.SU)(y),dot:"",tip:"数据加载中"},{default:(0,g.w5)(()=>[(0,g.Wm)(B,{gutter:5},{default:(0,g.w5)(()=>[(0,g.Wm)($,{span:12},{default:(0,g.w5)(()=>[(0,g.Wm)(O,{title:"新增措施","body-style":v},{default:(0,g.w5)(()=>[(0,g.Wm)(M,{ref_key:"formRef",ref:h,model:(0,g.SU)(D),rules:C,onSubmitSuccess:R},{default:(0,g.w5)(()=>[(0,g.Wm)(i,{label:"措施类型","show-colon":"",field:"measureType"},{default:(0,g.w5)(()=>[(0,g.Wm)(t,{modelValue:(0,g.SU)(D).measureType,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,g.SU)(D).measureType=e)},{default:(0,g.w5)(()=>[(0,g.Wm)(a,{value:0},{default:(0,g.w5)(()=>l[9]||(l[9]=[(0,g.Uk)(" 安全措施 ",-1)])),_:1,__:[9]}),(0,g.Wm)(a,{value:1},{default:(0,g.w5)(()=>l[10]||(l[10]=[(0,g.Uk)(" 建议措施 ",-1)])),_:1,__:[10]})]),_:1},8,["modelValue"])]),_:1}),(0,g.Wm)(i,{label:"所属节点","show-colon":"",field:"hazopNodeId"},{default:(0,g.w5)(()=>[(0,g.Wm)(_,{modelValue:(0,g.SU)(D).hazopNodeId,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,g.SU)(D).hazopNodeId=e),disabled:""},{default:(0,g.w5)(()=>[((0,g.wg)(!0),(0,g.iD)(g.HY,null,(0,g.Ko)((0,g.SU)(n),e=>((0,g.wg)(),(0,g.j4)(U,{key:e.key,value:e.key},{default:(0,g.w5)(()=>[(0,g.Uk)(" 节点"+(0,g.zw)(e.order),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,g.Wm)(i,{label:"所属设备","show-colon":"",field:"deviceId"},{default:(0,g.w5)(()=>[(0,g.Wm)(_,{modelValue:(0,g.SU)(D).deviceId,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,g.SU)(D).deviceId=e)},{default:(0,g.w5)(()=>[(0,g.Wm)(U,{value:"0"},{default:(0,g.w5)(()=>l[11]||(l[11]=[(0,g.Uk)(" 无 ",-1)])),_:1,__:[11]}),((0,g.wg)(!0),(0,g.iD)(g.HY,null,(0,g.Ko)((0,g.SU)(o),e=>((0,g.wg)(),(0,g.j4)(U,{key:e.id,value:e.id},{default:(0,g.w5)(()=>[(0,g.Uk)((0,g.zw)(e.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,g.Wm)(i,{label:"位号","show-colon":"",field:"positionNumber",disabled:""},{default:(0,g.w5)(()=>[(0,g.Wm)(q,{modelValue:(0,g.SU)(D).positionNumber,"onUpdate:modelValue":l[3]||(l[3]=e=>(0,g.SU)(D).positionNumber=e),maxlength:50,"allow-clear":""},null,8,["modelValue"])]),_:1}),(0,g.Wm)(i,{label:"措施描述","show-colon":"",field:"measuresContent"},{default:(0,g.w5)(()=>[(0,g.Wm)(T,{modelValue:(0,g.SU)(D).measuresContent,"onUpdate:modelValue":l[4]||(l[4]=e=>(0,g.SU)(D).measuresContent=e),"max-length":200,placeholder:"请从右侧知识库选择","allow-clear":""},null,8,["modelValue"])]),_:1}),(0,g.Wm)(i,{label:"消减因子","show-colon":"",field:"reductionFactor",rules:C.required},{default:(0,g.w5)(()=>[(0,g.Wm)(A,{modelValue:(0,g.SU)(D).reductionFactor,"onUpdate:modelValue":l[5]||(l[5]=e=>(0,g.SU)(D).reductionFactor=e),min:1,max:100,step:.1,"hide-button":""},null,8,["modelValue"])]),_:1},8,["rules"]),(0,g.Wm)(i,{label:"执行人","show-colon":"",field:"executor"},{default:(0,g.w5)(()=>[(0,g.Wm)(q,{modelValue:(0,g.SU)(D).executor,"onUpdate:modelValue":l[6]||(l[6]=e=>(0,g.SU)(D).executor=e),modelModifiers:{trim:!0},disabled:1===(0,g.SU)(D).measureType},null,8,["modelValue","disabled"])]),_:1}),(0,g.Wm)(i,{label:"独立保护层","show-colon":"",field:"independentProtection",rules:C.change},{default:(0,g.w5)(()=>[(0,g.Wm)(t,{modelValue:(0,g.SU)(D).independentProtection,"onUpdate:modelValue":l[7]||(l[7]=e=>(0,g.SU)(D).independentProtection=e)},{default:(0,g.w5)(()=>[(0,g.Wm)(a,{value:1},{default:(0,g.w5)(()=>l[12]||(l[12]=[(0,g.Uk)(" 是 ",-1)])),_:1,__:[12]}),(0,g.Wm)(a,{value:0},{default:(0,g.w5)(()=>l[13]||(l[13]=[(0,g.Uk)(" 否 ",-1)])),_:1,__:[13]})]),_:1},8,["modelValue"])]),_:1},8,["rules"]),(0,g.Wm)(i,null,{default:(0,g.w5)(()=>[(0,g.Wm)(L,{type:"primary","html-type":"submit",loading:(0,g.SU)(y)},{default:(0,g.w5)(()=>l[14]||(l[14]=[(0,g.Uk)(" 新增 ",-1)])),_:1,__:[14]},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),(0,g.Wm)($,{span:12},{default:(0,g.w5)(()=>[(0,g.Wm)(O,{title:"知识库","body-style":{height:"500px",padding:"5px"}},{default:(0,g.w5)(()=>[(0,g.Wm)(E,{"node-type":3,search:"",onUpdate:Y})]),_:1})]),_:1})]),_:1}),l[16]||(l[16]=(0,g._)("div",{style:{height:"6px"}},null,-1)),(0,g.Wm)(O,{title:"已有措施","body-style":v},{default:(0,g.w5)(()=>[(0,g.Wm)(X,{columns:F,data:(0,g.SU)(N),pagination:!1,"table-layout-fixed":!0},{index:(0,g.w5)(e=>{let{rowIndex:l}=e;return[(0,g.Uk)((0,g.zw)(l+1),1)]}),optional:(0,g.w5)(e=>{let{record:a,rowIndex:t}=e;return[(0,g.Wm)(G,null,{default:(0,g.w5)(()=>[(0,g.Wm)(L,{type:"text",status:"danger",onClick:e=>(function(e,l){let a=1===e.measureType?"建议措施":"安全措施";k.Z.confirm({title:"删除提示",content:`\u{786E}\u{5B9A}\u{5220}\u{9664}\u{5F53}\u{524D}\u{9009}\u{4E2D}\u{201C}${a}\u{201D}\u{5417}\u{FF1F}`,onOk:()=>{N.value.splice(l,1),1===e.measureType&&(c.value.advice-=1),0===e.measureType&&(c.value.safety-=1)}})})(a,t)},{default:(0,g.w5)(()=>l[15]||(l[15]=[(0,g.Uk)(" 删除 ",-1)])),_:2,__:[15]},1032,["onClick"])]),_:2},1024)]}),_:1},8,["data"])]),_:1})]),_:1,__:[16]},8,["loading"])]),_:1},8,["visible"])}}}),R=(0,g.aZ)({__name:"set-deviate",props:{nodeId:{type:String,default:""},isHazop:{type:Boolean,default:!1}},setup(e,l){let{expose:a}=l,t=(0,_.a)(),{deviceList:o,hazopNodeList:n,paramsList:i,hazopNodeId:s}=(0,A.Jk)(t),m=(0,g.iH)({safety:0,advice:0,mark:""}),c={padding:"5px"},p=(0,g.iH)(!1),f=(0,g.iH)(!1),v=(0,g.iH)(null),y={hazopNodeId:s.value,nodeId:e.nodeId,eventType:1,eventProperty:1,enablingCondition:1,reductionFactor:null,deviceId:"0",positionNumber:"",parameterType:0,parameterDescription:"",eventDescription:"",guideWordId:null,thresholdUpperLimit:0,thresholdLowerLimit:0},U=(0,g.iH)({...y}),k={required:!0,message:"必填项不能为空",trigger:"blur"},z=(0,g.iH)(""),q=(0,g.iH)("");function T(){let{positionNumber:e,parameterDescription:l}=U.value,a=[z.value,e,l,q.value];U.value.eventDescription=a.join("")}function D(e){if(e){let l=o.value.find(l=>l.id===e);z.value=(null==l?void 0:l.name)||"无"}else z.value="无";T()}let C=()=>T(),F=()=>T();function N(e){q.value=e.word,T()}function R(){f.value=!0}async function K(){if(v.value){if(void 0!==await v.value.validate())return!1;p.value||(p.value=!0);try{let e=(0,g.IU)(U.value);delete e.hazopNodeId;let l=await (0,h.sY)(e);if(200===l.code)return m.value.mark=e.eventDescription,L.Z.success("保存成功"),!0;return!1}finally{p.value=!1}}}async function Y(){p.value||(p.value=!0);try{let l=await (0,h.f)(e.nodeId);if(200===l.code){let{deviceId:a,enablingCondition:t,eventProperty:o,eventType:n,parameterDescription:i,eventDescription:d,parameterType:u,positionNumber:r,reductionFactor:c,guideWordId:p,thresholdUpperLimit:f,thresholdLowerLimit:v,safetyMeasureCount:w,suggestionMeasureCount:y}=l.result||{};U.value={hazopNodeId:s.value,nodeId:e.nodeId,eventType:n||1,eventProperty:+o||1,enablingCondition:t,reductionFactor:c,deviceId:a||"0",positionNumber:r||"",parameterType:u||0,parameterDescription:i,eventDescription:d,guideWordId:p,thresholdUpperLimit:f,thresholdLowerLimit:v},m.value.safety=w,m.value.advice=y,m.value.mark=d}}finally{p.value=!1}}return(0,g.bv)(()=>{Y()}),a({handleIcon:()=>m.value,handleSave:K}),(l,a)=>{let t=r.Z,s=u.ZP,y=j.Z,h=P.Z,_=H.Z,z=I.ZP,q=Z.Z,T=x.Z,A=w.Z,L=V.Z,K=W.Z,Y=d.ZP,O=S.Z,$=b.Z;return(0,g.wg)(),(0,g.iD)(g.HY,null,[(0,g.Wm)($,{loading:(0,g.SU)(p),dot:"",tip:"数据加载中"},{default:(0,g.w5)(()=>[(0,g.Wm)(O,{gutter:8},{default:(0,g.w5)(()=>[(0,g.Wm)(K,{span:12},{default:(0,g.w5)(()=>[(0,g.Wm)(L,{ref_key:"formRef",ref:v,model:(0,g.SU)(U)},{default:(0,g.w5)(()=>[(0,g.Wm)(y,{label:"事件类型","show-colon":"",field:"eventType",rules:k},{default:(0,g.w5)(()=>[(0,g.Wm)(s,{modelValue:(0,g.SU)(U).eventType,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,g.SU)(U).eventType=e),disabled:""},{default:(0,g.w5)(()=>[(0,g.Wm)(t,{value:0},{default:(0,g.w5)(()=>a[13]||(a[13]=[(0,g.Uk)(" 原因 ",-1)])),_:1,__:[13]}),(0,g.Wm)(t,{value:1},{default:(0,g.w5)(()=>a[14]||(a[14]=[(0,g.Uk)(" 偏离 ",-1)])),_:1,__:[14]}),(0,g.Wm)(t,{value:2},{default:(0,g.w5)(()=>a[15]||(a[15]=[(0,g.Uk)(" 后果 ",-1)])),_:1,__:[15]})]),_:1},8,["modelValue"])]),_:1},8,["rules"]),(0,g.Wm)(y,{label:"事件属性","show-colon":"",field:"eventProperty",rules:k},{default:(0,g.w5)(()=>[(0,g.Wm)(_,{modelValue:(0,g.SU)(U).eventProperty,"onUpdate:modelValue":a[1]||(a[1]=e=>(0,g.SU)(U).eventProperty=e)},{default:(0,g.w5)(()=>[(0,g.Wm)(h,{value:0},{default:(0,g.w5)(()=>a[16]||(a[16]=[(0,g.Uk)(" 具体事件 ",-1)])),_:1,__:[16]}),(0,g.Wm)(h,{value:1},{default:(0,g.w5)(()=>a[17]||(a[17]=[(0,g.Uk)(" 概念事件 ",-1)])),_:1,__:[17]})]),_:1},8,["modelValue"])]),_:1},8,["rules"]),e.isHazop?(0,g.kq)("",!0):((0,g.wg)(),(0,g.j4)(y,{key:0,label:"使能事件","show-colon":"",field:"enablingCondition",rules:k},{default:(0,g.w5)(()=>[(0,g.Wm)(_,{modelValue:(0,g.SU)(U).enablingCondition,"onUpdate:modelValue":a[2]||(a[2]=e=>(0,g.SU)(U).enablingCondition=e)},{default:(0,g.w5)(()=>[(0,g.Wm)(h,{value:1},{default:(0,g.w5)(()=>a[18]||(a[18]=[(0,g.Uk)(" 是 ",-1)])),_:1,__:[18]}),(0,g.Wm)(h,{value:0},{default:(0,g.w5)(()=>a[19]||(a[19]=[(0,g.Uk)(" 否 ",-1)])),_:1,__:[19]})]),_:1},8,["modelValue"])]),_:1},8,["rules"])),(0,g.Wm)(y,{label:"所属节点","show-colon":"",field:"hazopNodeId"},{default:(0,g.w5)(()=>[(0,g.Wm)(s,{modelValue:(0,g.SU)(U).hazopNodeId,"onUpdate:modelValue":a[3]||(a[3]=e=>(0,g.SU)(U).hazopNodeId=e),disabled:""},{default:(0,g.w5)(()=>[((0,g.wg)(!0),(0,g.iD)(g.HY,null,(0,g.Ko)((0,g.SU)(n),e=>((0,g.wg)(),(0,g.j4)(t,{key:e.key,value:e.key},{default:(0,g.w5)(()=>[(0,g.Uk)(" 节点"+(0,g.zw)(e.order),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,g.Wm)(y,{label:"所属设备","show-colon":"",field:"deviceId"},{default:(0,g.w5)(()=>[(0,g.Wm)(s,{modelValue:(0,g.SU)(U).deviceId,"onUpdate:modelValue":a[4]||(a[4]=e=>(0,g.SU)(U).deviceId=e),onChange:D},{default:(0,g.w5)(()=>[(0,g.Wm)(t,{value:"0"},{default:(0,g.w5)(()=>a[20]||(a[20]=[(0,g.Uk)(" 无 ",-1)])),_:1,__:[20]}),((0,g.wg)(!0),(0,g.iD)(g.HY,null,(0,g.Ko)((0,g.SU)(o),e=>((0,g.wg)(),(0,g.j4)(t,{key:e.id,value:e.id},{default:(0,g.w5)(()=>[(0,g.Uk)((0,g.zw)(e.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,g.Wm)(y,{label:"位号","show-colon":"",field:"positionNumber",rules:k},{default:(0,g.w5)(()=>[(0,g.Wm)(z,{modelValue:(0,g.SU)(U).positionNumber,"onUpdate:modelValue":a[5]||(a[5]=e=>(0,g.SU)(U).positionNumber=e),maxlength:50,"allow-clear":"",onChange:C},null,8,["modelValue"])]),_:1},8,["rules"]),(0,g.Wm)(y,{label:"参数类型","show-colon":"",field:"parameterType"},{default:(0,g.w5)(()=>[(0,g.Wm)(s,{modelValue:(0,g.SU)(U).parameterType,"onUpdate:modelValue":a[6]||(a[6]=e=>(0,g.SU)(U).parameterType=e)},{default:(0,g.w5)(()=>[(0,g.Wm)(t,{value:0},{default:(0,g.w5)(()=>a[21]||(a[21]=[(0,g.Uk)(" 无 ",-1)])),_:1,__:[21]}),((0,g.wg)(!0),(0,g.iD)(g.HY,null,(0,g.Ko)((0,g.SU)(i),e=>((0,g.wg)(),(0,g.j4)(t,{key:e.id,value:e.id},{default:(0,g.w5)(()=>[(0,g.Uk)((0,g.zw)(e.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,g.Wm)(y,{label:"参数描述","show-colon":"",field:"parameterDescription"},{default:(0,g.w5)(()=>[(0,g.Wm)(q,{modelValue:(0,g.SU)(U).parameterDescription,"onUpdate:modelValue":a[7]||(a[7]=e=>(0,g.SU)(U).parameterDescription=e),"max-length":200,"allow-clear":"","auto-size":"",onChange:F},null,8,["modelValue"])]),_:1}),(0,g.Wm)(y,{label:"事件描述","show-colon":"",field:"eventDescription"},{default:(0,g.w5)(()=>[(0,g.Wm)(q,{modelValue:(0,g.SU)(U).eventDescription,"onUpdate:modelValue":a[8]||(a[8]=e=>(0,g.SU)(U).eventDescription=e),"max-length":200,"auto-size":"","allow-clear":""},null,8,["modelValue"])]),_:1}),(0,g.Wm)(y,{label:"阈值上限","show-colon":"",field:"pinlv"},{default:(0,g.w5)(()=>[(0,g.Wm)(T,{modelValue:(0,g.SU)(U).thresholdUpperLimit,"onUpdate:modelValue":a[9]||(a[9]=e=>(0,g.SU)(U).thresholdUpperLimit=e),modelModifiers:{number:!0},min:0,max:100},null,8,["modelValue"])]),_:1}),(0,g.Wm)(y,{label:"阈值下限","show-colon":"",field:"pinlv"},{default:(0,g.w5)(()=>[(0,g.Wm)(T,{modelValue:(0,g.SU)(U).thresholdLowerLimit,"onUpdate:modelValue":a[10]||(a[10]=e=>(0,g.SU)(U).thresholdLowerLimit=e),modelModifiers:{number:!0},min:0,max:100},null,8,["modelValue"])]),_:1}),(0,g.Wm)(y,{label:"安全措施","show-colon":""},{default:(0,g.w5)(()=>[(0,g.Wm)(A,{type:"primary",onClick:R},{default:(0,g.w5)(()=>a[22]||(a[22]=[(0,g.Uk)(" 设置 ",-1)])),_:1,__:[22]})]),_:1})]),_:1},8,["model"])]),_:1}),(0,g.Wm)(K,{span:12},{default:(0,g.w5)(()=>[(0,g.Wm)(Y,{title:"引导词","body-style":c},{default:(0,g.w5)(()=>[(0,g.Wm)(E,{"node-type":(0,g.SU)(U).eventType,onUpdate:N},null,8,["node-type"])]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"]),(0,g.Wm)(M,{modelValue:(0,g.SU)(f),"onUpdate:modelValue":a[11]||(a[11]=e=>(0,g.dq)(f)?f.value=e:null),measures:(0,g.SU)(m),"onUpdate:measures":a[12]||(a[12]=e=>(0,g.dq)(m)?m.value=e:null),"node-type":(0,g.SU)(U).eventType,"node-id":e.nodeId},null,8,["modelValue","measures","node-type","node-id"])],64)}}}),K=(0,g.aZ)({__name:"set-outcome",props:{nodeId:{type:String,default:""},isHazop:{type:Boolean,default:!1}},setup(e,l){let{expose:a}=l,t=(0,_.a)(),{deviceList:o,hazopNodeList:n,severityTypeList:i,severityLevelList:s,hazopNodeId:m}=(0,A.Jk)(t),c=(0,g.iH)({safety:0,advice:0,mark:""}),p={padding:"5px"},f=(0,g.iH)(!1),v=(0,g.iH)(!1),y=(0,g.iH)(null),U={hazopNodeId:m.value,nodeId:e.nodeId,eventType:2,eventProperty:1,enablingCondition:"",reductionFactor:null,deviceId:"0",positionNumber:"",eventDescription:"",seriousnessList:[{id:"",levelId:""},{id:"",levelId:""},{id:"",levelId:""},{id:"",levelId:""}],isIgnitionProbability:0,ignitionProbabilityReductionFactor:"",isFatalityProbability:0,fatalityProbabilityReductionFactor:"",isPersonnelExposureProbability:0,personnelExposureProbabilityReductionFactor:"",isOtherProbability:0,otherProbabilityReductionFactor:""},k=(0,g.iH)({...U}),x={required:!0,message:"必填项不能为空",trigger:"blur"},z=(0,g.iH)(""),q=(0,g.iH)("");function T(e){if(e){let l=o.value.find(l=>l.id===e);z.value=(null==l?void 0:l.name)||""}else z.value="无";k.value.eventDescription=z.value+k.value.positionNumber}function D(e){k.value.eventDescription=z.value+e}function C(e){q.value=e.knowledgeData,k.value.eventDescription=q.value}function F(){v.value=!0}async function N(){if(y.value){if(void 0!==await y.value.validate())return!1;f.value||(f.value=!0);try{let e=(0,g.IU)(k.value);e.seriousness=[...e.seriousnessList],delete e.hazopNodeId;let l=await (0,h.dB)(e);if(200===l.code)return c.value.mark=e.eventDescription,L.Z.success("保存成功"),!0;return!1}finally{f.value=!1}}}async function R(){f.value||(f.value=!0);try{let l=await (0,h.vi)(e.nodeId);if(200===l.code){let{deviceId:a,enablingCondition:t,eventProperty:o,eventType:n,parameterDescription:i,parameterType:d,positionNumber:u,reductionFactor:r,seriousnessList:s,safetyMeasureCount:p,suggestionMeasureCount:f,eventDescription:v,isIgnitionProbability:w,ignitionProbabilityReductionFactor:y,isFatalityProbability:g,fatalityProbabilityReductionFactor:h,isPersonnelExposureProbability:U,personnelExposureProbabilityReductionFactor:_,isOtherProbability:b,otherProbabilityReductionFactor:S}=l.result||{};k.value={hazopNodeId:m.value,nodeId:e.nodeId,eventType:n||1,eventProperty:+o||1,enablingCondition:t,reductionFactor:r,deviceId:a||"0",positionNumber:u||"",parameterType:d||0,parameterDescription:i,eventDescription:v,seriousnessList:s||[{id:"",levelId:""},{id:"",levelId:""},{id:"",levelId:""},{id:"",levelId:""}],isIgnitionProbability:w,ignitionProbabilityReductionFactor:y,isFatalityProbability:g,fatalityProbabilityReductionFactor:h,isPersonnelExposureProbability:U,personnelExposureProbabilityReductionFactor:_,isOtherProbability:b,otherProbabilityReductionFactor:S},c.value.safety=p,c.value.advice=f,c.value.mark=v}}finally{f.value=!1}}return(0,g.bv)(()=>{R()}),a({handleIcon:()=>c.value,handleSave:N}),(l,a)=>{let t=r.Z,m=u.ZP,h=j.Z,U=P.Z,_=H.Z,z=I.ZP,q=Z.Z,N=w.Z,A=W.Z,L=S.Z,R=V.Z,K=d.ZP,Y=b.Z;return(0,g.wg)(),(0,g.iD)(g.HY,null,[(0,g.Wm)(Y,{loading:(0,g.SU)(f),dot:"",tip:"数据加载中"},{default:(0,g.w5)(()=>[(0,g.Wm)(L,{gutter:8},{default:(0,g.w5)(()=>[(0,g.Wm)(A,{span:14},{default:(0,g.w5)(()=>[(0,g.Wm)(R,{ref_key:"formRef",ref:y,model:(0,g.SU)(k),"auto-label-width":""},{default:(0,g.w5)(()=>[(0,g.Wm)(h,{label:"事件类型","show-colon":"",field:"eventType",rules:x},{default:(0,g.w5)(()=>[(0,g.Wm)(m,{modelValue:(0,g.SU)(k).eventType,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,g.SU)(k).eventType=e),disabled:""},{default:(0,g.w5)(()=>[(0,g.Wm)(t,{value:0},{default:(0,g.w5)(()=>a[16]||(a[16]=[(0,g.Uk)(" 原因 ",-1)])),_:1,__:[16]}),(0,g.Wm)(t,{value:1},{default:(0,g.w5)(()=>a[17]||(a[17]=[(0,g.Uk)(" 偏离 ",-1)])),_:1,__:[17]}),(0,g.Wm)(t,{value:2},{default:(0,g.w5)(()=>a[18]||(a[18]=[(0,g.Uk)(" 后果 ",-1)])),_:1,__:[18]})]),_:1},8,["modelValue"])]),_:1},8,["rules"]),(0,g.Wm)(h,{label:"事件属性","show-colon":"",field:"eventProperty",rules:x},{default:(0,g.w5)(()=>[(0,g.Wm)(_,{modelValue:(0,g.SU)(k).eventProperty,"onUpdate:modelValue":a[1]||(a[1]=e=>(0,g.SU)(k).eventProperty=e)},{default:(0,g.w5)(()=>[(0,g.Wm)(U,{value:0},{default:(0,g.w5)(()=>a[19]||(a[19]=[(0,g.Uk)(" 具体事件 ",-1)])),_:1,__:[19]}),(0,g.Wm)(U,{value:1},{default:(0,g.w5)(()=>a[20]||(a[20]=[(0,g.Uk)(" 概念事件 ",-1)])),_:1,__:[20]})]),_:1},8,["modelValue"])]),_:1},8,["rules"]),(0,g.Wm)(h,{label:"所属节点","show-colon":"",field:"hazopNodeId"},{default:(0,g.w5)(()=>[(0,g.Wm)(m,{modelValue:(0,g.SU)(k).hazopNodeId,"onUpdate:modelValue":a[2]||(a[2]=e=>(0,g.SU)(k).hazopNodeId=e),disabled:""},{default:(0,g.w5)(()=>[((0,g.wg)(!0),(0,g.iD)(g.HY,null,(0,g.Ko)((0,g.SU)(n),e=>((0,g.wg)(),(0,g.j4)(t,{key:e.key,value:e.key},{default:(0,g.w5)(()=>[(0,g.Uk)(" 节点"+(0,g.zw)(e.order),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,g.Wm)(h,{label:"所属设备","show-colon":"",field:"deviceId"},{default:(0,g.w5)(()=>[(0,g.Wm)(m,{modelValue:(0,g.SU)(k).deviceId,"onUpdate:modelValue":a[3]||(a[3]=e=>(0,g.SU)(k).deviceId=e),onChange:T},{default:(0,g.w5)(()=>[(0,g.Wm)(t,{value:"0"},{default:(0,g.w5)(()=>a[21]||(a[21]=[(0,g.Uk)(" 无 ",-1)])),_:1,__:[21]}),((0,g.wg)(!0),(0,g.iD)(g.HY,null,(0,g.Ko)((0,g.SU)(o),e=>((0,g.wg)(),(0,g.j4)(t,{key:e.id,value:e.id},{default:(0,g.w5)(()=>[(0,g.Uk)((0,g.zw)(e.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,g.Wm)(h,{label:"位号","show-colon":"",field:"positionNumber",rules:x},{default:(0,g.w5)(()=>[(0,g.Wm)(z,{modelValue:(0,g.SU)(k).positionNumber,"onUpdate:modelValue":a[4]||(a[4]=e=>(0,g.SU)(k).positionNumber=e),maxlength:50,"allow-clear":"",onChange:D},null,8,["modelValue"])]),_:1},8,["rules"]),(0,g.Wm)(h,{label:"事件描述","show-colon":"",field:"eventDescription"},{default:(0,g.w5)(()=>[(0,g.Wm)(q,{modelValue:(0,g.SU)(k).eventDescription,"onUpdate:modelValue":a[5]||(a[5]=e=>(0,g.SU)(k).eventDescription=e),"max-length":200,"auto-size":"","allow-clear":""},null,8,["modelValue"])]),_:1}),(0,g.Wm)(h,{label:"安全措施","show-colon":""},{default:(0,g.w5)(()=>[(0,g.Wm)(N,{type:"primary",onClick:F},{default:(0,g.w5)(()=>a[22]||(a[22]=[(0,g.Uk)(" 设置 ",-1)])),_:1,__:[22]})]),_:1}),e.isHazop?(0,g.kq)("",!0):((0,g.wg)(),(0,g.j4)(L,{key:0,gutter:8},{default:(0,g.w5)(()=>[(0,g.Wm)(A,{span:12},{default:(0,g.w5)(()=>[(0,g.Wm)(h,{label:"条件修正量-点火概率","show-colon":""},{default:(0,g.w5)(()=>[(0,g.Wm)(_,{modelValue:(0,g.SU)(k).isIgnitionProbability,"onUpdate:modelValue":a[6]||(a[6]=e=>(0,g.SU)(k).isIgnitionProbability=e)},{default:(0,g.w5)(()=>[(0,g.Wm)(U,{value:1},{default:(0,g.w5)(()=>a[23]||(a[23]=[(0,g.Uk)(" 开 ",-1)])),_:1,__:[23]}),(0,g.Wm)(U,{value:0},{default:(0,g.w5)(()=>a[24]||(a[24]=[(0,g.Uk)(" 关 ",-1)])),_:1,__:[24]})]),_:1},8,["modelValue"])]),_:1})]),_:1}),(0,g.Wm)(A,{span:12},{default:(0,g.w5)(()=>[(0,g.Wm)(h,{label:"消减因子","show-colon":""},{default:(0,g.w5)(()=>[(0,g.Wm)(z,{modelValue:(0,g.SU)(k).ignitionProbabilityReductionFactor,"onUpdate:modelValue":a[7]||(a[7]=e=>(0,g.SU)(k).ignitionProbabilityReductionFactor=e),class:"w-100","max-length":50,disabled:!(0,g.SU)(k).isIgnitionProbability,"allow-clear":""},null,8,["modelValue","disabled"])]),_:1})]),_:1}),(0,g.Wm)(A,{span:12},{default:(0,g.w5)(()=>[(0,g.Wm)(h,{label:"条件修正量-致死概率","show-colon":""},{default:(0,g.w5)(()=>[(0,g.Wm)(_,{modelValue:(0,g.SU)(k).isFatalityProbability,"onUpdate:modelValue":a[8]||(a[8]=e=>(0,g.SU)(k).isFatalityProbability=e)},{default:(0,g.w5)(()=>[(0,g.Wm)(U,{value:1},{default:(0,g.w5)(()=>a[25]||(a[25]=[(0,g.Uk)(" 开 ",-1)])),_:1,__:[25]}),(0,g.Wm)(U,{value:0},{default:(0,g.w5)(()=>a[26]||(a[26]=[(0,g.Uk)(" 关 ",-1)])),_:1,__:[26]})]),_:1},8,["modelValue"])]),_:1})]),_:1}),(0,g.Wm)(A,{span:12},{default:(0,g.w5)(()=>[(0,g.Wm)(h,{label:"消减因子","show-colon":""},{default:(0,g.w5)(()=>[(0,g.Wm)(z,{modelValue:(0,g.SU)(k).fatalityProbabilityReductionFactor,"onUpdate:modelValue":a[9]||(a[9]=e=>(0,g.SU)(k).fatalityProbabilityReductionFactor=e),class:"w-100","max-length":50,disabled:!(0,g.SU)(k).isFatalityProbability,"allow-clear":""},null,8,["modelValue","disabled"])]),_:1})]),_:1}),(0,g.Wm)(A,{span:12},{default:(0,g.w5)(()=>[(0,g.Wm)(h,{label:"条件修正量-人员暴露概率","show-colon":""},{default:(0,g.w5)(()=>[(0,g.Wm)(_,{modelValue:(0,g.SU)(k).isPersonnelExposureProbability,"onUpdate:modelValue":a[10]||(a[10]=e=>(0,g.SU)(k).isPersonnelExposureProbability=e)},{default:(0,g.w5)(()=>[(0,g.Wm)(U,{value:1},{default:(0,g.w5)(()=>a[27]||(a[27]=[(0,g.Uk)(" 开 ",-1)])),_:1,__:[27]}),(0,g.Wm)(U,{value:0},{default:(0,g.w5)(()=>a[28]||(a[28]=[(0,g.Uk)(" 关 ",-1)])),_:1,__:[28]})]),_:1},8,["modelValue"])]),_:1})]),_:1}),(0,g.Wm)(A,{span:12},{default:(0,g.w5)(()=>[(0,g.Wm)(h,{label:"消减因子","show-colon":""},{default:(0,g.w5)(()=>[(0,g.Wm)(z,{modelValue:(0,g.SU)(k).personnelExposureProbabilityReductionFactor,"onUpdate:modelValue":a[11]||(a[11]=e=>(0,g.SU)(k).personnelExposureProbabilityReductionFactor=e),class:"w-100","max-length":50,disabled:!(0,g.SU)(k).isPersonnelExposureProbability,"allow-clear":""},null,8,["modelValue","disabled"])]),_:1})]),_:1}),(0,g.Wm)(A,{span:12},{default:(0,g.w5)(()=>[(0,g.Wm)(h,{label:"条件修正量-其他","show-colon":""},{default:(0,g.w5)(()=>[(0,g.Wm)(_,{modelValue:(0,g.SU)(k).isOtherProbability,"onUpdate:modelValue":a[12]||(a[12]=e=>(0,g.SU)(k).isOtherProbability=e)},{default:(0,g.w5)(()=>[(0,g.Wm)(U,{value:1},{default:(0,g.w5)(()=>a[29]||(a[29]=[(0,g.Uk)(" 开 ",-1)])),_:1,__:[29]}),(0,g.Wm)(U,{value:0},{default:(0,g.w5)(()=>a[30]||(a[30]=[(0,g.Uk)(" 关 ",-1)])),_:1,__:[30]})]),_:1},8,["modelValue"])]),_:1})]),_:1}),(0,g.Wm)(A,{span:12},{default:(0,g.w5)(()=>[(0,g.Wm)(h,{label:"消减因子","show-colon":""},{default:(0,g.w5)(()=>[(0,g.Wm)(z,{modelValue:(0,g.SU)(k).otherProbabilityReductionFactor,"onUpdate:modelValue":a[13]||(a[13]=e=>(0,g.SU)(k).otherProbabilityReductionFactor=e),class:"w-100","max-length":50,disabled:!(0,g.SU)(k).isOtherProbability,"allow-clear":""},null,8,["modelValue","disabled"])]),_:1})]),_:1})]),_:1})),((0,g.wg)(!0),(0,g.iD)(g.HY,null,(0,g.Ko)((0,g.SU)(k).seriousnessList,(e,l)=>((0,g.wg)(),(0,g.j4)(L,{key:l,gutter:8},{default:(0,g.w5)(()=>[(0,g.Wm)(A,{span:12},{default:(0,g.w5)(()=>[(0,g.Wm)(h,{label:`\u{4E25}\u{91CD}\u{6027}\u{7C7B}\u{522B}${l+1}`,field:`seriousnessList[${l}].id`,rules:x,"show-colon":""},{default:(0,g.w5)(()=>[(0,g.Wm)(m,{"model-value":e.id,"onUpdate:modelValue":l=>e.id=l,"allow-clear":"",onClear:l=>{e.id=""}},{default:(0,g.w5)(()=>[((0,g.wg)(!0),(0,g.iD)(g.HY,null,(0,g.Ko)((0,g.SU)(i),e=>{var l;return(0,g.wg)(),(0,g.j4)(t,{key:e.key,value:e.key,disabled:(l=e.key,-1!==k.value.seriousnessList.findIndex(e=>e.id===l))},{default:(0,g.w5)(()=>[(0,g.Uk)((0,g.zw)(e.value),1)]),_:2},1032,["value","disabled"])}),128))]),_:2},1032,["model-value","onUpdate:modelValue","onClear"])]),_:2},1032,["label","field","rules"])]),_:2},1024),(0,g.Wm)(A,{span:12},{default:(0,g.w5)(()=>[(0,g.Wm)(h,{label:`\u{4E25}\u{91CD}\u{6027}\u{7EA7}\u{522B}${l+1}`,field:`seriousnessList[${l}].levelId`,rules:x,"show-colon":""},{default:(0,g.w5)(()=>[(0,g.Wm)(m,{modelValue:e.levelId,"onUpdate:modelValue":l=>e.levelId=l},{default:(0,g.w5)(()=>[((0,g.wg)(!0),(0,g.iD)(g.HY,null,(0,g.Ko)((0,g.SU)(s),e=>((0,g.wg)(),(0,g.j4)(t,{key:e.key,value:e.key},{default:(0,g.w5)(()=>[(0,g.Uk)((0,g.zw)(e.value),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label","field","rules"])]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["model"])]),_:1}),(0,g.Wm)(A,{span:10},{default:(0,g.w5)(()=>[(0,g.Wm)(K,{title:"知识库","body-style":p},{default:(0,g.w5)(()=>[(0,g.Wm)(E,{"node-type":(0,g.SU)(k).eventType,search:"",onUpdate:C},null,8,["node-type"])]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"]),(0,g.Wm)(M,{modelValue:(0,g.SU)(v),"onUpdate:modelValue":a[14]||(a[14]=e=>(0,g.dq)(v)?v.value=e:null),measures:(0,g.SU)(c),"onUpdate:measures":a[15]||(a[15]=e=>(0,g.dq)(c)?c.value=e:null),"node-type":(0,g.SU)(k).eventType,"node-id":e.nodeId},null,8,["modelValue","measures","node-type","node-id"])],64)}}}),Y=(0,g.aZ)({__name:"set-reason",props:{nodeId:{type:String,default:""},isHazop:{type:Boolean,default:!1}},setup(e,l){let{expose:a}=l,t=(0,_.a)(),{deviceList:o,hazopNodeList:n,frequencyList:i,hazopNodeId:s}=(0,A.Jk)(t),m=(0,g.iH)({safety:0,advice:0,mark:""}),c={padding:"5px"},p=(0,g.iH)(!1),f=(0,g.iH)(!1),v=(0,g.iH)(null),y={hazopNodeId:s.value,nodeId:e.nodeId,eventType:0,eventProperty:1,enablingCondition:"",reductionFactor:"",deviceId:"0",positionNumber:"",parameterType:null,parameterDescription:"",eventDescription:"",frequencyId:null},U=(0,g.iH)({...y}),k={required:!0,message:"必填项不能为空",trigger:"blur"},x=(0,g.iH)(""),z=(0,g.iH)("");function q(e){if(e){let l=o.value.find(l=>l.id===e);x.value=(null==l?void 0:l.name)||""}else x.value="无";U.value.eventDescription=x.value+U.value.positionNumber}function T(e){U.value.eventDescription=x.value+e}function D(e){z.value=e.knowledgeData,U.value.eventDescription=z.value}function C(){f.value=!0}async function F(){if(v.value){if(void 0!==await v.value.validate())return!1;p.value||(p.value=!0);try{let e=(0,g.IU)(U.value);delete e.hazopNodeId;let l=await (0,h.o6)(e);if(200===l.code)return m.value.mark=e.eventDescription,L.Z.success("保存成功"),!0;return!1}finally{p.value=!1}}}async function N(){p.value||(p.value=!0);try{let l=await (0,h.mw)(e.nodeId);if(200===l.code){let{deviceId:a,enablingCondition:t,eventProperty:o,eventType:n,frequencyId:i,parameterDescription:d,parameterType:u,positionNumber:r,reductionFactor:c,safetyMeasureCount:p,suggestionMeasureCount:f,eventDescription:v}=l.result||{};U.value={hazopNodeId:s.value,nodeId:e.nodeId,eventType:n||0,eventProperty:o||1,enablingCondition:t,reductionFactor:c,deviceId:a||"0",positionNumber:r||"",parameterType:u,parameterDescription:d,eventDescription:v,frequencyId:i},m.value.safety=p,m.value.advice=f,m.value.mark=v}}finally{p.value=!1}}return(0,g.bv)(()=>{N()}),a({handleIcon:()=>m.value,handleSave:F}),(l,a)=>{let t=r.Z,s=u.ZP,y=j.Z,h=P.Z,_=H.Z,x=I.ZP,z=Z.Z,F=w.Z,N=V.Z,A=W.Z,L=d.ZP,R=S.Z,K=b.Z;return(0,g.wg)(),(0,g.iD)(g.HY,null,[(0,g.Wm)(K,{loading:(0,g.SU)(p),dot:"",tip:"数据加载中"},{default:(0,g.w5)(()=>[(0,g.Wm)(R,{gutter:6},{default:(0,g.w5)(()=>[(0,g.Wm)(A,{span:12},{default:(0,g.w5)(()=>[(0,g.Wm)(N,{ref_key:"formRef",ref:v,model:(0,g.SU)(U)},{default:(0,g.w5)(()=>[(0,g.Wm)(y,{label:"事件类型","show-colon":"",field:"eventType",rules:k},{default:(0,g.w5)(()=>[(0,g.Wm)(s,{modelValue:(0,g.SU)(U).eventType,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,g.SU)(U).eventType=e),disabled:""},{default:(0,g.w5)(()=>[(0,g.Wm)(t,{value:0},{default:(0,g.w5)(()=>a[11]||(a[11]=[(0,g.Uk)(" 原因 ",-1)])),_:1,__:[11]}),(0,g.Wm)(t,{value:1},{default:(0,g.w5)(()=>a[12]||(a[12]=[(0,g.Uk)(" 偏离 ",-1)])),_:1,__:[12]}),(0,g.Wm)(t,{value:2},{default:(0,g.w5)(()=>a[13]||(a[13]=[(0,g.Uk)(" 后果 ",-1)])),_:1,__:[13]})]),_:1},8,["modelValue"])]),_:1},8,["rules"]),(0,g.Wm)(y,{label:"事件属性","show-colon":"",field:"eventProperty",rules:k},{default:(0,g.w5)(()=>[(0,g.Wm)(_,{modelValue:(0,g.SU)(U).eventProperty,"onUpdate:modelValue":a[1]||(a[1]=e=>(0,g.SU)(U).eventProperty=e),disabled:""},{default:(0,g.w5)(()=>[(0,g.Wm)(h,{value:0},{default:(0,g.w5)(()=>a[14]||(a[14]=[(0,g.Uk)(" 具体事件 ",-1)])),_:1,__:[14]}),(0,g.Wm)(h,{value:1},{default:(0,g.w5)(()=>a[15]||(a[15]=[(0,g.Uk)(" 概念事件 ",-1)])),_:1,__:[15]})]),_:1},8,["modelValue"])]),_:1},8,["rules"]),(0,g.Wm)(y,{label:"所属节点","show-colon":"",field:"hazopNodeId"},{default:(0,g.w5)(()=>[(0,g.Wm)(s,{modelValue:(0,g.SU)(U).hazopNodeId,"onUpdate:modelValue":a[2]||(a[2]=e=>(0,g.SU)(U).hazopNodeId=e),disabled:""},{default:(0,g.w5)(()=>[((0,g.wg)(!0),(0,g.iD)(g.HY,null,(0,g.Ko)((0,g.SU)(n),e=>((0,g.wg)(),(0,g.j4)(t,{key:e.key,value:e.key},{default:(0,g.w5)(()=>[(0,g.Uk)(" 节点"+(0,g.zw)(e.order),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,g.Wm)(y,{label:"所属设备","show-colon":"",field:"deviceId"},{default:(0,g.w5)(()=>[(0,g.Wm)(s,{modelValue:(0,g.SU)(U).deviceId,"onUpdate:modelValue":a[3]||(a[3]=e=>(0,g.SU)(U).deviceId=e),onChange:q},{default:(0,g.w5)(()=>[(0,g.Wm)(t,{value:"0"},{default:(0,g.w5)(()=>a[16]||(a[16]=[(0,g.Uk)(" 无 ",-1)])),_:1,__:[16]}),((0,g.wg)(!0),(0,g.iD)(g.HY,null,(0,g.Ko)((0,g.SU)(o),e=>((0,g.wg)(),(0,g.j4)(t,{key:e.id,value:e.id},{default:(0,g.w5)(()=>[(0,g.Uk)((0,g.zw)(e.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,g.Wm)(y,{label:"位号","show-colon":"",field:"positionNumber",rules:k},{default:(0,g.w5)(()=>[(0,g.Wm)(x,{modelValue:(0,g.SU)(U).positionNumber,"onUpdate:modelValue":a[4]||(a[4]=e=>(0,g.SU)(U).positionNumber=e),maxlength:50,"allow-clear":"",onChange:T},null,8,["modelValue"])]),_:1},8,["rules"]),(0,g.Wm)(y,{label:"事件描述","show-colon":"",field:"eventDescription"},{default:(0,g.w5)(()=>[(0,g.Wm)(z,{modelValue:(0,g.SU)(U).eventDescription,"onUpdate:modelValue":a[5]||(a[5]=e=>(0,g.SU)(U).eventDescription=e),"max-length":200,"auto-size":"","allow-clear":""},null,8,["modelValue"])]),_:1}),(0,g.Wm)(y,{label:"频率","show-colon":"",field:"frequencyId"},{default:(0,g.w5)(()=>[(0,g.Wm)(s,{modelValue:(0,g.SU)(U).frequencyId,"onUpdate:modelValue":a[6]||(a[6]=e=>(0,g.SU)(U).frequencyId=e)},{default:(0,g.w5)(()=>[((0,g.wg)(!0),(0,g.iD)(g.HY,null,(0,g.Ko)((0,g.SU)(i),e=>((0,g.wg)(),(0,g.j4)(t,{key:e.id,value:e.id},{default:(0,g.w5)(()=>[(0,g.Uk)((0,g.zw)(e.frequency),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e.isHazop?(0,g.kq)("",!0):((0,g.wg)(),(0,g.iD)(g.HY,{key:0},[(0,g.Wm)(y,{label:"使能条件","show-colon":"",field:"enablingCondition"},{default:(0,g.w5)(()=>[(0,g.Wm)(x,{modelValue:(0,g.SU)(U).enablingCondition,"onUpdate:modelValue":a[7]||(a[7]=e=>(0,g.SU)(U).enablingCondition=e),maxlength:50,"allow-clear":""},null,8,["modelValue"])]),_:1}),(0,g.Wm)(y,{label:"消减因子","show-colon":"",field:"reductionFactor"},{default:(0,g.w5)(()=>[(0,g.Wm)(x,{modelValue:(0,g.SU)(U).reductionFactor,"onUpdate:modelValue":a[8]||(a[8]=e=>(0,g.SU)(U).reductionFactor=e),maxlength:50,"allow-clear":""},null,8,["modelValue"])]),_:1})],64)),(0,g.Wm)(y,{label:"安全措施","show-colon":""},{default:(0,g.w5)(()=>[(0,g.Wm)(F,{type:"primary",onClick:C},{default:(0,g.w5)(()=>a[17]||(a[17]=[(0,g.Uk)(" 设置 ",-1)])),_:1,__:[17]})]),_:1})]),_:1},8,["model"])]),_:1}),(0,g.Wm)(A,{span:12},{default:(0,g.w5)(()=>[(0,g.Wm)(L,{title:"知识库","body-style":c},{default:(0,g.w5)(()=>[(0,g.Wm)(E,{"node-type":(0,g.SU)(U).eventType,search:"",onUpdate:D},null,8,["node-type"])]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"]),(0,g.Wm)(M,{modelValue:(0,g.SU)(f),"onUpdate:modelValue":a[9]||(a[9]=e=>(0,g.dq)(f)?f.value=e:null),measures:(0,g.SU)(m),"onUpdate:measures":a[10]||(a[10]=e=>(0,g.dq)(m)?m.value=e:null),"node-type":(0,g.SU)(U).eventType,"node-id":e.nodeId},null,8,["modelValue","measures","node-type","node-id"])],64)}}}),O=(0,g.aZ)({__name:"node-set",props:(0,g.Vf)({visible:{type:Boolean,default:!1},nodeType:{type:Number,default:0},nodeId:{type:String,default:""},isHazop:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:(0,g.Vf)(["update"],["update:modelValue"]),setup(e,l){let{emit:a}=l,t=(0,g.tT)(e,"modelValue"),o=(0,g.iH)(null),n={width:"72dvw",height:"94dvh"},i={padding:"5px",height:"calc(100% - 113px)"},d={0:"原因属性设置",1:"偏离属性设置",2:"后果属性设置"},u=(0,g.Fl)(()=>d[e.nodeType]);async function r(){var e;await (null==(e=o.value)?void 0:e.handleSave())&&s()}function s(){(function(){if(o.value){var e;a("update",(null==(e=o.value)?void 0:e.handleIcon())||{})}})(),t.value=!1}return(l,a)=>{let d=k.Z;return(0,g.wg)(),(0,g.j4)(d,{title:(0,g.SU)(u),visible:t.value,"modal-style":n,"body-style":i,closable:!1,"esc-to-close":!1,"mask-closable":!1,"unmount-on-close":!0,onOk:r,onCancel:s},{default:(0,g.w5)(()=>[0===e.nodeType?((0,g.wg)(),(0,g.j4)(Y,{key:0,ref_key:"cmpRef",ref:o,"node-id":e.nodeId,"is-hazop":e.isHazop},null,8,["node-id","is-hazop"])):(0,g.kq)("",!0),1===e.nodeType?((0,g.wg)(),(0,g.j4)(R,{key:1,ref_key:"cmpRef",ref:o,"node-id":e.nodeId,"is-hazop":e.isHazop},null,8,["node-id","is-hazop"])):(0,g.kq)("",!0),2===e.nodeType?((0,g.wg)(),(0,g.j4)(K,{key:2,ref_key:"cmpRef",ref:o,"node-id":e.nodeId,"is-hazop":e.isHazop},null,8,["node-id","is-hazop"])):(0,g.kq)("",!0)]),_:1},8,["title","visible"])}}});var $=a(110),B=a(60390),G=a(67599),X=a(47891),J=a(44358),Q=a(19810),ee=a(11227),el=a(79321);let ea={0:"#165dff",1:"#ff7d00",2:"#f53f3f"},et={name:"",mark:"",iconSafety:0,iconAdvice:0,nodeId:""},eo={0:{shape:"vfn",width:100,height:40,label:"原因",data:{type:0,color:ea[0],...et},ports:{groups:{out:{position:"right",attrs:{circle:{r:4,magnet:!0,stroke:"#5F95FF",strokeWidth:2,fill:"#fff"}}}},items:[{group:"out"}]}},1:{shape:"vfn",width:52,height:52,label:"偏离",data:{type:1,color:ea[1],...et},ports:{groups:{in:{position:"left",attrs:{circle:{r:3,magnet:!0,stroke:"#5F95FF",strokeWidth:2,fill:"#fff"}}},out:{position:"right",attrs:{circle:{r:3,magnet:!0,stroke:"#5F95FF",strokeWidth:2,fill:"#fff"}}}},items:[{group:"out"},{group:"in"}]}},2:{shape:"vfn",width:100,height:40,label:"后果",data:{type:2,color:ea[2],...et},ports:{groups:{in:{position:"left",attrs:{circle:{r:0,magnet:!0,strokeWidth:2}}}},items:[{group:"in"}]}}},en={0:[1],1:[1,2],2:[]},ei={stroke:"#165DFF",strokeWidth:1.5},ed={scaling:{min:.25,max:5},autoResize:!0,panning:!0,mousewheel:!0,background:{color:"#f2f7fa"},connecting:{snap:!0,allowBlank:!1,allowLoop:!1,allowNode:!0,allowEdge:!1,allowPort:!1,highlight:!0,connectionPoint:{name:"boundary"},createEdge:function(){return new $.bn.kS({zIndex:0,shape:"edge",attrs:{line:ei},connector:{name:"normal"}})},validateConnection:function(e){let{sourceView:l,targetView:a}=e;if(!l||!a||l===a)return!1;let t=l.cell,o=a.cell,n=t.data.type,i=o.data.type,d=l.graph,u=en[n];return!(!u||!u.includes(i)||1===n&&1===i&&d.getEdges().some(e=>e.getSourceCellId()===o.id&&e.getTargetCellId()===t.id))&&!d.getEdges().some(e=>e.getSourceCellId()===t.id&&e.getTargetCellId()===o.id)},validateMagnet:e=>{let{magnet:l}=e;return"passive"!==l.getAttribute("magnet")}},grid:{visible:!0,type:"doubleMesh",args:[{color:"#eee",thickness:1},{color:"#ddd",thickness:1,factor:5}]},highlighting:{magnetAvailable:{name:"stroke",args:{padding:3,attrs:{stroke:"#52c41a",strokeWidth:2}}},magnetAdsorbed:{name:"stroke",args:{padding:3,attrs:{stroke:"#1890ff",strokeWidth:2}}}}},eu=`
.v-flow-node {
  width: 100%;
  height: 100%;
  background-color: #fff;
  position: relative;
  box-shadow: 0 0 0 1px #ccc;
}
.v-flow-node-0 {
  box-shadow: 0 0 0 2px #165dff;
  border-radius: 2px;
}
.v-flow-node-1 {
  box-shadow: 0 0 0 2px #ff7d00;
  border-radius: 50%;
}
.v-flow-node-2 {
  box-shadow: 0 0 0 2px #f53f3f;
  border-radius: 20px;
}
.v-flow-node .fn-icon {
  width: 100%;
  text-align: center;
  position: absolute;
  top: -20px;
}
.v-flow-node .fn-icon .fni-1 {
  color: #165dff;
}
.v-flow-node .fn-icon .fni-2 {
  color: #ff7d00;
}
.v-flow-node header {
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
}
.v-flow-node footer {
  user-select: none;
  cursor: default;
  text-align: center;
}
.v-flow-node footer .fn-name {
  line-height: 20px;
  font-weight: bold;
}
.v-flow-node footer .fn-mark {
  font-size: 12px;
  line-height: 16px;
}
`;var er=a(93749);a(65470);var es=a(34406);let em={class:"fn-icon"},ec={key:0,class:"fn-name"},ep={key:1,class:"fn-mark"},ef=(0,g.aZ)({__name:"v-flow-node",setup(e){var l,a;let t=(0,g.f3)("getNode")(),o=t.store.data,n=(0,g.iH)(""),i=(0,g.iH)(""),d=(0,g.iH)((null==(l=o.data)?void 0:l.iconSafety)||0),u=(0,g.iH)((null==(a=o.data)?void 0:a.iconAdvice)||0),r=(0,g.Fl)(()=>`v-flow-node-${t.data.type}`);return t.on("change:data",e=>{let{current:l}=e,{iconSafety:a,iconAdvice:t,name:o,mark:r}=l;d.value=a,u.value=t,n.value=o,i.value=r}),(e,l)=>{let a=es.Z,t=er.Z;return(0,g.wg)(),(0,g.iD)("div",{class:(0,g.C_)(["v-flow-node",(0,g.SU)(r)])},[(0,g._)("div",em,[(0,g.Wm)(t,{content:`${(0,g.SU)(d)}`,position:"top"},{default:(0,g.w5)(()=>[(0,g.SU)(d)?((0,g.wg)(),(0,g.j4)(a,{key:0,size:18,class:"fni-1"})):(0,g.kq)("",!0)]),_:1},8,["content"]),(0,g.Wm)(t,{content:`${(0,g.SU)(u)}`,position:"top"},{default:(0,g.w5)(()=>[(0,g.SU)(u)?((0,g.wg)(),(0,g.j4)(a,{key:0,size:18,class:"fni-2"})):(0,g.kq)("",!0)]),_:1},8,["content"])]),(0,g._)("header",null,(0,g.zw)((0,g.SU)(o).label),1),(0,g._)("footer",null,[(0,g.SU)(n)||(0,g.SU)(o).data.name?((0,g.wg)(),(0,g.iD)("div",ec,(0,g.zw)((0,g.SU)(o).data.name||(0,g.SU)(n)),1)):(0,g.kq)("",!0),(0,g.SU)(i)||(0,g.SU)(o).data.mark?((0,g.wg)(),(0,g.iD)("div",ep,(0,g.zw)((0,g.SU)(o).data.mark||(0,g.SU)(i)),1)):(0,g.kq)("",!0)])],2)}}});var ev=a(8163);let ew=(0,ev.default)(ef,[["__scopeId","data-v-05aaa2b4"]]);var ey=a(62924),eg=a(43071),eh=a(4873),eU=a(2476);let e_={class:"flow-tool"},ek=(0,g.aZ)({__name:"v-flow-tool",emits:["tool"],setup(e,l){let{emit:a}=l;function t(e){a("tool",e)}return(e,l)=>{let o=eU.Z,n=w.Z,i=er.Z,d=eh.Z,u=eg.Z,r=ey.Z,m=s.Z;return(0,g.wg)(),(0,g.iD)("div",e_,[(0,g.Wm)(m,null,{default:(0,g.w5)(()=>[(0,g.Wm)(i,{content:"放大",position:"tr"},{default:(0,g.w5)(()=>[(0,g.Wm)(n,{type:"outline",onClick:l[0]||(l[0]=e=>t("zoomIn"))},{icon:(0,g.w5)(()=>[(0,g.Wm)(o)]),_:1})]),_:1}),(0,g.Wm)(i,{content:"缩小",position:"tr"},{default:(0,g.w5)(()=>[(0,g.Wm)(n,{type:"outline",onClick:l[1]||(l[1]=e=>t("zoomOut"))},{icon:(0,g.w5)(()=>[(0,g.Wm)(d)]),_:1})]),_:1}),(0,g.Wm)(i,{content:"重置缩放",position:"tr"},{default:(0,g.w5)(()=>[(0,g.Wm)(n,{type:"outline",onClick:l[2]||(l[2]=e=>t("zoomFit"))},{icon:(0,g.w5)(()=>[(0,g.Wm)(u)]),_:1})]),_:1}),(0,g.Wm)(i,{content:"导出图片",position:"tr"},{default:(0,g.w5)(()=>[(0,g.Wm)(n,{type:"outline",onClick:l[3]||(l[3]=e=>{a("tool","png")})},{icon:(0,g.w5)(()=>[(0,g.Wm)(r)]),_:1})]),_:1})]),_:1})])}}}),eb={class:"flow-wrap"},eS={class:"flow-mask"},eW=(0,g.aZ)({__name:"v-flow",props:{stop:{type:Boolean,default:!1},flowNodeId:{type:String,default:""},isHazop:{type:Boolean,default:!1}},emits:["update:flowDataId","update:flowNodeId","update:flowNodeType","updateNode"],setup(e,l){let{expose:a,emit:t}=l,o=(0,Q.kR)();(0,Q.z2)({shape:"vfn",component:ew});let n=(0,U.F)().itemsType,i=(0,_.a)(),{hazopNodeId:d,lopaNodeId:u}=(0,A.Jk)(i),r=(0,g.iH)(null),m=(0,g.iH)(null),c=[],p=[],f=null,v=null,{showMask:y,initEvent:k}=function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{handleNode:a,handleLink:t}=l,o=(0,g.iH)(!0),n=(0,g.iH)(null);(0,g.YP)(n,l=>{let a=l?l.id:"",t=l?l.data.nodeId:"",o=l?l.data.type:null;e("update:flowNodeId",a),e("update:flowDataId",t),e("update:flowNodeType",o)});let i=(e,l)=>{a&&a(e,l)},d=(e,l)=>{t&&t(e,l)};return{showMask:o,currentNode:n,initEvent:l=>{l&&((0,g.Y3)(()=>{o.value&&(o.value=!1)}),l.on("render:done",()=>{o.value=!1}),l.on("node:click",e=>{var l;let{node:a}=e;a.id!==(null==(l=n.value)?void 0:l.id)&&(n.value&&(n.value=null),n.value=a)}),l.on("node:dblclick",l=>{let{node:a}=l;e("updateNode",a)}),l.on("node:added",e=>{let{node:l}=e;i(l,"add")}),l.on("node:moved",e=>{let{node:l}=e;i(l,"move")}),l.on("node:removed",e=>{let{node:l}=e;i(l,"delete")}),l.on("node:mouseenter",e=>{let{node:l}=e;l.addTools({name:"button-remove",args:{offset:{x:10,y:10}}})}),l.on("node:mouseleave",e=>{let{node:l}=e;l.hasTool("button-remove")&&l.removeTools()}),l.on("edge:dblclick",e=>{let{edge:l}=e}),l.on("edge:connected",e=>{let{edge:l}=e;d(l,"add")}),l.on("edge:mouseenter",e=>{let{cell:a}=e;a.addTools({name:"button-remove",args:{distance:"50%",onClick:e=>{let{cell:a}=e;d(a,"delete"),l.removeEdge(a)}}})}),l.on("edge:mouseleave",e=>{let{cell:l}=e;l.hasTool("button-remove")&&l.removeTools()}),l.on("blank:click",()=>{n.value&&(n.value=null)}))}}}(t,{handleNode:function(e,l){let{x:a,y:t}=e.position(),o=e.data,i=o.type,u=null,r=null;"add"===l?(r={x:a,y:t,id:e.id,nodeType:i,projectId:n,rootNodeId:d.value},u=h.co):"delete"===l?(r=o.nodeId,u=h.B1):"move"===l&&(r={x:a,y:t,nodeId:o.nodeId},u=h.C2),u(r).then(l=>{let a=l.result||{};e.setData({...o,nodeId:a.nodeId,name:a.nodeNumber})})},handleLink:function(e,l){let a=e.source.cell,t=e.target.cell,o=f.getCellById(a),n=f.getCellById(t),i=o.data.nodeId,u=n.data.nodeId,r=null,s=null;"add"===l?(s={sourceId:a,targetId:t,startNodeId:i,endNodeId:u,rootNodeId:d.value},r=h.aT):"delete"===l&&(s={startNodeId:i,endNodeId:u},r=h._Y),r(s).then(e=>{})}});async function b(){if(d.value)try{let l=e.isHazop?d.value:u.value;if(!l)return;let a=await (0,h.El)(l);if(200===a.code){let e=a.result||{},l=[],t=[],o=e.causes||[],n=e.deviations||[],i=e.consequences||[],d=e.relationships||[],u={},r=(e,a)=>{let{id:t,x:o,y:n,nodeId:i,nodeNumber:d,safetyMeasureCount:r,suggestionMeasureCount:s,eventDescription:m}=e,c=eo[a],p={...c.data,name:d,nodeId:i,iconSafety:r,iconAdvice:s,mark:m};u=Object.assign({},c,{id:t,x:o,y:n,data:p}),l.push(u)};o.forEach(e=>r(e,0)),n.forEach(e=>r(e,1)),i.forEach(e=>r(e,2));let s={zIndex:0,shape:"edge",attrs:{line:{stroke:"#165DFF",strokeWidth:1.5}},connector:{name:"normal"}};d.forEach(e=>{let{sourceId:l,targetId:a}=e;l&&a&&(u={source:l,target:a,...s},t.push(u))}),c.push(...l),p.push(...t)}}catch(e){}}async function S(){W(),await b(),(f=new $.kJ({container:r.value,...ed})).use(new G.D).use(new X.Y({enabled:!0,rubberEdge:!0,multiple:!0,movable:!0,showNodeSelectionBox:!0})).use(new J.H),f.fromJSON({nodes:c,edges:p}),f.centerContent(),v=new B.q({target:f,dndContainer:m.value,getDragNode:e=>e.clone({keepId:!0}),getDropNode:e=>e.clone({keepId:!0})}),k(f)}function W(){f&&(null==f||f.dispose(),f=null),c.length>0&&c.splice(0),p.length>0&&p.splice(0)}function V(e){let l=e.target.getAttribute("data-type"),a=`D#${(0,el.x0)()}`,t=f.createNode({id:a,...eo[l]});v.start(t,e)}async function x(e){if(["png"].includes(e)){let l=`flow.${e}`;await f.toPNG(e=>{(0,ee.saveAs)(e,l),L.Z.success("导出成功")},{quality:1,padding:64,backgroundColor:"#ffffff",stylesheet:eu})}else{var l;let a={zoomIn:()=>f.zoom(.1),zoomOut:()=>f.zoom(-.1),zoomFit:()=>f.zoomToFit({maxScale:1})};null==(l=a[e])||l.call(a)}}return(0,g.YP)(()=>d.value,e=>{e?S():!e&&f&&W()}),(0,g.bv)(()=>{S()}),(0,g.SK)(()=>{W()}),a({changeNodeCheck:function(e){f&&e&&(f.resetSelection(),f.select(e.id))},changeNodeData:function(l){if(!f)return;let a=e.flowNodeId,t=f.getCellById(a),o=t.store.data.data,{safety:n,advice:i,mark:d}=l;t.setData({...o,iconSafety:n,iconAdvice:i,mark:d})}}),(l,a)=>{let t=w.Z,n=s.Z;return(0,g.wg)(),(0,g.iD)("div",eb,[(0,g._)("div",{ref_key:"flowRef",ref:r,class:"flow-view"},null,512),(0,g.Wm)((0,g.SU)(o)),(0,g.wy)((0,g._)("div",eS,null,512),[[g.F8,e.stop||(0,g.SU)(y)]]),(0,g._)("div",{ref_key:"flowDndRef",ref:m,class:"flow-dnd"},[(0,g.Wm)(n,null,{default:(0,g.w5)(()=>[(0,g.Wm)(t,{type:"outline","data-type":"0",onMousedown:V},{default:(0,g.w5)(()=>a[0]||(a[0]=[(0,g.Uk)(" 原因 ",-1)])),_:1,__:[0]}),(0,g.Wm)(t,{type:"outline","data-type":"1",status:"warning",shape:"circle",onMousedown:V},{default:(0,g.w5)(()=>a[1]||(a[1]=[(0,g.Uk)(" 偏离 ",-1)])),_:1,__:[1]}),(0,g.Wm)(t,{type:"outline","data-type":"2",status:"danger",shape:"round",onMousedown:V},{default:(0,g.w5)(()=>a[2]||(a[2]=[(0,g.Uk)(" 后果 ",-1)])),_:1,__:[2]})]),_:1})],512),(0,g.Wm)(ek,{onTool:x})])}}}),eV=(0,ev.default)(eW,[["__scopeId","data-v-2d3c7a15"]]);var ex=a(72024),eZ=a(74618);a(6502);let eI=(0,g.aZ)({__name:"ma-history",props:(0,g.Vf)({modalType:{type:Number,default:null},isHazop:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){let l=(0,g.tT)(e,"modelValue"),a=(0,g.iH)(!1),t=(0,g.qj)({type:0,time:""}),o=(0,g.iH)([]),n=[{align:"center",width:120,title:"编号",dataIndex:"number"},{title:"剧情",dataIndex:"scenario"},{align:"center",width:120,title:"原始风险",slotName:"ysfx"},{align:"center",width:120,title:"现有风险",slotName:"xyfx"},{align:"center",width:120,title:"剩余风险",slotName:"syfx"}],i=(0,g.iH)([]),d=(0,g.iH)([]);async function s(l){a.value=!0;try{let a=await (0,q.Ot)(l,+!e.isHazop);if(200===a.code){let e=a.result||[],l=e.map(e=>e.analysisTime);if(o.value.length>0&&(o.value=[]),o.value=l,i.value.length>0&&i.value.splice(0),d.value.length>0&&d.value.splice(0),e.length>0){let l=e[0];d.value=e,i.value=l.record,t.time=l.analysisTime}}}finally{a.value=!1}}function m(e){s(e)}function c(e){let l=d.value.find(l=>l.analysisTime===e);i.value.length>0&&i.value.splice(0),l&&(i.value=l.record)}return(0,g.YP)(()=>l.value,l=>{l&&(t.type=e.modalType,s(t.type))}),(d,s)=>{let p=P.Z,f=H.Z,v=j.Z,w=r.Z,y=u.ZP,h=V.Z,U=eZ.Z,_=z.ZP,k=b.Z,S=ex.Z;return(0,g.wg)(),(0,g.j4)(S,{modelValue:l.value,"onUpdate:modelValue":s[2]||(s[2]=e=>l.value=e),width:"54vw",footer:!1},{default:(0,g.w5)(()=>[(0,g.Wm)(h,{model:(0,g.SU)(t)},{default:(0,g.w5)(()=>[(0,g.Wm)(v,{label:"历史数据"},{default:(0,g.w5)(()=>[(0,g.Wm)(f,{modelValue:(0,g.SU)(t).type,"onUpdate:modelValue":s[0]||(s[0]=e=>(0,g.SU)(t).type=e),onChange:m},{default:(0,g.w5)(()=>[(0,g.Wm)(p,{value:0,disabled:0!==e.modalType},{default:(0,g.w5)(()=>s[3]||(s[3]=[(0,g.Uk)(" 全部 ",-1)])),_:1,__:[3]},8,["disabled"]),(0,g.Wm)(p,{value:1,disabled:2===e.modalType},{default:(0,g.w5)(()=>s[4]||(s[4]=[(0,g.Uk)(" 单事件推理 ",-1)])),_:1,__:[4]},8,["disabled"]),(0,g.Wm)(p,{value:2,disabled:1===e.modalType},{default:(0,g.w5)(()=>s[5]||(s[5]=[(0,g.Uk)(" 单节点推理 ",-1)])),_:1,__:[5]},8,["disabled"])]),_:1},8,["modelValue"])]),_:1}),(0,g.Wm)(v,{label:"推理时间"},{default:(0,g.w5)(()=>[(0,g.Wm)(y,{modelValue:(0,g.SU)(t).time,"onUpdate:modelValue":s[1]||(s[1]=e=>(0,g.SU)(t).time=e),onChange:c},{default:(0,g.w5)(()=>[((0,g.wg)(!0),(0,g.iD)(g.HY,null,(0,g.Ko)((0,g.SU)(o),(e,l)=>((0,g.wg)(),(0,g.j4)(w,{key:l,value:e},{default:(0,g.w5)(()=>[(0,g.Uk)((0,g.zw)(e),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),(0,g.Wm)(k,{loading:(0,g.SU)(a),dot:"",tip:"数据加载中"},{default:(0,g.w5)(()=>[(0,g.Wm)(_,{"table-layout-fixed":"",columns:n,data:(0,g.SU)(i),pagination:!1},{ysfx:(0,g.w5)(e=>{let{record:l}=e;return[(0,g.Wm)(U,{class:"w-100",color:l.originalRiskColor},null,8,["color"])]}),xyfx:(0,g.w5)(e=>{let{record:l}=e;return[(0,g.Wm)(U,{class:"w-100",color:l.existingRiskColor},null,8,["color"])]}),syfx:(0,g.w5)(e=>{let{record:l}=e;return[(0,g.Wm)(U,{class:"w-100",color:l.residualRiskColor},null,8,["color"])]}),_:1},8,["data"])]),_:1},8,["loading"])]),_:1},8,["modelValue"])}}});var eH=a(56655),eP=a(52979);let ej={class:"top-wrap"},ez=(0,g.aZ)({__name:"ma-node",props:(0,g.Vf)({isHazop:{type:Boolean,default:!1},isEvent:{type:Boolean,default:!1},dataId:{type:String,default:""}},{modelValue:{},modelModifiers:{}}),emits:(0,g.Vf)(["openHistory"],["update:modelValue"]),setup(e,l){let{emit:a}=l,t=(0,_.a)(),{hazopNodeList:o,hazopNodeId:n}=(0,A.Jk)(t),i=(0,eP.tv)(),d=(0,g.tT)(e,"modelValue"),m=(0,g.iH)(!1),c=(0,g.iH)(!1),p=(0,g.iH)([]),f=(0,g.qj)({type:"checkbox",showCheckedAll:!0,onlyCurrent:!0}),v=(0,g.iH)([]),y=[{align:"center",width:120,title:"编号",dataIndex:"number"},{title:"剧情",dataIndex:"scenario"},{align:"center",width:120,title:"原始风险",slotName:"ysfx"},{align:"center",width:120,title:"现有风险",slotName:"xyfx"},{align:"center",width:120,title:"剩余风险",slotName:"syfx"}],U=(0,g.iH)([]),k=[{align:"center",title:"措施类型",dataIndex:"measureType",render:e=>{let{record:l}=e;return 1===l.measureType?"建议措施":"安全措施"}},{align:"center",title:"编号",dataIndex:"number"},{align:"center",title:"措施名称",dataIndex:"measuresContent"},{align:"center",title:"频率消减因子",dataIndex:"reductionFactor"},{align:"center",title:"独立保护层",dataIndex:"independentProtection",render:e=>{let{record:l}=e;return 1===l.independentProtection?"是":"否"}}],S=(0,g.iH)([]);async function W(e){if(0===e.length)return void S.value.splice(0);m.value=!0;try{let l=e.flat(),a=await (0,q.V6)(l);if(200===a.code){let e=a.result||[];S.value.length>0&&S.value.splice(0),S.value=e}}finally{m.value=!1}}async function V(){m.value||(m.value=!0),S.value.length>0&&S.value.splice(0);let l=null;l=e.isHazop?e.isEvent?h.qn:h.lx:e.isEvent?q.b7:q.Ai;let a=e.dataId;try{let e=await l(a);U.value>0&&(U.value=[]),200===e.code&&(U.value=e.result||[])}finally{m.value=!1}}function x(){a("openHistory")}async function Z(){c.value=!0;try{let e=v.value,l=await (0,h.j0)(e);200===l.code&&setTimeout(()=>{c.value=!1,i.push({path:"/lopa"})},1100)}catch(e){c.value=!1}}return(0,g.YP)(()=>d.value,e=>{e&&V()}),(l,a)=>{let t=r.Z,i=u.ZP,h=w.Z,_=s.Z,V=eZ.Z,I=z.ZP,H=eH.Z,P=b.Z,j=ex.Z;return(0,g.wg)(),(0,g.j4)(j,{modelValue:d.value,"onUpdate:modelValue":a[2]||(a[2]=e=>d.value=e)},{default:(0,g.w5)(()=>[(0,g._)("header",ej,[(0,g._)("div",null,[a[3]||(a[3]=(0,g._)("span",null,"选择节点：",-1)),(0,g.Wm)(i,{modelValue:(0,g.SU)(n),"onUpdate:modelValue":a[0]||(a[0]=e=>(0,g.dq)(n)?n.value=e:null),class:"w-200",disabled:e.isHazop},{default:(0,g.w5)(()=>[((0,g.wg)(!0),(0,g.iD)(g.HY,null,(0,g.Ko)((0,g.SU)(o),e=>((0,g.wg)(),(0,g.j4)(t,{key:e.key,value:e.key},{default:(0,g.w5)(()=>[(0,g.Uk)(" 节点"+(0,g.zw)(e.order),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","disabled"])]),(0,g.Wm)(_,null,{default:(0,g.w5)(()=>[(0,g.Wm)(h,{type:"primary",onClick:x},{default:(0,g.w5)(()=>a[4]||(a[4]=[(0,g.Uk)(" 历史数据 ",-1)])),_:1,__:[4]}),e.isHazop?((0,g.wg)(),(0,g.j4)(h,{key:0,type:"primary",disabled:0===(0,g.SU)(v).length,loading:(0,g.SU)(c),onClick:Z},{default:(0,g.w5)(()=>a[5]||(a[5]=[(0,g.Uk)(" 去往LOPA分析 ",-1)])),_:1,__:[5]},8,["disabled","loading"])):(0,g.kq)("",!0)]),_:1})]),a[7]||(a[7]=(0,g._)("strong",{class:"h-8"},"剧情",-1)),(0,g.Wm)(P,{loading:(0,g.SU)(m),dot:"",tip:"数据加载中"},{default:(0,g.w5)(()=>[(0,g.Wm)(I,{"selected-keys":(0,g.SU)(v),"onUpdate:selectedKeys":a[1]||(a[1]=e=>(0,g.dq)(v)?v.value=e:null),"row-key":"pathNodeIds","table-layout-fixed":!0,columns:y,data:(0,g.SU)(U),pagination:!1,"row-selection":(0,g.SU)(f),onSelectionChange:W},{ysfx:(0,g.w5)(e=>{let{record:l}=e;return[(0,g.Wm)(V,{class:"w-100",color:l.originalRiskColor},null,8,["color"])]}),xyfx:(0,g.w5)(e=>{let{record:l}=e;return[(0,g.Wm)(V,{class:"w-100",color:l.existingRiskColor},null,8,["color"])]}),syfx:(0,g.w5)(e=>{let{record:l}=e;return[(0,g.Wm)(V,{class:"w-100",color:l.residualRiskColor},null,8,["color"])]}),_:1},8,["selected-keys","data","row-selection"]),a[6]||(a[6]=(0,g._)("div",{class:"h-8"},null,-1)),(0,g.Wm)(H,{title:"措施",columns:k,data:(0,g.SU)(S),"action-items":(0,g.SU)(p),"is-bulk":!1,"show-index":!1,"hide-query":"","hide-page":""},null,8,["data","action-items"])]),_:1,__:[6]},8,["loading"])]),_:1,__:[7]},8,["modelValue"])}}}),eq=(0,ev.default)(ez,[["__scopeId","data-v-3ffda6f9"]]);var eT=a(7316);a(92920);var eD=a(68488),eC=a(94289);let eF=(0,g.aZ)({__name:"ma-program",props:(0,g.Vf)({isHazop:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){let l=(0,g.tT)(e,"modelValue"),a=(0,g.iH)(!0),t=(0,g.iH)("HAZOP风险等级汇总表"),o=(0,g.iH)([]),n=(0,g.iH)([]),i=(0,g.iH)([]);async function d(){a.value=!0;try{let l=e.isHazop?await (0,h.rM)():await (0,q.RN)();if(200===l.code){let{headers:e,data:a,pieData:t}=l.result||{};o.value.length>0&&(o.value=[]),o.value=[...e.map((l,a)=>{let t=a.toString();return a+1===e.length?t="sum":0===a&&(t="index"),{align:"center",title:l,dataIndex:t}})],n.value.length>0&&(n.value=[]),n.value=a||[],i.value.length>0&&(i.value=[]),i.value=t.map(e=>({...e,itemStyle:{color:e.color}}))}}finally{a.value=!1}}return(0,g.YP)(()=>l.value,e=>{e&&d()}),(e,u)=>{let r=eD.Z,s=eT.Z,m=z.ZP,c=b.Z,p=ex.Z;return(0,g.wg)(),(0,g.j4)(p,{modelValue:l.value,"onUpdate:modelValue":u[0]||(u[0]=e=>l.value=e),onUpdate:d},{default:(0,g.w5)(()=>[(0,g.Wm)(c,{loading:(0,g.SU)(a),dot:"",tip:"数据加载中"},{default:(0,g.w5)(()=>[(0,g.Wm)(s,{align:"center"},{default:(0,g.w5)(()=>[(0,g.Wm)(r),(0,g.Wm)(r,null,{default:(0,g.w5)(()=>[(0,g.Uk)((0,g.zw)((0,g.SU)(t)),1)]),_:1}),(0,g.Wm)(r)]),_:1}),(0,g.Wm)(m,{columns:(0,g.SU)(o),data:(0,g.SU)(n),pagination:!1,summary:!0,"summary-text":"合计"},null,8,["columns","data"]),(0,g.Wm)(eC.Z,{data:(0,g.SU)(i)},null,8,["data"])]),_:1},8,["loading"])]),_:1},8,["modelValue"])}}}),eN=(0,g.aZ)({__name:"o-flow",props:(0,g.Vf)({isHazop:{type:Boolean,default:!1}},{tree:{},treeModifiers:{},form:{},formModifiers:{}}),emits:(0,g.Vf)(["update"],["update:tree","update:form"]),setup(e,l){let{emit:a}=l,k=(0,U.F)(),b=(0,_.a)(),{hazopNodeList:S,hazopNodeId:W,lopaNodeId:V}=(0,A.Jk)(b),x=(0,g.tT)(e,"tree"),Z=(0,g.tT)(e,"form"),I={padding:"5px"},H={padding:"2px",height:"calc(100dvh - 116px)"},P={padding:"5px"},j={margin:"0 5px",color:"rgb(var(--danger-6))",cursor:"pointer"},z=(0,g.iH)(""),q=(0,g.iH)(null),T=(0,g.iH)(""),D=(0,g.iH)(""),C=(0,g.iH)(null),F=(0,g.iH)(!1),N=(0,g.iH)(!1),E=(0,g.iH)(!1),L=(0,g.iH)(!1),M=(0,g.iH)([]),R=(0,g.iH)(!1),K=(0,g.iH)(0),Y=(0,g.iH)(""),$=(0,g.iH)(3),B=(0,g.Fl)(()=>!(e.isHazop?W.value:V.value)),G=(0,g.Fl)(()=>e=>{let l="tree"===e?x.value:Z.value;return`\u{786E}\u{5B9A}${l?"隐藏":"显示"}${"tree"===e?"结构":"属性"}\u{9762}\u{677F}\u{FF1F}`});function X(e){"tree"===e?(k.changeStatus(e,!x.value),x.value=!x.value):(k.changeStatus(e,!Z.value),Z.value=!Z.value)}function J(e){b.setHazopId(e)}async function Q(){let e=[W.value];1===$.value?e=[T.value]:3===$.value&&(e=S.value.map(e=>e.key));try{let l=await (0,h.Cq)(e);if(200===l.code){let e=l.result||[];if(!(e.length>0))return!1;M.value.length>0&&M.value.splice(0),M.value=e}return!0}catch(e){return!0}}async function ee(e){if($.value=e,await Q()){L.value=!0;return}z.value=1===e?T.value:W.value,3===e?E.value=!0:0===e?N.value=!0:F.value=!0}function el(){N.value=!0}function ea(e){K.value=e.data.type,Y.value=e.data.nodeId,R.value=!0}function et(e){var l;q.value&&(null==(l=q.value)||l.changeNodeData(e))}return(0,g.YP)(()=>C.value,e=>{a("update",{nodeType:e,nodeId:T.value})}),(l,a)=>{let h=y.Z,U=w.Z,_=v.Z,k=f.Z,b=p.Z,V=c.Z,A=m.Z,Q=s.Z,eo=r.Z,en=u.ZP,ei=d.ZP,ed=i.Z,eu=n.Z,er=o.ZP,es=t.Z;return(0,g.wg)(),(0,g.iD)(g.HY,null,[(0,g.Wm)(ei,{"header-style":I,"body-style":H},{title:(0,g.w5)(()=>[(0,g.Wm)(Q,null,{default:(0,g.w5)(()=>[(0,g.Wm)(_,{content:(0,g.SU)(G)("tree"),position:"bl",onOk:a[0]||(a[0]=e=>X("tree"))},{default:(0,g.w5)(()=>[(0,g.Wm)(U,{type:"outline"},{icon:(0,g.w5)(()=>[(0,g.Wm)(h,{rotate:180*!!x.value},null,8,["rotate"])]),_:1})]),_:1},8,["content"]),(0,g.Wm)(U,{type:"primary",disabled:(0,g.SU)(B)||!(0,g.SU)(T),onClick:a[1]||(a[1]=e=>ee(1))},{icon:(0,g.w5)(()=>[(0,g.Wm)(k)]),default:(0,g.w5)(()=>[a[14]||(a[14]=(0,g._)("span",null,"单事件",-1))]),_:1,__:[14]},8,["disabled"]),(0,g.Wm)(U,{type:"primary",disabled:(0,g.SU)(B),onClick:a[2]||(a[2]=e=>ee(2))},{icon:(0,g.w5)(()=>[(0,g.Wm)(b)]),default:(0,g.w5)(()=>[a[15]||(a[15]=(0,g._)("span",null,"单节点",-1))]),_:1,__:[15]},8,["disabled"]),(0,g.Wm)(U,{type:"primary",disabled:(0,g.SU)(B),onClick:a[3]||(a[3]=e=>ee(3))},{icon:(0,g.w5)(()=>[(0,g.Wm)(V)]),default:(0,g.w5)(()=>[a[16]||(a[16]=(0,g._)("span",null,"整个项目",-1))]),_:1,__:[16]},8,["disabled"]),(0,g.Wm)(U,{type:"primary",disabled:(0,g.SU)(B),onClick:a[4]||(a[4]=e=>ee(0))},{icon:(0,g.w5)(()=>[(0,g.Wm)(A)]),default:(0,g.w5)(()=>[a[17]||(a[17]=(0,g._)("span",null,"历史数据",-1))]),_:1,__:[17]},8,["disabled"])]),_:1})]),extra:(0,g.w5)(()=>[(0,g.Wm)(Q,null,{default:(0,g.w5)(()=>[e.isHazop?((0,g.wg)(),(0,g.j4)(en,{key:0,class:"w-128","model-value":(0,g.SU)(W),placeholder:"请选择节点",onChange:J},{default:(0,g.w5)(()=>[((0,g.wg)(!0),(0,g.iD)(g.HY,null,(0,g.Ko)((0,g.SU)(S),e=>((0,g.wg)(),(0,g.j4)(eo,{key:e.key,value:e.key},{default:(0,g.w5)(()=>[(0,g.Uk)(" 节点"+(0,g.zw)(e.order),1)]),_:2},1032,["value"]))),128))]),_:1},8,["model-value"])):(0,g.kq)("",!0),(0,g.Wm)(_,{content:(0,g.SU)(G)("form"),position:"br",onOk:a[5]||(a[5]=e=>X("form"))},{default:(0,g.w5)(()=>[(0,g.Wm)(U,{type:"outline"},{icon:(0,g.w5)(()=>[(0,g.Wm)(h,{rotate:180*!Z.value},null,8,["rotate"])]),_:1})]),_:1},8,["content"])]),_:1})]),default:(0,g.w5)(()=>[(0,g.Wm)(eV,{ref_key:"flowRef",ref:q,"flow-data-id":(0,g.SU)(T),"onUpdate:flowDataId":a[6]||(a[6]=e=>(0,g.dq)(T)?T.value=e:null),"flow-node-id":(0,g.SU)(D),"onUpdate:flowNodeId":a[7]||(a[7]=e=>(0,g.dq)(D)?D.value=e:null),"flow-node-type":(0,g.SU)(C),"onUpdate:flowNodeType":a[8]||(a[8]=e=>(0,g.dq)(C)?C.value=e:null),stop:(0,g.SU)(B),"is-hazop":e.isHazop,onUpdateNode:ea},null,8,["flow-data-id","flow-node-id","flow-node-type","stop","is-hazop"])]),_:1}),(0,g.Wm)(eq,{modelValue:(0,g.SU)(F),"onUpdate:modelValue":a[9]||(a[9]=e=>(0,g.dq)(F)?F.value=e:null),title:"风险分析","data-id":(0,g.SU)(z),"is-event":1===(0,g.SU)($),"is-hazop":e.isHazop,onOpenHistory:el},null,8,["modelValue","data-id","is-event","is-hazop"]),(0,g.Wm)(eI,{modelValue:(0,g.SU)(N),"onUpdate:modelValue":a[10]||(a[10]=e=>(0,g.dq)(N)?N.value=e:null),title:"历史数据",footer:!1,"modal-type":(0,g.SU)($),"is-hazop":e.isHazop},null,8,["modelValue","modal-type","is-hazop"]),(0,g.Wm)(eF,{modelValue:(0,g.SU)(E),"onUpdate:modelValue":a[11]||(a[11]=e=>(0,g.dq)(E)?E.value=e:null),title:"分析结果汇总",footer:!1,"is-hazop":e.isHazop},null,8,["modelValue","is-hazop"]),(0,g.Wm)(O,{modelValue:(0,g.SU)(R),"onUpdate:modelValue":a[12]||(a[12]=e=>(0,g.dq)(R)?R.value=e:null),"node-type":(0,g.SU)(K),"node-id":(0,g.SU)(Y),"is-hazop":e.isHazop,onUpdate:et},null,8,["modelValue","node-type","node-id","is-hazop"]),(0,g.Wm)(es,{modelValue:(0,g.SU)(L),"onUpdate:modelValue":a[13]||(a[13]=e=>(0,g.dq)(L)?L.value=e:null),title:"错误列表",height:"44dvh",placement:"bottom",footer:!1,"body-style":P},{default:(0,g.w5)(()=>[(0,g.Wm)(er,{size:"small",hoverable:""},{default:(0,g.w5)(()=>[((0,g.wg)(!0),(0,g.iD)(g.HY,null,(0,g.Ko)((0,g.SU)(M),e=>((0,g.wg)(),(0,g.j4)(eu,{key:e.id,onClick:l=>{var a;q.value&&(null==(a=q.value)||a.changeNodeCheck(e))}},{default:(0,g.w5)(()=>[(0,g.Wm)(ed,{size:"14",style:j}),(0,g._)("span",null,"危险剧情错误，剧情不完整，"+(0,g.zw)(e.nodeName),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1},8,["modelValue"])],64)}}})},99008:function(e,l,a){a.d(l,{Z:()=>k});var t=a(86033);a(15745);var o=a(36178);a(45264);var n=a(38699);a(87265);var i=a(40098);a(86911);var d=a(75792);a(45508);var u=a(95557),r=a(42763);a(14433);var s=a(32110);a(67328);var m=a(74953);a(38499);var c=a(10849),p=a(2421);a(3498);var f=a(30932),v=a(65754),w=a(36186);let y=[{title:"事件类型",key:"eventType",tag:0,cmp:[1,2],type:[0,1,2],disabled:[0,1,2]},{title:"事件属性",key:"eventProperty",tag:0,cmp:[1,2],type:[0,1,2],disabled:[0,2]},{title:"使能条件",key:"enablingCondition",tag:1,cmp:[2],type:[0],disabled:[0]},{title:"使能事件",key:"enablingEvent",tag:0,cmp:[2],type:[1],disabled:[1]},{title:"消减因子",key:"reductionFactor",tag:1,cmp:[2],type:[0,1],disabled:[0,1]},{title:"所属节点",key:"hazopNodeId",tag:0,cmp:[1,2],type:[0,1,2],disabled:[0,1,2]},{title:"所属设备",key:"deviceId",tag:0,cmp:[1,2],type:[0,1,2],disabled:[]},{title:"位号",key:"positionNumber",tag:1,cmp:[1,2],type:[0,1,2],disabled:[]},{title:"参数类型",key:"parameterType",tag:0,cmp:[1,2],type:[1],disabled:[0,2]},{title:"参数描述",key:"parameterDescription",tag:3,cmp:[1,2],type:[1],disabled:[0,2]},{title:"引导词",key:"guideWordId",tag:0,cmp:[2],type:[1],disabled:[]},{title:"事件描述",key:"eventDescription",tag:3,cmp:[1,2],type:[0,1,2],disabled:[]},{title:"频率",key:"frequencyId",tag:0,cmp:[1,2],type:[0],disabled:[]},{title:"阈值上限",key:"thresholdUpperLimit",tag:2,cmp:[1,2],type:[1],disabled:[]},{title:"阈值下限",key:"thresholdLowerLimit",tag:2,cmp:[1,2],type:[1],disabled:[]},{title:"条件修正量-点火概率",key:"isIgnitionProbability",tag:4,cmp:[2],type:[2],disabled:[2]},{title:"条件修正量-点火概率(消减因子)",key:"ignitionProbabilityReductionFactor",tag:1,cmp:[2],type:[2],disabled:[]},{title:"条件修正量-致死概率",key:"isFatalityProbability",tag:4,cmp:[2],type:[2],disabled:[2]},{title:"条件修正量-致死概率(消减因子)",key:"fatalityProbabilityReductionFactor",tag:1,cmp:[2],type:[2],disabled:[]},{title:"条件修正量-人员暴露概率",key:"isPersonnelExposureProbability",tag:4,cmp:[2],type:[2],disabled:[2]},{title:"条件修正量-人员暴露概率(消减因子)",key:"personnelExposureProbabilityReductionFactor",tag:1,cmp:[2],type:[2],disabled:[]},{title:"条件修正量-其他",key:"isOtherProbability",tag:4,cmp:[2],type:[2],disabled:[2]},{title:"条件修正量-其他(消减因子)",key:"otherProbabilityReductionFactor",tag:1,cmp:[2],type:[2],disabled:[]},{title:"严重性类别",key:"yzxlb",tag:0,cmp:[1,2],type:[2],disabled:[]},{title:"严重性级别",key:"yzxjb",tag:0,cmp:[1,2],type:[2],disabled:[]},{title:"安全措施数量",key:"safetyMeasureCount",tag:1,cmp:[2],type:[0,1,2],disabled:[0,1,2]},{title:"建议措施数量",key:"suggestionMeasureCount",tag:1,cmp:[2],type:[0,1,2],disabled:[0,1,2]}],g={eventType:"",eventProperty:"",enablingCondition:"",enablingEvent:"",reductionFactor:"",hazopNodeId:"",deviceId:"",positionNumber:"",parameterType:"",parameterDescription:"",guideWordId:"",eventDescription:"",frequencyId:"",safetyMeasureCount:"",suggestionMeasureCount:"",thresholdUpperLimit:"",thresholdLowerLimit:"",ignitionProbability:"",ignitionReductionFactor:"",lethalityProbability:"",lethalityReductionFactor:"",exposureProbability:"",exposureReductionFactor:"",otherConditions:"",otherReductionFactors:"",seriousnessList:[],isIgnitionProbability:0,ignitionProbabilityReductionFactor:"",isFatalityProbability:0,fatalityProbabilityReductionFactor:"",isPersonnelExposureProbability:0,personnelExposureProbabilityReductionFactor:"",isOtherProbability:0,otherProbabilityReductionFactor:""},h={eventType:[{name:"原因",id:0},{name:"偏离",id:1},{name:"后果",id:2}],eventProperty:[{name:"具体事件",id:0},{name:"概念事件",id:1}],word:[],whether:[{name:"是",id:1},{name:"否",id:0}]};var U=a(35017),_=a(30530);let k=(0,v.aZ)({__name:"o-form",props:{nodeId:{type:String,default:""},nodeType:{type:Number,default:null},isHazop:{type:Boolean,default:!1}},setup(e){let l=(0,U.a)(),{deviceList:a,nodeList:k,paramsList:b,typeList:S,levelList:W,frequencyList:V,hazopNodeId:x}=(0,_.Jk)(l),Z=(0,v.iH)(!1),I={padding:"5px"},H={padding:"3px",height:"calc(100dvh - 116px)"},P=(0,v.iH)(null),j=(0,v.iH)({}),z=(0,v.iH)([]),q=(0,v.Fl)(()=>e=>"deviceId"===e?[{id:"0",name:"无"},...a.value]:"hazopNodeId"===e?k.value:"parameterType"===e?b.value:"frequencyId"===e?V.value:"yzxlb"===e?S.value:"yzxjb"===e?W.value:h[e]||[]),T=function(){let l=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return[0,1,2].includes(e.nodeType)?l:!l};async function D(l){if(![0,1,2].includes(l))return;Z.value||(Z.value=!0);let{items:a}=function(e,l){let a=[...y].filter(a=>a.type.includes(e)&&a.cmp.includes(l)),t=a.reduce((e,l)=>(e[l.key]="",e),{});return{items:a,keys:t}}(l,e.isHazop?1:2);z.value.length>0&&z.value.splice(0),z.value.push(...a);let t=[w.mw,w.f,w.vi];try{j.value={};let a=await t[l](e.nodeId);if(200===a.code){let e=a.result||{},l=+e.eventProperty||1;j.value=Object.assign(g,e,{hazopNodeId:x.value,eventProperty:l})}}finally{Z.value=!1}}return(0,v.YP)(()=>e.nodeType,e=>D(e),{immediate:!0}),(e,l)=>{let a=f.Z,w=p.ZP,y=c.Z,g=m.ZP,h=s.Z,U=r.Z,_=u.Z,k=d.Z,b=i.Z,S=n.Z,W=o.ZP,V=t.Z;return(0,v.wg)(),(0,v.j4)(V,{loading:(0,v.SU)(Z),dot:"",tip:"数据加载中"},{default:(0,v.w5)(()=>[(0,v.Wm)(W,{title:"属性面板","head-style":I,"body-style":H},{default:(0,v.w5)(()=>[(0,v.wy)((0,v.Wm)(b,{ref_key:"formRef",ref:P,model:(0,v.SU)(j),layout:"vertical",disabled:""},{default:(0,v.w5)(()=>[((0,v.wg)(!0),(0,v.iD)(v.HY,null,(0,v.Ko)((0,v.SU)(z),e=>((0,v.wg)(),(0,v.iD)(v.HY,{key:e.key},[["yzxlb","yzxjb"].includes(e.key)?((0,v.wg)(!0),(0,v.iD)(v.HY,{key:0},(0,v.Ko)((0,v.SU)(j).seriousnessList,(l,t)=>((0,v.wg)(),(0,v.j4)(y,{key:t,label:`${e.title}${t+1}`},{default:(0,v.w5)(()=>[(0,v.Wm)(w,{"model-value":l["yzxlb"===e.key?"id":"levelId"]},{default:(0,v.w5)(()=>[((0,v.wg)(!0),(0,v.iD)(v.HY,null,(0,v.Ko)((0,v.SU)(q)(e.key),e=>((0,v.wg)(),(0,v.j4)(a,{key:e.value,value:e.value},{default:(0,v.w5)(()=>[(0,v.Uk)((0,v.zw)(e.label),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["model-value"])]),_:2},1032,["label"]))),128)):((0,v.wg)(),(0,v.j4)(y,{key:1,field:e.key,label:e.title},{default:(0,v.w5)(()=>[1===e.tag?((0,v.wg)(),(0,v.j4)(g,{key:0,"model-value":function(e){let l=z.value[e]||"";return`${l}`}(e.key)},null,8,["model-value"])):2===e.tag?((0,v.wg)(),(0,v.j4)(h,{key:1,"model-value":(0,v.SU)(j)[e.key]},null,8,["model-value"])):3===e.tag?((0,v.wg)(),(0,v.j4)(U,{key:2,"model-value":(0,v.SU)(j)[e.key],"auto-size":""},null,8,["model-value"])):4===e.tag?((0,v.wg)(),(0,v.j4)(k,{key:3,"model-value":(0,v.SU)(j)[e.key]},{default:(0,v.w5)(()=>[(0,v.Wm)(_,{value:1},{default:(0,v.w5)(()=>l[0]||(l[0]=[(0,v.Uk)(" 是 ",-1)])),_:1,__:[0]}),(0,v.Wm)(_,{value:0},{default:(0,v.w5)(()=>l[1]||(l[1]=[(0,v.Uk)(" 否 ",-1)])),_:1,__:[1]})]),_:2},1032,["model-value"])):((0,v.wg)(),(0,v.j4)(w,{key:4,"model-value":(0,v.SU)(j)[e.key]},{default:(0,v.w5)(()=>[((0,v.wg)(!0),(0,v.iD)(v.HY,null,(0,v.Ko)((0,v.SU)(q)(e.key),e=>((0,v.wg)(),(0,v.j4)(a,{key:e.id,value:e.id},{default:(0,v.w5)(()=>[(0,v.Uk)((0,v.zw)(e.name),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["model-value"]))]),_:2},1032,["field","label"]))],64))),128))]),_:1},8,["model"]),[[v.F8,T(!0)]]),T(!1)?((0,v.wg)(),(0,v.j4)(S,{key:0,description:"请选择节点"})):(0,v.kq)("",!0)]),_:1})]),_:1},8,["loading"])}}})},89847:function(e,l,a){a.d(l,{Z:()=>W});var t=a(36178);a(45264);var o=a(34945),n=a(40098);a(86911);var i=a(42763);a(14433);var d=a(32374);a(38427);var u=a(2421);a(3498);var r=a(30932),s=a(10849),m=a(74953);a(38499);var c=a(38699);a(87265);var p=a(80273);a(45791);var f=a(25263),v=a(18625),w=a(94140);a(76270);var y=a(48894),g=a(65754),h=a(36186),U=a(9286),_=a(35017),k=a(30530),b=a(77504),S=a(23565);let W=(0,g.aZ)({__name:"o-tree",props:(0,g.Vf)({title:{type:String,default:""},data:{type:Array,default:()=>[]},showLine:{type:Boolean,default:!0},auth:{type:Array,default:()=>["add","edit","delete"]},expand:{type:Array,default:()=>[]},isHazop:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:(0,g.Vf)(["query","delete"],["update:modelValue"]),setup(e,l){let{expose:a,emit:W}=l,V=(0,U.F)(),x=(0,_.a)(),Z=V.itemsType,{meetingList:I,staffList:H}=(0,k.Jk)(x),P=(0,g.tT)(e,"modelValue"),j=(0,g.iH)(null),z={padding:"5px"},q={padding:"2px",height:"calc(100dvh -  116px)"},T=(0,g.iH)(!1),D=(0,g.iH)(16),C=(0,g.iH)(!1),F=(0,g.iH)(!1),N=(0,g.iH)(null),E={projectId:Z,id:null,name:"",meetingId:"",analysisDate:"",participantIds:[],description:"",designIntent:"",keyEquipmentDesign:"",drawingNumber:""},A=(0,g.iH)({...E}),L={required:!0,message:"必填项不能为空",trigger:"blur"},M=(0,g.Fl)(()=>e.auth.includes("add")),R=(0,g.Fl)(()=>e.auth.includes("edit")),K=(0,g.Fl)(()=>e.auth.includes("delete")),Y=(0,g.Fl)(()=>F.value?"新建节点":"编辑节点"),O=(0,g.Fl)(()=>e=>1===e.chairman?"（主席）":e.jobTitle?`\u{FF08}${e.jobTitle}\u{FF09}`:"");function $(l){let a=!0;return e.isHazop?([null,3].includes(l.type)?a=!1:["原因","偏离","后果"].includes(l.title)&&(a=!1),a):a=[0,1,2].includes(l.type)}function B(e){W("query",e[0])}function G(e){F.value=null===e,F.value?(A.value={...E},C.value=!0):(0,h.gs)(e.key).then(e=>{A.value={...e.result||{}},C.value=!0})}async function X(){T.value=!0;try{let e=(0,g.IU)(A.value),l=F.value?await (0,h.jv)(e):await (0,h.TA)(e);200===l.code&&(S.Z.success("保存成功"),C.value=!1,W("query"))}catch(e){}finally{T.value=!1}}return a({handleFold:function(e){j.value.expandAll(e)}}),(l,a)=>{let h=y.Z,U=w.Z,_=v.Z,k=f.Z,S=p.Z,V=c.Z,x=m.ZP,Z=s.Z,F=r.Z,E=u.ZP,J=d.ZP,Q=i.Z,ee=n.Z,el=o.Z,ea=t.ZP;return(0,g.wg)(),(0,g.j4)(ea,{title:e.title,"header-style":z,"body-style":q},{default:(0,g.w5)(()=>[(0,g.Wm)(S,{ref_key:"treeRef",ref:j,"selected-keys":P.value,"onUpdate:selectedKeys":a[1]||(a[1]=e=>P.value=e),data:e.data,"default-selected-keys":P.value,"default-expanded-keys":e.expand,selectable:$,"block-node":!0,"show-line":e.showLine,onSelect:B},{title:(0,g.w5)(l=>[(0,g.Uk)((0,g.zw)(e.isHazop&&l.order?`\u{8282}\u{70B9}${l.order}`:l.title),1)]),extra:(0,g.w5)(e=>[(0,g.SU)(M)&&null===e.type?((0,g.wg)(),(0,g.j4)(U,{key:0,type:"text",size:"mini",onClick:a[0]||(a[0]=e=>G(null))},{icon:(0,g.w5)(()=>[(0,g.Wm)(h,{size:(0,g.SU)(D)},null,8,["size"])]),_:1})):(0,g.kq)("",!0),-1===e.type?((0,g.wg)(),(0,g.iD)(g.HY,{key:1},[(0,g.SU)(R)?((0,g.wg)(),(0,g.j4)(U,{key:0,type:"text",size:"mini",onClick:l=>G(e)},{icon:(0,g.w5)(()=>[(0,g.Wm)(_,{size:(0,g.SU)(D)},null,8,["size"])]),_:2},1032,["onClick"])):(0,g.kq)("",!0),(0,g.SU)(K)?((0,g.wg)(),(0,g.j4)(U,{key:1,type:"text",size:"mini",status:"danger",onClick:l=>{b.Z.confirm({title:"删除提示",content:`\u{786E}\u{8BA4}\u{5220}\u{9664} \u{201C}${e.title}\u{201D} \u{5417}\u{FF1F}`,onOk:()=>W("delete",e)})}},{icon:(0,g.w5)(()=>[(0,g.Wm)(k,{size:(0,g.SU)(D)},null,8,["size"])]),_:2},1032,["onClick"])):(0,g.kq)("",!0)],64)):(0,g.kq)("",!0)]),_:1},8,["selected-keys","data","default-selected-keys","default-expanded-keys","show-line"]),0===e.data.length?((0,g.wg)(),(0,g.j4)(V,{key:0})):(0,g.kq)("",!0),e.isHazop?((0,g.wg)(),(0,g.j4)(el,{key:1,modelValue:(0,g.SU)(C),"onUpdate:modelValue":a[10]||(a[10]=e=>(0,g.dq)(C)?C.value=e:null),"form-ref":(0,g.SU)(N),title:(0,g.SU)(Y),"ok-loading":(0,g.SU)(T),onOk:X},{default:(0,g.w5)(()=>[(0,g.Wm)(ee,{ref_key:"formRef",ref:N,model:(0,g.SU)(A),"auto-label-width":""},{default:(0,g.w5)(()=>[(0,g.Wm)(Z,{label:"节点名字",field:"name","show-colon":"",rules:L},{default:(0,g.w5)(()=>[(0,g.Wm)(x,{modelValue:(0,g.SU)(A).name,"onUpdate:modelValue":a[2]||(a[2]=e=>(0,g.SU)(A).name=e),modelModifiers:{trim:!0},"max-length":50,"allow-clear":""},null,8,["modelValue"])]),_:1},8,["rules"]),(0,g.Wm)(Z,{label:"选择会议",field:"meetingId","show-colon":""},{default:(0,g.w5)(()=>[(0,g.Wm)(E,{modelValue:(0,g.SU)(A).meetingId,"onUpdate:modelValue":a[3]||(a[3]=e=>(0,g.SU)(A).meetingId=e),modelModifiers:{trim:!0},"allow-clear":""},{default:(0,g.w5)(()=>[((0,g.wg)(!0),(0,g.iD)(g.HY,null,(0,g.Ko)((0,g.SU)(I),e=>((0,g.wg)(),(0,g.j4)(F,{key:e.id,value:e.id},{default:(0,g.w5)(()=>[(0,g.Uk)((0,g.zw)(e.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,g.Wm)(Z,{label:"分析日期",field:"analysisDate","show-colon":""},{default:(0,g.w5)(()=>[(0,g.Wm)(J,{modelValue:(0,g.SU)(A).analysisDate,"onUpdate:modelValue":a[4]||(a[4]=e=>(0,g.SU)(A).analysisDate=e),class:"w-100","show-time":"",format:"YYYY-MM-DD HH:mm",placeholder:"选择分析日期"},null,8,["modelValue"])]),_:1}),(0,g.Wm)(Z,{label:"参会人员",field:"participantIds","show-colon":""},{default:(0,g.w5)(()=>[(0,g.Wm)(E,{modelValue:(0,g.SU)(A).participantIds,"onUpdate:modelValue":a[5]||(a[5]=e=>(0,g.SU)(A).participantIds=e),multiple:"","allow-search":"","allow-clear":""},{default:(0,g.w5)(()=>[((0,g.wg)(!0),(0,g.iD)(g.HY,null,(0,g.Ko)((0,g.SU)(H),e=>((0,g.wg)(),(0,g.j4)(F,{key:e.id,value:e.id},{default:(0,g.w5)(()=>[(0,g.Uk)((0,g.zw)(e.name)+(0,g.zw)((0,g.SU)(O)(e))+(0,g.zw)(e.companyName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,g.Wm)(Z,{label:"节点描述",field:"description","show-colon":""},{default:(0,g.w5)(()=>[(0,g.Wm)(Q,{modelValue:(0,g.SU)(A).description,"onUpdate:modelValue":a[6]||(a[6]=e=>(0,g.SU)(A).description=e),"max-length":200,"allow-clear":""},null,8,["modelValue"])]),_:1}),(0,g.Wm)(Z,{label:"设计意图",field:"designIntent","show-colon":""},{default:(0,g.w5)(()=>[(0,g.Wm)(Q,{modelValue:(0,g.SU)(A).designIntent,"onUpdate:modelValue":a[7]||(a[7]=e=>(0,g.SU)(A).designIntent=e),"max-length":200,"allow-clear":""},null,8,["modelValue"])]),_:1}),(0,g.Wm)(Z,{label:"关键设备设计/操作参数",field:"keyEquipmentDesign","show-colon":""},{default:(0,g.w5)(()=>[(0,g.Wm)(Q,{modelValue:(0,g.SU)(A).keyEquipmentDesign,"onUpdate:modelValue":a[8]||(a[8]=e=>(0,g.SU)(A).keyEquipmentDesign=e),"max-length":200,"allow-clear":""},null,8,["modelValue"])]),_:1}),(0,g.Wm)(Z,{label:"图纸图号",field:"drawingNumber","show-colon":""},{default:(0,g.w5)(()=>[(0,g.Wm)(x,{modelValue:(0,g.SU)(A).drawingNumber,"onUpdate:modelValue":a[9]||(a[9]=e=>(0,g.SU)(A).drawingNumber=e),modelModifiers:{trim:!0},"max-length":50,"allow-clear":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","form-ref","title","ok-loading"])):(0,g.kq)("",!0)]),_:1},8,["title"])}}})},34945:function(e,l,a){a.d(l,{Z:()=>n});var t=a(97385);a(84927);var o=a(65754);let n=(0,o.aZ)({__name:"v-drawer",props:(0,o.Vf)({formRef:{default:null},title:{default:""},width:{default:"640px"},loading:{type:Boolean,default:!1},footer:{type:Boolean,default:!0},placement:{default:"right"},bodyStyle:{default:()=>({})}},{modelValue:{default:!1},modelModifiers:{}}),emits:(0,o.Vf)(["ok","cancel"],["update:modelValue"]),setup(e,l){let{emit:a}=l,n=(0,o.tT)(e,"modelValue"),{formRef:i,title:d,width:u,loading:r,placement:s,bodyStyle:m}=(0,o.BK)(e);async function c(){i.value&&void 0!==await i.value.validate()||a("ok")}function p(){i.value&&i.value.resetFields(),n.value=!1}return(e,l)=>{let a=t.Z;return(0,o.wg)(),(0,o.j4)(a,{width:(0,o.SU)(u),title:(0,o.SU)(d),visible:n.value,"mask-closable":!1,"esc-to-close":!1,placement:(0,o.SU)(s),footer:e.footer,"ok-loading":(0,o.SU)(r),"body-style":(0,o.SU)(m),onOk:c,onCancel:p},{default:(0,o.w5)(()=>[(0,o.WI)(e.$slots,"default")]),_:3},8,["width","title","visible","placement","footer","ok-loading","body-style"])}}})},72024:function(e,l,a){a.d(l,{Z:()=>i});var t=a(77504);a(15480);var o=a(59643);a(30858);var n=a(65754);let i=(0,n.aZ)({__name:"v-modal",props:(0,n.Vf)({title:{type:String,default:""},width:{type:String,default:"64dvw"},footer:{type:Boolean,default:!0},isSpace:{type:Boolean,default:!0},isHeader:{type:Boolean,default:!1}},{modelValue:{default:!1},modelModifiers:{}}),emits:(0,n.Vf)(["update"],["update:modelValue"]),setup(e,l){let{emit:a}=l,i=(0,n.tT)(e,"modelValue"),{title:d,width:u,footer:r,isSpace:s,isHeader:m}=(0,n.BK)(e),c=(0,n.qj)({height:"98dvh"}),p=(0,n.Fl)(()=>{let e=r.value?"calc(100% - 113px)":"calc(100% - 48px)";return{padding:s.value?"5px":"0",height:e}});function f(){a("update")}return(e,l)=>{let a=o.Z,v=t.Z;return(0,n.wg)(),(0,n.j4)(v,{visible:i.value,"onUpdate:visible":l[0]||(l[0]=e=>i.value=e),"modal-style":(0,n.SU)(c),"body-style":(0,n.SU)(p),title:(0,n.SU)(d),width:(0,n.SU)(u),footer:(0,n.SU)(r),closable:!(0,n.SU)(r),"esc-to-close":!1,"mask-closable":!1,"unmount-on-close":!0,onOk:f},(0,n.Nv)({default:(0,n.w5)(()=>[(0,n.SU)(s)?((0,n.wg)(),(0,n.j4)(a,{key:0,direction:"vertical",fill:""},{default:(0,n.w5)(()=>[(0,n.WI)(e.$slots,"default")]),_:3})):(0,n.WI)(e.$slots,"default",{key:1})]),_:2},[(0,n.SU)(m)?{name:"title",fn:(0,n.w5)(()=>[(0,n.WI)(e.$slots,"header")]),key:"0"}:void 0]),1032,["visible","modal-style","body-style","title","width","footer","closable"])}}})},56655:function(e,l,a){a.d(l,{Z:()=>s});var t=a(8176);a(86166);var o=a(59643);a(30858);var n=a(94140);a(76270);var i=a(65754),d=a(91229),u=a(77504);let r={key:0},s=(0,i.aZ)({__name:"v-table",props:{loading:{type:Boolean,default:!1},title:{default:""},showIndex:{type:Boolean,default:!0},actionItems:{default:()=>["add","edit","delete"]},showExport:{type:Boolean,default:!1},showUpload:{type:Boolean,default:!1},showSignature:{type:Boolean,default:!1},optionalWidth:{default:160},rowKey:{default:"id"},hideQuery:{type:Boolean,default:!1},hidePage:{type:Boolean,default:!1},columns:{default:()=>[]},data:{default:()=>[]},total:{default:0},current:{default:1},isBulk:{type:Boolean,default:!0},addText:{default:"新建数据"},pageConfig:{default:{showJumper:!1,showPageSize:!0,pageSizeOptions:[10,20,50]}}},emits:["query","update","delete","export","upload","signature"],setup(e,l){let{emit:a}=l,s=(0,i.Vh)(e,"loading"),m=e.actionItems.length>0||e.showExport||e.showUpload||e.showSignature,c=e.actionItems.includes("add"),p=e.actionItems.includes("edit"),f=!e.hideQuery,v=e.actionItems.includes("delete"),w=e.showExport,y=e.showUpload,g=e.showSignature,h=e.isBulk?{type:"checkbox",showCheckedAll:!0,onlypageNo:!0}:null,U=(0,i.iH)(h),_=(0,i.iH)([]),k={align:"center",title:"序号",width:80,slotName:"index"},b={align:"center",title:"操作",width:e.optionalWidth,slotName:"optional"},S=Object.assign({current:1,pageSize:10,showTotal:!0,showPageSize:!1},e.pageConfig),W=(0,i.iH)(!e.hidePage&&S),V=(0,i.Fl)(()=>0===_.value.length),x=(0,i.Fl)(()=>{let l=e.showIndex?[k]:[];return[...l,...e.columns,...m?[b]:[]]});function Z(){let e={pageNo:W.value.current,pageSize:W.value.pageSize};_.value.length>0&&(_.value=[]),a("query",e)}(0,i.YP)(()=>e.current,e=>{1===e&&!1!==W.value&&(W.value.current=1)});let I=(0,d.Z)(()=>Z(),100);function H(e){W.value.current!==e&&(W.value.current=e,I())}function P(e){W.value.pageSize!==e&&(W.value.pageSize=e,I())}function j(){e.hidePage||(W.value.current=1,W.value.pageSize=10),Z()}function z(e,l){a("update",{isEdit:e,item:l})}function q(l){let t=null===l?_.value:[l[e.rowKey]];u.Z.confirm({title:"删除提示",content:"确定删除当前选中数据吗？",onOk:()=>a("delete",t)})}return(e,l)=>{let d=n.Z,u=o.Z,m=t.ZP;return(0,i.wg)(),(0,i.j4)(u,{direction:"vertical"},{default:(0,i.w5)(()=>[(0,i.Wm)(u,null,{default:(0,i.w5)(()=>[e.title.length?((0,i.wg)(),(0,i.iD)("strong",r,(0,i.zw)(e.title),1)):(0,i.kq)("",!0),(0,i.SU)(c)?((0,i.wg)(),(0,i.j4)(d,{key:1,type:"primary",onClick:l[0]||(l[0]=e=>z(!1))},{default:(0,i.w5)(()=>[(0,i.Uk)((0,i.zw)(e.addText),1)]),_:1})):(0,i.kq)("",!0),(0,i.WI)(e.$slots,"form"),f?((0,i.wg)(),(0,i.j4)(d,{key:2,type:"primary",onClick:j},{default:(0,i.w5)(()=>l[3]||(l[3]=[(0,i.Uk)(" 刷新 ",-1)])),_:1,__:[3]})):(0,i.kq)("",!0),e.isBulk?((0,i.wg)(),(0,i.j4)(d,{key:3,type:"primary",status:"danger",disabled:(0,i.SU)(V),onClick:l[1]||(l[1]=e=>q(null))},{default:(0,i.w5)(()=>l[4]||(l[4]=[(0,i.Uk)(" 批量删除 ",-1)])),_:1,__:[4]},8,["disabled"])):(0,i.kq)("",!0),(0,i.WI)(e.$slots,"button")]),_:3}),(0,i.Wm)(m,{"selected-keys":(0,i.SU)(_),"onUpdate:selectedKeys":l[2]||(l[2]=e=>(0,i.dq)(_)?_.value=e:null),total:e.total,"row-key":e.rowKey,loading:(0,i.SU)(s),columns:(0,i.SU)(x),data:e.data,pagination:!e.hidePage&&{...(0,i.SU)(W),total:e.total,current:e.current},"table-layout-fixed":!0,"row-selection":(0,i.SU)(U),onPageChange:H,onPageSizeChange:P},{index:(0,i.w5)(e=>{let{rowIndex:l}=e;return[(0,i.Uk)((0,i.zw)(l+1),1)]}),custom:(0,i.w5)(l=>{let{record:a}=l;return[(0,i.WI)(e.$slots,"custom",{record:a})]}),optional:(0,i.w5)(e=>{let{record:t}=e;return[(0,i.Wm)(u,null,{default:(0,i.w5)(()=>[(0,i.SU)(w)?((0,i.wg)(),(0,i.j4)(d,{key:0,type:"text",onClick:e=>{a("export",t)}},{default:(0,i.w5)(()=>l[5]||(l[5]=[(0,i.Uk)(" 导出 ",-1)])),_:2,__:[5]},1032,["onClick"])):(0,i.kq)("",!0),(0,i.SU)(y)?((0,i.wg)(),(0,i.j4)(d,{key:1,type:"text",onClick:e=>{a("upload",t)}},{default:(0,i.w5)(()=>l[6]||(l[6]=[(0,i.Uk)(" 上传 ",-1)])),_:2,__:[6]},1032,["onClick"])):(0,i.kq)("",!0),(0,i.SU)(g)?((0,i.wg)(),(0,i.j4)(d,{key:2,type:"text",onClick:e=>{a("signature",t)}},{default:(0,i.w5)(()=>l[7]||(l[7]=[(0,i.Uk)(" 电子签名 ",-1)])),_:2,__:[7]},1032,["onClick"])):(0,i.kq)("",!0),(0,i.SU)(p)?((0,i.wg)(),(0,i.j4)(d,{key:3,type:"text",onClick:e=>z(!0,t)},{default:(0,i.w5)(()=>l[8]||(l[8]=[(0,i.Uk)(" 编辑 ",-1)])),_:2,__:[8]},1032,["onClick"])):(0,i.kq)("",!0),(0,i.SU)(v)?((0,i.wg)(),(0,i.j4)(d,{key:4,type:"text",status:"danger",onClick:e=>q(t)},{default:(0,i.w5)(()=>l[9]||(l[9]=[(0,i.Uk)(" 删除 ",-1)])),_:2,__:[9]},1032,["onClick"])):(0,i.kq)("",!0)]),_:2},1024)]}),_:3},8,["selected-keys","total","row-key","loading","columns","data","pagination","row-selection"])]),_:3})}}})},23490:function(e,l,a){a.d(l,{Z:()=>w});var t=a(34945),o=a(40098);a(86911);var n=a(10849),i=a(74953);a(38499);var d=a(38699);a(87265);var u=a(80273);a(45791);var r=a(25263),s=a(49746);a(76270);var m=a(48894),c=a(94140),p=a(18625),f=a(65754),v=a(77504);let w=(0,f.aZ)({__name:"v-tree",props:(0,f.Vf)({data:{type:Array,default:()=>[]},showLine:{type:Boolean,default:!0},checkable:{type:Boolean,default:!1},strictly:{type:Boolean,default:!1},auth:{type:Array,default:()=>["add","edit","delete"]},fieldNames:{type:Object,default:()=>({key:"key",title:"title",children:"children"})},addTitle:{type:String,default:""},editTitle:{type:String,default:""}},{modelValue:{},modelModifiers:{}}),emits:(0,f.Vf)(["query","update","delete"],["update:modelValue"]),setup(e,l){let{emit:a}=l,w=(0,f.tT)(e,"modelValue"),{data:y,showLine:g,strictly:h,auth:U,addTitle:_,editTitle:k}=(0,f.BK)(e),b=(0,f.iH)(!1),S=(0,f.iH)(16),W=(0,f.iH)(!1),V=(0,f.iH)(!1),x=(0,f.iH)(null),Z=(0,f.iH)({id:null,name:""}),I={required:!0,message:"必填项不能为空",trigger:"blur"},H=(0,f.Fl)(()=>U.value.includes("add")),P=(0,f.Fl)(()=>U.value.includes("edit")),j=(0,f.Fl)(()=>U.value.includes("delete")),z=(0,f.Fl)(()=>V.value?_.value||"新建节点":k.value||"编辑节点");function q(e){a("query",e[0])}function T(l){let{key:a,title:t}=e.fieldNames;Object.assign(Z.value,{id:l[a],name:l[t]}),b.value=!1,V.value=!1,W.value=!0}function D(){b.value=!0,a("update",{data:Z.value,isEdit:!V.value}),W.value=!1}return(l,U)=>{let _=p.Z,k=c.Z,C=m.Z,F=s.Z,N=r.Z,E=u.Z,A=d.Z,L=i.ZP,M=n.Z,R=o.Z,K=t.Z;return(0,f.wg)(),(0,f.iD)(f.HY,null,[(0,f.Wm)(E,{"selected-keys":w.value,"onUpdate:selectedKeys":U[0]||(U[0]=e=>w.value=e),data:(0,f.SU)(y),"default-checked-keys":w.value,"block-node":!0,"show-line":(0,f.SU)(g),checkable:e.checkable,"field-names":e.fieldNames,"check-strictly":(0,f.SU)(h),onSelect:q},{extra:(0,f.w5)(e=>[(0,f.SU)(H)?((0,f.wg)(),(0,f.j4)(F,{key:0},{default:(0,f.w5)(()=>[(0,f.SU)(P)?((0,f.wg)(),(0,f.j4)(k,{key:0,type:"text",size:"mini",onClick:l=>T(e)},{icon:(0,f.w5)(()=>[(0,f.Wm)(_,{size:(0,f.SU)(S)},null,8,["size"])]),_:2},1032,["onClick"])):(0,f.kq)("",!0),(0,f.SU)(H)&&0===e.allowDelete?((0,f.wg)(),(0,f.j4)(k,{key:1,type:"text",size:"mini",onClick:e=>void(Object.assign(Z.value,{id:null,name:""}),b.value=!1,V.value=!0,W.value=!0)},{icon:(0,f.w5)(()=>[(0,f.Wm)(C,{size:(0,f.SU)(S)},null,8,["size"])]),_:2},1032,["onClick"])):(0,f.kq)("",!0)]),_:2},1024)):((0,f.wg)(),(0,f.j4)(F,{key:1},{default:(0,f.w5)(()=>[(0,f.SU)(P)?((0,f.wg)(),(0,f.j4)(k,{key:0,type:"text",size:"mini",onClick:l=>T(e)},{icon:(0,f.w5)(()=>[(0,f.Wm)(_,{size:(0,f.SU)(S)},null,8,["size"])]),_:2},1032,["onClick"])):(0,f.kq)("",!0),(0,f.SU)(j)&&1===e.allowDelete?((0,f.wg)(),(0,f.j4)(k,{key:1,type:"text",size:"mini",status:"danger",onClick:l=>{v.Z.confirm({title:"删除提示",content:`\u{786E}\u{8BA4}\u{5220}\u{9664} \u{201C}${e.name}\u{201D} \u{5417}\u{FF1F}`,onOk:()=>a("delete",e)})}},{icon:(0,f.w5)(()=>[(0,f.Wm)(N,{size:(0,f.SU)(S)},null,8,["size"])]),_:2},1032,["onClick"])):(0,f.kq)("",!0)]),_:2},1024))]),_:1},8,["selected-keys","data","default-checked-keys","show-line","checkable","field-names","check-strictly"]),0===(0,f.SU)(y).length?((0,f.wg)(),(0,f.j4)(A,{key:0})):(0,f.kq)("",!0),(0,f.Wm)(K,{modelValue:(0,f.SU)(W),"onUpdate:modelValue":U[2]||(U[2]=e=>(0,f.dq)(W)?W.value=e:null),"form-ref":(0,f.SU)(x),title:(0,f.SU)(z),"ok-loading":(0,f.SU)(b),onOk:D},{default:(0,f.w5)(()=>[(0,f.Wm)(R,{ref_key:"formRef",ref:x,model:(0,f.SU)(Z),"auto-label-width":""},{default:(0,f.w5)(()=>[(0,f.Wm)(M,{label:"名称",field:"name","show-colon":"",rules:I},{default:(0,f.w5)(()=>[(0,f.Wm)(L,{modelValue:(0,f.SU)(Z).name,"onUpdate:modelValue":U[1]||(U[1]=e=>(0,f.SU)(Z).name=e),modelModifiers:{trim:!0},"max-length":50,"allow-clear":""},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1},8,["model"])]),_:1},8,["modelValue","form-ref","title","ok-loading"])],64)}}})},8531:function(e,l,a){a.r(l),a.d(l,{default:()=>C});var t=a(34945),o=a(40098);a(86911);var n=a(42763);a(14433);var i=a(32374);a(38427);var d=a(10849),u=a(74953);a(38499);var r=a(36178);a(45264);var s=a(56655),m=a(94140);a(76270);var c=a(65754),p=a(29640),f=a(71342);let v=e=>(0,f.Ko)("/project/page",e,{isProjectId:!1});var w=a(9286),y=a(77504);a(15480);var g=a(71533);a(16617);var h=a(36347);a(53857);var U=a(25185),_=a(46091),k=a(75792);a(45508);var b=a(95557),S=a(86033);a(15745);var W=a(38699);a(87265);var V=a(59643);a(30858);var x=a(5657),Z=a(36186),I=a(23565),H=a(11227),P=a(38551),j=a(82381),z=a(88468),q=a(72090),T=a(94289);let D=(0,c.aZ)({__name:"o-print",props:(0,c.Vf)({isLook:{type:Boolean,default:!1},rowItem:{type:Object,default:()=>({})}},{modelValue:!1,modelModifiers:{}}),emits:(0,c.Vf)("update",["update:modelValue"]),setup(e,l){let{emit:a}=l,t=(0,c.tT)(e,"modelValue",!1),{fileDownload:n}=function(){let e=(0,c.qj)({backgroundcolor:"#fff",quality:1,skipAutoScale:!0});return{fileDownload:async(e,l)=>{await (0,H.saveAs)(e,l),I.Z.success("下载成功")},snapDownload:async(l,a)=>{let t=a.toLowerCase(),o=t.slice(t.lastIndexOf(".")),n=null;switch(o){case".jpg":case".jpeg":n=P.hi;break;case".png":n=P.YM;break;case".svg":n=P.KT;break;default:n=P.SE}try{let t=await n(l,e);await (0,H.saveAs)(t,a),j.Z.success("下载成功")}catch(e){}}}}(),i=(0,c.iH)(!1),u=(0,c.iH)(null),r=(0,c.iH)(null),s=[{label:"Word",value:1,suffix:"docx"},{label:"PDF",value:2,suffix:"pdf"}],p=(0,c.qj)([{label:"参数",value:0},{label:"引导词",value:1},{label:"偏离",value:2},{label:"原因",value:3},{label:"不利后果",value:4},{label:"剧情",value:5},{label:"频率",value:6},{label:"严重性",value:7},{label:"原始风险",value:8},{label:"安全措施",value:9},{label:"现有风险",value:10},{label:"建议措施",value:11},{label:"剩余风险",value:12}]),v=(0,c.iH)([]),w=(0,c.iH)("https://bjoss-pro.oberyun.com/cmaps/"),D=(0,c.iH)(null),C={matrixChartUrl:"",pieChartUrl:"",printType:2,printOptions:[0,1,2,3,4,5,6,7,8,9,10,11,12],projectId:e.rowItem.id},F=(0,c.iH)({...C}),N=(0,c.iH)(""),E=(0,c.iH)(""),A=(0,c.iH)(""),L=(0,c.iH)(""),M={type:"array",required:!0,message:"必选项不能为空",trigger:"change"},R={type:"number",required:!0,message:"必选项不能为空",trigger:"change"},K={height:"100%"},Y={height:"98dvh"},O={height:`calc(${Y.height} - 54px)`},$=(0,c.Fl)(()=>({padding:"0",height:e.isLook?"calc(100% - 48px)":"calc(100% - 113px)",overflow:"hidden","overflow-y":"auto"})),B=(0,c.Fl)(()=>!E.value||!["docx","pdf"].includes(L.value));function G(){i.value=!1}async function X(){try{if(u.value){let e=await u.value.uploadImage();e&&(F.value.matrixChartUrl=e)}if(r.value){let e=await r.value.uploadImage();e&&(F.value.pieChartUrl=e)}}catch(e){}}async function J(){if(D.value)try{let l=await D.value.validate();if(void 0!==l)return;i.value=!0,await X();let o={...F.value,projectId:e.rowItem.id},n=await (0,f.Ko)("/print/print",o,{isProjectId:!1});200===n.code&&(I.Z.success("保存成功"),t.value=!1,a("update"))}finally{i.value=!1}}function Q(){D.value&&D.value.resetFields(),t.value=!1,i.value=!1}function ee(l){let a=async l=>{let a=!1;if("pdf"===l&&["docx","pdf"].includes(L.value)||"xlsx"===l&&"xlsx"===L.value?a=!0:"docx"===l&&"docx"===L.value&&(a=!0),a){let{companyName:a,name:t}=e.rowItem,o=`${a}-${t}_HAZOP\u{5206}\u{6790}\u{62A5}\u{544A}.${l}`,i=L.value===l?A.value:E.value;n(await (0,z.nx)(i,!0),o)}else y.Z.warning({title:"下载失败",content:"当前类型文件未生成，请生成后再下载"})},{label:t,suffix:o}=s[l];y.Z.open({title:"下载提示",content:`\u{60A8}\u{5373}\u{5C06}\u{4E0B}\u{8F7D} \u{201C}${t}\u{201D} \u{7248}\u{5206}\u{6790}\u{62A5}\u{544A}\u{FF0C}\u{662F}\u{5426}\u{4E0B}\u{8F7D}\u{FF1F}`,onOk:()=>a(o)})}function el(){v.value.length>0&&(v.value=[]);let l={projectId:e.rowItem.id};(0,Z.rM)(l).then(e=>{var l;v.value=((null==(l=e.result)?void 0:l.pieData)||[]).map(e=>({...e,itemStyle:{color:e.color}}))})}async function ea(){i.value=!0;try{let l,a=await (l=e.rowItem.id,(0,f.kA)("/filePrintMapping/getLatestDownloadFileUrl",{projectId:l},{isProjectId:!1}));if(200===a.code){let e=a.result||{};N.value=e.previewFilePath?await (0,z.nx)(e.previewFilePath):"",E.value=e.previewFilePath||"",A.value=e.filePath||"",L.value=e.fileType||""}}finally{i.value=!1}}return(0,c.YP)(()=>t.value,l=>{l&&e.isLook&&ea()}),(l,a)=>{let n=m.Z,f=V.Z,Z=W.Z,I=S.Z,H=b.Z,P=k.Z,j=d.Z,z=_.Z,C=U.Z,E=h.ZP,A=g.Z,X=o.Z,ea=y.Z;return(0,c.wg)(),(0,c.j4)(ea,{title:"报告生成设置",width:"1080px",visible:t.value,"modal-style":Y,"body-style":(0,c.SU)($),footer:!e.isLook,closable:e.isLook,"esc-to-close":!1,"mask-closable":!1,"ok-loading":(0,c.SU)(i),onCancel:Q,onOk:J},{title:(0,c.w5)(()=>[e.isLook?((0,c.wg)(),(0,c.j4)(f,{key:0},{default:(0,c.w5)(()=>[(0,c.Wm)(n,{type:"outline",disabled:(0,c.SU)(B),onClick:a[0]||(a[0]=e=>ee(1))},{default:(0,c.w5)(()=>a[4]||(a[4]=[(0,c.Uk)(" Word 下载 ",-1)])),_:1,__:[4]},8,["disabled"]),(0,c.Wm)(n,{type:"outline",disabled:(0,c.SU)(B),status:"danger",onClick:a[1]||(a[1]=e=>ee(2))},{default:(0,c.w5)(()=>a[5]||(a[5]=[(0,c.Uk)(" PDF 下载 ",-1)])),_:1,__:[5]},8,["disabled"])]),_:1})):(0,c.kq)("",!0)]),default:(0,c.w5)(()=>[e.isLook&&t.value?((0,c.wg)(),(0,c.j4)(I,{key:0,style:O,loading:(0,c.SU)(i),tip:"资源加载中"},{default:(0,c.w5)(()=>[(0,c.SU)(N)&&["docx","pdf"].includes((0,c.SU)(L))?((0,c.wg)(),(0,c.iD)("div",{key:0,style:K},[(0,c.Wm)((0,c.SU)(x.Z),{src:(0,c.SU)(N),"c-map-url":(0,c.SU)(w),"disable-stream":"","disable-auto-fetch":"","progress-color":"#165DFF",onOnComplete:G},null,8,["src","c-map-url"])])):((0,c.wg)(),(0,c.j4)(Z,{key:1,description:(0,c.SU)(N)?`\u{5F53}\u{524D}\u{6587}\u{4EF6}\u{683C}\u{5F0F}\u{4E0D}\u{652F}\u{6301}\u{9884}\u{89C8}`:`\u{6587}\u{4EF6}\u{9884}\u{89C8}\u{5730}\u{5740}\u{4E0D}\u{5B58}\u{5728}`},null,8,["description"]))]),_:1},8,["loading"])):(0,c.kq)("",!0),e.isLook?(0,c.kq)("",!0):((0,c.wg)(),(0,c.iD)(c.HY,{key:1},[(0,c.Wm)(X,{ref_key:"formRef",ref:D,model:(0,c.SU)(F)},{default:(0,c.w5)(()=>[(0,c.Wm)(j,{label:"文件类型",field:"printType","show-colon":"",rules:R},{default:(0,c.w5)(()=>[(0,c.Wm)(P,{modelValue:(0,c.SU)(F).printType,"onUpdate:modelValue":a[2]||(a[2]=e=>(0,c.SU)(F).printType=e)},{default:(0,c.w5)(()=>[((0,c.wg)(),(0,c.iD)(c.HY,null,(0,c.Ko)(s,e=>(0,c.Wm)(H,{key:e.value,value:e.value},{default:(0,c.w5)(()=>[(0,c.Uk)((0,c.zw)(e.label),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])]),_:1},8,["rules"]),(0,c.Wm)(j,{label:"文件配置",field:"printOptions","show-colon":"",rules:M},{default:(0,c.w5)(()=>[(0,c.Wm)(A,{modelValue:(0,c.SU)(F).printOptions,"onUpdate:modelValue":a[3]||(a[3]=e=>(0,c.SU)(F).printOptions=e)},{default:(0,c.w5)(()=>[(0,c.Wm)(E,{cols:7,"col-gap":12,"row-gap":0},{default:(0,c.w5)(()=>[((0,c.wg)(!0),(0,c.iD)(c.HY,null,(0,c.Ko)((0,c.SU)(p),e=>((0,c.wg)(),(0,c.j4)(C,{key:e.value},{default:(0,c.w5)(()=>[((0,c.wg)(),(0,c.j4)(z,{key:e.value,value:e.value},{default:(0,c.w5)(()=>[(0,c.Uk)((0,c.zw)(e.label),1)]),_:2},1032,["value"]))]),_:2},1024))),128))]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1},8,["model"]),t.value?((0,c.wg)(),(0,c.iD)(c.HY,{key:0},[(0,c.Wm)(q.Z,{ref_key:"mxRef",ref:u,"is-program":"","project-id":e.rowItem.id,"matrix-id":e.rowItem.matrixId,onUpdate:el},null,8,["project-id","matrix-id"]),(0,c.Wm)(T.Z,{ref_key:"pieRef",ref:r,data:(0,c.SU)(v),"project-id":e.rowItem.id},null,8,["data","project-id"])],64)):(0,c.kq)("",!0)],64))]),_:1},8,["visible","body-style","footer","closable","ok-loading"])}}}),C=(0,c.aZ)({__name:"dashboard",setup(e){let l=(0,w.F)(),a=[{name:"未打印",color:"#165DFF"},{name:"打印中",color:"#FF7D00"},{name:"打印完成",color:"#00B42A"},{name:"打印失败",color:"#F53F3F"}],y=[{align:"center",title:"项目名称",dataIndex:"name"},{align:"center",title:"公司名称",dataIndex:"companyName"},{align:"center",title:"项目负责人",dataIndex:"principal"},{align:"center",title:"分析时间",dataIndex:"parsingTime"},{title:"分析范围",dataIndex:"scope"},{title:"分析类型",dataIndex:"type"},{align:"center",title:"状态",dataIndex:"printState",render:e=>{var l;let{record:t}=e;return null==(l=a[t.printState])?void 0:l.name},bodyCellStyle:e=>{var l;let{printState:t}=e;return{color:null==(l=a[t])?void 0:l.color}}},{align:"center",width:160,title:"报告",slotName:"custom"}],g=(0,c.XI)([]),h=(0,c.qj)({current:1,total:0}),U=(0,c.XI)(!1),_=(0,c.XI)(!1),k=(0,c.XI)(!1),b=(0,c.XI)(),S={id:"",name:"",companyName:"",principal:"",parsingTime:"",remark:"",scope:"",type:"",reportVersion:"",description:""},W=(0,c.iH)({...S}),V=(0,c.XI)(!1),x=(0,c.XI)(!0),Z=(0,c.iH)({}),H={required:!0,message:"必填项不能为空",trigger:"blur"},P=(0,c.Fl)(()=>k.value?"新建项目":"编辑项目");function j(){v({pageNo:1,pageSize:100}).then(e=>{let{records:a}=e.result||{},t=(a||[]).map(e=>({label:e.name,value:e.id,matrixId:e.matrixId}));t.length>0&&l.setItemsList(t)})}async function z(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=arguments.length>1&&void 0!==arguments[1]&&arguments[1];U.value||(U.value=!0);try{let a=e?{...e}:{},t=await v(a);if(g.value.length>0&&g.value.splice(0),200===t.code){let{records:e,total:l,current:a}=t.result||{};h.total=l||0,h.current=a||1,g.value=e||[]}l&&j()}finally{U.value=!1}}function q(e){let{isEdit:l,item:a}=e;if(k.value=!1===l,k.value)W.value={...S},_.value=!0;else{let e;(e=a.id,(0,f.kA)("/project/queryById",{projectId:e},{isProjectId:!1})).then(e=>{W.value=(0,p.Z)(e.result,["id","name","companyName","principal","parsingTime","remark","scope","type","reportVersion","description"]),_.value=!0})}}async function T(e){U.value=!0;let[l]=e;try{await (0,f.P3)("/project/delete",{projectId:l},{isProjectId:!1}),I.Z.success("删除成功"),z({},!0)}finally{U.value=!1}}async function C(){U.value=!0;try{let e,l;k.value?await (e=W.value,(0,f.Ko)("/project/create",e,{isProjectId:!1})):await (l={...W.value,id:W.value.id},(0,f.e8)("/project/edit",l,{isProjectId:!1})),I.Z.success("保存成功"),z({},!0)}finally{U.value=!1,_.value=!1}}async function F(e){let l=!(arguments.length>1)||void 0===arguments[1]||arguments[1];x.value=l,Z.value=e,V.value=!0}function N(){z()}return(0,c.bv)(()=>{z(),j()}),(e,l)=>{let a=m.Z,p=s.Z,f=r.ZP,v=u.ZP,w=d.Z,k=i.ZP,S=n.Z,I=o.Z,j=t.Z;return(0,c.wg)(),(0,c.iD)(c.HY,null,[(0,c.Wm)(f,{class:"page-card",title:"项目管理"},{default:(0,c.w5)(()=>[(0,c.Wm)(p,{loading:(0,c.SU)(U),columns:y,data:(0,c.SU)(g),total:(0,c.SU)(h).total,current:(0,c.SU)(h).current,"is-bulk":!1,"add-text":"新建项目",onQuery:z,onUpdate:q,onDelete:T},{custom:(0,c.w5)(e=>{let{record:t}=e;return[(0,c.Wm)(a,{type:"text",status:"warning",onClick:e=>F(t,!1)},{default:(0,c.w5)(()=>l[11]||(l[11]=[(0,c.Uk)(" 生成 ",-1)])),_:2,__:[11]},1032,["onClick"]),2===t.printState?((0,c.wg)(),(0,c.j4)(a,{key:0,type:"text",status:"success",onClick:e=>F(t)},{default:(0,c.w5)(()=>l[12]||(l[12]=[(0,c.Uk)(" 预览 ",-1)])),_:2,__:[12]},1032,["onClick"])):(0,c.kq)("",!0)]}),_:1},8,["loading","data","total","current"])]),_:1}),(0,c.Wm)(j,{modelValue:(0,c.SU)(_),"onUpdate:modelValue":l[9]||(l[9]=e=>(0,c.dq)(_)?_.value=e:null),"form-ref":(0,c.SU)(b),title:(0,c.SU)(P),"ok-loading":(0,c.SU)(U),onOk:C},{default:(0,c.w5)(()=>[(0,c.Wm)(I,{ref_key:"formRef",ref:b,model:(0,c.SU)(W),"auto-label-width":""},{default:(0,c.w5)(()=>[(0,c.Wm)(w,{label:"项目名称",field:"name","show-colon":"",rules:H},{default:(0,c.w5)(()=>[(0,c.Wm)(v,{modelValue:(0,c.SU)(W).name,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,c.SU)(W).name=e),modelModifiers:{trim:!0},"max-length":50,"allow-clear":""},null,8,["modelValue"])]),_:1},8,["rules"]),(0,c.Wm)(w,{label:"公司名称",field:"companyName","show-colon":"",rules:H},{default:(0,c.w5)(()=>[(0,c.Wm)(v,{modelValue:(0,c.SU)(W).companyName,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,c.SU)(W).companyName=e),modelModifiers:{trim:!0},"max-length":50,"allow-clear":""},null,8,["modelValue"])]),_:1},8,["rules"]),(0,c.Wm)(w,{label:"项目负责人",field:"principal","show-colon":""},{default:(0,c.w5)(()=>[(0,c.Wm)(v,{modelValue:(0,c.SU)(W).principal,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,c.SU)(W).principal=e),modelModifiers:{trim:!0},"max-length":50,"allow-clear":""},null,8,["modelValue"])]),_:1}),(0,c.Wm)(w,{label:"分析时间",field:"parsingTime","show-colon":""},{default:(0,c.w5)(()=>[(0,c.Wm)(k,{modelValue:(0,c.SU)(W).parsingTime,"onUpdate:modelValue":l[3]||(l[3]=e=>(0,c.SU)(W).parsingTime=e),class:"w-100","show-time":"",format:"YYYY-MM-DD HH:mm:ss",placeholder:"请选择分析时间"},null,8,["modelValue"])]),_:1}),(0,c.Wm)(w,{label:"项目概述",field:"remark","show-colon":""},{default:(0,c.w5)(()=>[(0,c.Wm)(v,{modelValue:(0,c.SU)(W).remark,"onUpdate:modelValue":l[4]||(l[4]=e=>(0,c.SU)(W).remark=e),modelModifiers:{trim:!0},"max-length":200,"allow-clear":""},null,8,["modelValue"])]),_:1}),(0,c.Wm)(w,{label:"分析范围",field:"scope","show-colon":""},{default:(0,c.w5)(()=>[(0,c.Wm)(v,{modelValue:(0,c.SU)(W).scope,"onUpdate:modelValue":l[5]||(l[5]=e=>(0,c.SU)(W).scope=e),modelModifiers:{trim:!0},"max-length":50,"allow-clear":""},null,8,["modelValue"])]),_:1}),(0,c.Wm)(w,{label:"分析类型",field:"type","show-colon":""},{default:(0,c.w5)(()=>[(0,c.Wm)(v,{modelValue:(0,c.SU)(W).type,"onUpdate:modelValue":l[6]||(l[6]=e=>(0,c.SU)(W).type=e),modelModifiers:{trim:!0},"max-length":50,"allow-clear":""},null,8,["modelValue"])]),_:1}),(0,c.Wm)(w,{field:"reportVersion",label:"分析报告版本",rules:H,"show-colon":""},{default:(0,c.w5)(()=>[(0,c.Wm)(v,{modelValue:(0,c.SU)(W).reportVersion,"onUpdate:modelValue":l[7]||(l[7]=e=>(0,c.SU)(W).reportVersion=e),modelModifiers:{trim:!0},placeholder:"请输入分析报告版本","max-length":50,"allow-clear":""},null,8,["modelValue"])]),_:1},8,["rules"]),(0,c.Wm)(w,{field:"description",label:"工作描述","show-colon":""},{default:(0,c.w5)(()=>[(0,c.Wm)(S,{modelValue:(0,c.SU)(W).description,"onUpdate:modelValue":l[8]||(l[8]=e=>(0,c.SU)(W).description=e),placeholder:"请输入工作描述","max-length":200,"allow-clear":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","form-ref","title","ok-loading"]),(0,c.Wm)(D,{modelValue:(0,c.SU)(V),"onUpdate:modelValue":l[10]||(l[10]=e=>(0,c.dq)(V)?V.value=e:null),"is-look":(0,c.SU)(x),"row-item":(0,c.SU)(Z),onUpdate:N},null,8,["modelValue","is-look","row-item"])],64)}}})},76979:function(e,l,a){a.r(l),a.d(l,{default:()=>v});var t=a(36178);a(45264);var o=a(40098);a(86911);var n=a(59643);a(30858);var i=a(94140);a(76270);var d=a(42763);a(14433);var u=a(10849),r=a(74953);a(38499);var s=a(65754),m=a(10475),c=a(98760),p=a(9286),f=a(23565);let v=(0,s.aZ)({__name:"abstract",setup(e){let l=(0,p.F)().itemsType,a=(0,s.iH)(),v=(0,s.iH)("vertical"),w=(0,s.iH)(!1),y=(0,s.iH)(!1),g=(0,s.qj)({reportVersion:"",description:"",scope:"",remark:""}),h={reportVersion:[{required:!0,message:"请输入分析报告版本",trigger:"blur"}]},U=(0,s.qj)({span:5,offset:0}),_=(0,s.qj)({span:19,offset:0}),k=(0,s.qj)([]),b=(0,s.qj)([]);async function S(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],l=!(arguments.length>1)||void 0===arguments[1]||arguments[1],a=async()=>{k.splice(0);try{let e=await (0,m.he)();if(200===e.code){let l=e.result||{},a={required:!1,align:"center",title:"",dataIndex:""},t=[];for(let e in l)if(Object.prototype.hasOwnProperty.call(l,e)){let o=l[e],n=Object.assign({},a,{required:"0"===e,dataIndex:e,title:o});t.push(n)}k.push(...t)}}finally{y.value=!1}},t=async()=>{b.splice(0);try{let e=await (0,m.OK)();if(200===e.code){let l=e.result||[];b.push(...l)}}finally{y.value=!1}};y.value||(y.value=!0);try{e&&await a(),l&&await t()}finally{y.value=!1}}async function W(){y.value||(y.value=!0);try{let e=await (0,m.Ns)();if(200===e.code){let{reportVersion:l,description:a,scope:t,remark:o}=e.result||{};Object.assign(g,{reportVersion:l,description:a,scope:t,remark:o})}await S()}catch(e){y.value=!1}}function V(e){w.value=e,e||a.value.clearValidate()}async function x(e){y.value=!0;try{let a={...e,projectId:l},t=await (0,m.Wn)(a);200===t.code&&(w.value=!1,f.Z.success("保存成功"),W())}catch(e){y.value=!1}}async function Z(e){let{isColumn:l,isData:a}=e;await S(l,a)}async function I(e){y.value=!0;try{let l=await (0,m.iT)(e.rowId);200===l.code&&(f.Z.success("删除成功"),await S(!1,!0))}catch(e){y.value=!1}}return(0,s.bv)(()=>{W()}),(e,l)=>{let m=r.ZP,p=u.Z,f=d.Z,S=i.Z,W=n.Z,H=o.Z,P=t.ZP;return(0,s.wg)(),(0,s.j4)(P,{class:"page-card",title:"摘要-录入项目基本信息"},{default:(0,s.w5)(()=>[(0,s.Wm)(H,{ref_key:"formRef",ref:a,model:(0,s.SU)(g),rules:h,layout:(0,s.SU)(v),disabled:!(0,s.SU)(w),"label-col-props":(0,s.SU)(U),"wrapper-col-props":(0,s.SU)(_),onSubmitSuccess:x},{default:(0,s.w5)(()=>[(0,s.Wm)(p,{field:"reportVersion",label:"分析报告版本",required:"","show-colon":""},{default:(0,s.w5)(()=>[(0,s.Wm)(m,{modelValue:(0,s.SU)(g).reportVersion,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,s.SU)(g).reportVersion=e),modelModifiers:{trim:!0},placeholder:"请输入分析报告版本","max-length":50,"allow-clear":""},null,8,["modelValue"])]),_:1}),(0,s.Wm)(p,{field:"description",label:"工作描述","show-colon":""},{default:(0,s.w5)(()=>[(0,s.Wm)(f,{modelValue:(0,s.SU)(g).description,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,s.SU)(g).description=e),placeholder:"请输入工作描述","max-length":200,"allow-clear":""},null,8,["modelValue"])]),_:1}),(0,s.Wm)(p,{field:"scope",label:"分析范围","show-colon":""},{default:(0,s.w5)(()=>[(0,s.Wm)(f,{modelValue:(0,s.SU)(g).scope,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,s.SU)(g).scope=e),placeholder:"请输入分析范围","max-length":200,"allow-clear":""},null,8,["modelValue"])]),_:1}),(0,s.Wm)(p,{label:"危险化学品的特性","show-colon":""},{default:(0,s.w5)(()=>[(0,s.Wm)(c.Z,{columns:(0,s.SU)(k),data:(0,s.SU)(b),height:"300",type:"abstract",onUpdate:Z,onDelete:I},null,8,["columns","data"])]),_:1}),(0,s.Wm)(p,{field:"remark",label:"备注","show-colon":""},{default:(0,s.w5)(()=>[(0,s.Wm)(f,{modelValue:(0,s.SU)(g).remark,"onUpdate:modelValue":l[3]||(l[3]=e=>(0,s.SU)(g).remark=e),placeholder:"请输入备注","max-length":200,"allow-clear":""},null,8,["modelValue"])]),_:1}),(0,s.SU)(w)?((0,s.wg)(),(0,s.j4)(W,{key:0},{default:(0,s.w5)(()=>[(0,s.Wm)(S,{type:"primary","html-type":"submit",loading:(0,s.SU)(y)},{default:(0,s.w5)(()=>l[6]||(l[6]=[(0,s.Uk)(" 保存 ",-1)])),_:1,__:[6]},8,["loading"]),(0,s.Wm)(S,{type:"outline",disabled:(0,s.SU)(y),onClick:l[4]||(l[4]=e=>V(!1))},{default:(0,s.w5)(()=>l[7]||(l[7]=[(0,s.Uk)(" 取消 ",-1)])),_:1,__:[7]},8,["disabled"])]),_:1})):((0,s.wg)(),(0,s.j4)(W,{key:1},{default:(0,s.w5)(()=>[(0,s.Wm)(S,{type:"primary",disabled:(0,s.SU)(w),onClick:l[5]||(l[5]=e=>V(!0))},{default:(0,s.w5)(()=>l[8]||(l[8]=[(0,s.Uk)(" 编辑信息 ",-1)])),_:1,__:[8]},8,["disabled"])]),_:1}))]),_:1},8,["model","layout","disabled","label-col-props","wrapper-col-props"])]),_:1})}}})},79698:function(e,l,a){a.r(l),a.d(l,{default:()=>f});var t=a(36178);a(45264);var o=a(86033);a(15745);var n=a(8176);a(86166);var i=a(31730),d=a(57501);a(88372);var u=a(59643);a(30858);var r=a(94140);a(76270);var s=a(65754),m=a(71342),c=a(9286),p=a(23565);let f=(0,s.aZ)({__name:"deviate",setup(e){let l=(0,c.F)().itemsType,a=(0,s.iH)(!1),f=(0,s.iH)(!1),v=(0,s.qj)({cell:!0}),w=(0,s.XI)([]),y=(0,s.iH)([]);async function g(){a.value=!0;try{w.value.length>0&&w.value.splice(0);let e=await (0,m.kA)("/deviation/tableColumns");if(200===e.code){let{columns:l=[]}=e.result;w.value=l.map(e=>({align:"center",title:e.title,dataIndex:String(e.dataIndex),i:e.dataIndex-1}))}y.value.length>0&&y.value.splice(0);let l=await (0,m.kA)("/deviation/tableRows");200===l.code&&(y.value=l.result||[])}finally{a.value=!1}}async function h(){a.value=!0;try{let e={projectId:l,rows:[...y.value]},a=await (0,m.Ko)("/deviation/editTable",e);200===a.code&&(p.Z.success("保存成功"),U())}catch(e){a.value=!1}}function U(){f.value=!1,g()}function _(){f.value=!0}return(0,s.bv)(()=>{g()}),(e,l)=>{let m=r.Z,c=u.Z,p=d.Z,k=i.Z,b=n.ZP,S=o.Z,W=t.ZP;return(0,s.wg)(),(0,s.j4)(W,{class:"page-card",title:"偏离-筛选有效偏离"},{default:(0,s.w5)(()=>[(0,s.Wm)(c,{direction:"vertical"},{default:(0,s.w5)(()=>[(0,s.SU)(f)?((0,s.wg)(),(0,s.j4)(c,{key:0},{default:(0,s.w5)(()=>[(0,s.Wm)(m,{type:"primary",onClick:h},{default:(0,s.w5)(()=>l[0]||(l[0]=[(0,s.Uk)(" 保存数据 ",-1)])),_:1,__:[0]}),(0,s.Wm)(m,{type:"primary",status:"danger",onClick:U},{default:(0,s.w5)(()=>l[1]||(l[1]=[(0,s.Uk)(" 取消编辑 ",-1)])),_:1,__:[1]})]),_:1})):((0,s.wg)(),(0,s.j4)(c,{key:1},{default:(0,s.w5)(()=>[(0,s.Wm)(m,{type:"primary",onClick:_},{default:(0,s.w5)(()=>l[2]||(l[2]=[(0,s.Uk)(" 编辑数据 ",-1)])),_:1,__:[2]}),(0,s.Wm)(m,{type:"primary",onClick:g},{default:(0,s.w5)(()=>l[3]||(l[3]=[(0,s.Uk)(" 刷新 ",-1)])),_:1,__:[3]})]),_:1})),(0,s.Wm)(S,{loading:(0,s.SU)(a),tip:"数据加载中"},{default:(0,s.w5)(()=>[(0,s.Wm)(b,{data:(0,s.SU)(y),"table-layout-fixed":"",pagination:!1,bordered:(0,s.SU)(v)},{columns:(0,s.w5)(()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)((0,s.SU)(w),e=>((0,s.wg)(),(0,s.j4)(k,{key:e.dataIndex,title:e.title,"data-index":e.dataIndex,align:e.align},{cell:(0,s.w5)(l=>{let{record:a,column:t}=l;return[[0,"0"].includes(t.dataIndex)?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s.Uk)((0,s.zw)(a.rowName),1)],64)):((0,s.wg)(),(0,s.j4)(p,{key:1,modelValue:a.rowValues[e.i],"onUpdate:modelValue":l=>a.rowValues[e.i]=l,size:"small","checked-value":1,"unchecked-value":0,disabled:!(0,s.SU)(f)},null,8,["modelValue","onUpdate:modelValue","disabled"]))]}),_:2},1032,["title","data-index","align"]))),128))]),_:1},8,["data","bordered"])]),_:1},8,["loading"])]),_:1})]),_:1})}}})},2330:function(e,l,a){a.r(l),a.d(l,{default:()=>U});var t=a(34945),o=a(40098);a(86911);var n=a(42763);a(14433);var i=a(32110);a(67328);var d=a(10849),u=a(74953);a(38499);var r=a(36178);a(45264);var s=a(56655),m=a(94140);a(76270);var c=a(65754),p=a(29640),f=a(35214),v=a(77504);a(15480);var w=a(38895);a(1731);let y=(0,c.aZ)({name:"FileUploader",__name:"file-uploader",props:{title:{default:"文件上传"},accepts:{},modalProps:{}},setup(e){let l=(0,c.iH)(!1);function a(){l.value=!0}return(t,o)=>{let n=w.Z,i=v.Z;return(0,c.wg)(),(0,c.iD)(c.HY,null,[(0,c._)("div",{onClick:a},[(0,c.WI)(t.$slots,"default")]),(0,c.Wm)(i,(0,c.dG)({visible:(0,c.SU)(l),"onUpdate:visible":o[0]||(o[0]=e=>(0,c.dq)(l)?l.value=e:null),title:e.title},e.modalProps),{default:(0,c.w5)(()=>[(0,c.Wm)(n,{draggable:"",action:"/"})]),_:1},16,["visible","title"])],64)}}});var g=a(9286),h=a(23565);let U=(0,c.aZ)({__name:"device",setup(e){let l=(0,g.F)(),a=(0,c.XI)(!1),v=(0,c.XI)(!1),w=(0,c.XI)(!1),U=(0,c.XI)(),_={id:"",name:"",remark:"",position:"",model:"",designParameter:"",keyMaterial:"",safetyAttachment:"",quantity:0,projectId:""},k=(0,c.iH)({..._}),b=[{align:"center",title:"设备名称",dataIndex:"name"},{align:"center",title:"设备位号",dataIndex:"position"},{align:"center",title:"规格型号",dataIndex:"model"},{align:"center",title:"设计参数",dataIndex:"designParameter"},{align:"center",title:"关键材质",dataIndex:"keyMaterial"},{align:"center",title:"安全附件",dataIndex:"safetyAttachment"},{align:"center",title:"数量",dataIndex:"quantity"},{align:"center",title:"备注",dataIndex:"remark"}],S=(0,c.XI)([]),W=(0,c.qj)({current:1,total:0}),V={required:!0,message:"必填项不能为空",trigger:"blur"},x=(0,c.Fl)(()=>w.value?"新建设备":"编辑设备");async function Z(e){a.value||(a.value=!0);try{let a={...e,projectId:l.itemsType},t=await (0,f.sk)(a);if(S.value.length>0&&S.value.splice(0),200===t.code){let{records:e=[],total:l=0,current:a=1}=t.result||{};W.total=l,W.current=a,S.value=e}}finally{a.value=!1}}function I(e){let{isEdit:a,item:t}=e;w.value=!1===a,w.value?(k.value={..._,projectId:l.itemsType},v.value=!0):(0,f.Tz)(t.id).then(e=>{k.value={...(0,p.Z)(e.result,["id","name","remark","position","model","designParameter","keyMaterial","safetyAttachment","quantity"]),projectId:l.itemsType},v.value=!0})}async function H(e){a.value=!0;try{let l=await (0,f.AP)(e);200===l.code&&(h.Z.success("删除成功"),await Z({}))}catch(e){a.value=!1}}async function P(){a.value=!0;let e={...k.value};try{let l=w.value?await (0,f.P2)(e):await (0,f.cI)(e);200===l.code&&(v.value=!1,h.Z.success("保存成功"),await Z({}))}catch(e){a.value=!1}}return Z({}),(e,l)=>{let p=m.Z,f=s.Z,w=r.ZP,g=u.ZP,h=d.Z,_=i.Z,j=n.Z,z=o.Z,q=t.Z;return(0,c.wg)(),(0,c.iD)(c.HY,null,[(0,c.Wm)(w,{class:"page-card",title:"设备一览"},{default:(0,c.w5)(()=>[(0,c.Wm)(f,{loading:(0,c.SU)(a),columns:b,data:(0,c.SU)(S),total:(0,c.SU)(W).total,current:(0,c.SU)(W).current,"add-text":"新建设备",onQuery:Z,onUpdate:I,onDelete:H},{button:(0,c.w5)(()=>[(0,c.Wm)(y,null,{default:(0,c.w5)(()=>[(0,c.Wm)(p,{type:"primary"},{default:(0,c.w5)(()=>l[9]||(l[9]=[(0,c.Uk)(" 导入设备 ",-1)])),_:1,__:[9]})]),_:1})]),_:1},8,["loading","data","total","current"])]),_:1}),(0,c.Wm)(q,{modelValue:(0,c.SU)(v),"onUpdate:modelValue":l[8]||(l[8]=e=>(0,c.dq)(v)?v.value=e:null),"form-ref":(0,c.SU)(U),title:(0,c.SU)(x),"ok-loading":(0,c.SU)(a),onOk:P},{default:(0,c.w5)(()=>[(0,c.Wm)(z,{ref_key:"formRef",ref:U,model:(0,c.SU)(k),"auto-label-width":""},{default:(0,c.w5)(()=>[(0,c.Wm)(h,{label:"设备类型",field:"name","show-colon":"",rules:V},{default:(0,c.w5)(()=>[(0,c.Wm)(g,{modelValue:(0,c.SU)(k).name,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,c.SU)(k).name=e),modelModifiers:{trim:!0},"max-length":50,"allow-clear":""},null,8,["modelValue"])]),_:1},8,["rules"]),(0,c.Wm)(h,{label:"设备位号",field:"position","show-colon":"",rules:V},{default:(0,c.w5)(()=>[(0,c.Wm)(g,{modelValue:(0,c.SU)(k).position,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,c.SU)(k).position=e),modelModifiers:{trim:!0},"max-length":100,"allow-clear":""},null,8,["modelValue"])]),_:1},8,["rules"]),(0,c.Wm)(h,{label:"规格型号",field:"model","show-colon":""},{default:(0,c.w5)(()=>[(0,c.Wm)(g,{modelValue:(0,c.SU)(k).model,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,c.SU)(k).model=e),modelModifiers:{trim:!0},"max-length":100,"allow-clear":""},null,8,["modelValue"])]),_:1}),(0,c.Wm)(h,{label:"设计参数",field:"designParameter","show-colon":""},{default:(0,c.w5)(()=>[(0,c.Wm)(g,{modelValue:(0,c.SU)(k).designParameter,"onUpdate:modelValue":l[3]||(l[3]=e=>(0,c.SU)(k).designParameter=e),modelModifiers:{trim:!0},"max-length":100,"allow-clear":""},null,8,["modelValue"])]),_:1}),(0,c.Wm)(h,{label:"关键材质",field:"keyMaterial","show-colon":""},{default:(0,c.w5)(()=>[(0,c.Wm)(g,{modelValue:(0,c.SU)(k).keyMaterial,"onUpdate:modelValue":l[4]||(l[4]=e=>(0,c.SU)(k).keyMaterial=e),modelModifiers:{trim:!0},"max-length":100,"allow-clear":""},null,8,["modelValue"])]),_:1}),(0,c.Wm)(h,{label:"安全附件",field:"safetyAttachment","show-colon":""},{default:(0,c.w5)(()=>[(0,c.Wm)(g,{modelValue:(0,c.SU)(k).safetyAttachment,"onUpdate:modelValue":l[5]||(l[5]=e=>(0,c.SU)(k).safetyAttachment=e),modelModifiers:{trim:!0},"max-length":100,"allow-clear":""},null,8,["modelValue"])]),_:1}),(0,c.Wm)(h,{label:"数量",field:"quantity","show-colon":""},{default:(0,c.w5)(()=>[(0,c.Wm)(_,{modelValue:(0,c.SU)(k).quantity,"onUpdate:modelValue":l[6]||(l[6]=e=>(0,c.SU)(k).quantity=e),modelModifiers:{trim:!0},"allow-clear":""},null,8,["modelValue"])]),_:1}),(0,c.Wm)(h,{label:"备注",field:"remark","show-colon":""},{default:(0,c.w5)(()=>[(0,c.Wm)(j,{modelValue:(0,c.SU)(k).remark,"onUpdate:modelValue":l[7]||(l[7]=e=>(0,c.SU)(k).remark=e),modelModifiers:{trim:!0},"max-length":50,"allow-clear":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","form-ref","title","ok-loading"])],64)}}})},92640:function(e,l,a){a.r(l),a.d(l,{default:()=>H});var t=a(72024),o=a(86033);a(15745);var n=a(59643);a(30858);var i=a(32110);a(67328);var d=a(36178);a(45264);var u=a(56655),r=a(38895);a(1731);var s=a(94140);a(76270);var m=a(65754),c=a(71342),p=a(7061),f=a(9286),v=a(77504);a(15480);var w=a(40098);a(86911);var y=a(10849),g=a(74953);a(38499);var h=a(49746),U=a(53498);a(69650);var _=a(17305);a(86314);let k=(0,m.aZ)({__name:"flow-canvas",props:{isLook:{type:Boolean,default:!0}},setup(e){let l={width:"144px"},a=(0,m.iH)(null),t=(0,m.iH)(null),o=(0,m.qj)({width:0,height:0}),i=(0,m.iH)(null),d=(0,m.iH)(null),u=(0,m.iH)("#f00"),r=(0,m.iH)(2),c=(0,m.iH)("line"),p=(0,m.iH)(null),f=(0,m.Fl)(()=>"select"===c.value),k=(0,m.qj)({x:0,y:0}),b=(0,m.qj)([]),S=(0,m.qj)({type:"line",points:[],stroke:u.value,strokeWidth:r.value,lineCap:"round",lineJoin:"round"}),W=(0,m.qj)({x:0,y:0,width:0,height:0,startX:0,startY:0}),V=(0,m.iH)(!1),x=(0,m.iH)(""),Z=(0,m.qj)({x:0,y:0}),I=(0,m.qj)([]),H=(0,m.qj)([]),P=(0,m.iH)(-1),j=(0,m.Fl)(()=>e=>c.value===e);function z(){I.splice(P.value+1),I.push(JSON.stringify(b)),P.value++,H.length=0}(0,m.YP)([u,r],e=>{let[l,a]=e;S.stroke=l,S.strokeWidth=a});let q=()=>`shape_${Date.now()}_${Math.floor(1e3*Math.random())}`;function T(e){c.value=e,"eraser"!==e&&(k.x=0,k.y=0),"select"!==e&&(p.value=null),W.width=0,W.height=0}let D=(0,m.Fl)(()=>"eraser"===c.value),C=(0,m.Fl)(()=>5*r.value);function F(e){if(!f.value)return;e.cancelBubble=!0;let l=e.target.attrs.id;if("Delete"===e.evt.key&&p.value){let e=b.findIndex(e=>e.id===p.value);if(-1!==e){var a;b.splice(e,1),p.value=null,null==(a=i.value)||a.batchDraw(),z()}return}p.value=l,(0,m.Y3)(()=>{var e;let a=null==(e=d.value)?void 0:e.getStage();if(!a)return;let o=t.value.getStage().findOne(`#${l}`);o&&(a.nodes([]),a.nodes([o]),a.getLayer().batchDraw())})}function N(e){if(!f.value)return;let l=e.target.attrs.id,a=b.findIndex(e=>e.id===l);-1!==a&&(b[a].x=e.target.x(),b[a].y=e.target.y(),z())}function E(e){f.value||(p.value=null);let l=e.target.getStage().getPointerPosition();D.value?O(l):"line"===c.value?(S.points=[l.x,l.y],S.type="line",S.id=q(),b.push({...S})):"rect"===c.value?(W.x=l.x,W.y=l.y,W.startX=l.x,W.startY=l.y,W.width=0,W.height=0,b.push({type:"rect",id:q(),x:l.x,y:l.y,width:0,height:0,stroke:u.value,strokeWidth:r.value})):"text"===c.value?(Z.x=l.x,Z.y=l.y,V.value=!0,p.value=null):f.value&&e.target===e.target.getStage()&&(p.value=null,d.value&&(d.value.getStage().nodes([]),d.value.getLayer().batchDraw()))}function A(e){var l,a;let t=e.target.getStage().getPointerPosition();if(D.value)k.x=t.x,k.y=t.y,1===e.evt.buttons&&O(t);else if("line"===c.value&&S.points.length){if(S.points=[...S.points,t.x,t.y],b.length){let e=b.length-1;"line"===b[e].type&&(b[e]={...S})}}else if("rect"===c.value&&1===e.evt.buttons){let e=t.x-W.startX,l=t.y-W.startY,a=b.length-1;a>=0&&"rect"===b[a].type&&(e<0?(b[a].x=t.x,b[a].width=Math.abs(e)):b[a].width=e,l<0?(b[a].y=t.y,b[a].height=Math.abs(l)):b[a].height=l),W.x=e<0?t.x:W.startX,W.y=l<0?t.y:W.startY,W.width=Math.abs(e),W.height=Math.abs(l)}null==(a=i.value)||null==(l=a.batchDraw)||l.call(a)}function L(){if(D.value)z();else if("line"===c.value&&S.points.length)S.points=[],z();else if("rect"===c.value){let e=b.find(e=>"rect"===e.type&&0===e.width&&0===e.height);if(e){let l=b.findIndex(l=>l===e);-1!==l&&b.splice(l,1)}else(W.width>0||W.height>0)&&z();W.width=0,W.height=0}}function M(e){if("Delete"===e.key&&p.value){let e=b.findIndex(e=>e.id===p.value);if(-1!==e){var l;b.splice(e,1),p.value=null,null==(l=i.value)||l.batchDraw(),z()}}}function R(e,l){let a=b.findIndex(e=>e.id===l);-1!==a&&(b[a].x=e.target.x(),b[a].y=e.target.y(),z())}function K(l){if(e.isLook)return;let a=b.find(e=>e.id===l);a&&(x.value=a.text,V.value=!0,p.value=l)}function Y(){if(x.value.trim()){if(p.value){let e=b.find(e=>e.id===p.value);e&&(e.text=x.value)}else{var e,l,a,t,o;e=Z.x,l=Z.y,a=x.value,t=u.value,o=8*r.value,b.push({type:"text",id:q(),x:e,y:l,text:a,stroke:t,fontSize:o,width:100,height:32})}z()}x.value="",V.value=!1,p.value=null}function O(e){let l=!1,a=C.value;for(let t=b.length-1;t>=0;t--){let o=b[t];if("line"===o.type){let n=o.points;for(let o=0;o<n.length-1;o+=2){let i=n[o],d=n[o+1];if(Math.sqrt((i-e.x)**2+(d-e.y)**2)<=a){b.splice(t,1),l=!0;break}}}else if("rect"===o.type){let n=e.x>=o.x-a&&e.x<=o.x+o.width+a,i=e.y>=o.y-a&&e.y<=o.y+o.height+a,d=Math.abs(e.x-o.x)<=a,u=Math.abs(e.x-(o.x+o.width))<=a,r=Math.abs(e.y-o.y)<=a,s=Math.abs(e.y-(o.y+o.height))<=a;(n&&(r||s)||i&&(d||u))&&(b.splice(t,1),l=!0)}else"text"===o.type&&Math.sqrt((o.x-e.x)**2+(o.y-e.y)**2)<=2*a&&(b.splice(t,1),l=!0)}if(l){var t,o;null==(o=i.value)||null==(t=o.batchDraw)||t.call(o)}}function $(){if(P.value>0){var e,l;H.push(JSON.stringify(b)),P.value--,b.length=0,JSON.parse(I[P.value]).forEach(e=>b.push({...e})),null==(l=i.value)||null==(e=l.batchDraw)||e.call(l)}}function B(){if(H.length>0){var e,l;P.value++,b.length=0,JSON.parse(H.pop()).forEach(e=>b.push({...e})),null==(l=i.value)||null==(e=l.batchDraw)||e.call(l)}}function G(){var e,l;b.length=0,null==(l=i.value)||null==(e=l.batchDraw)||e.call(l),z()}function X(){let e=JSON.stringify(b);localStorage.setItem("logs",e)}let J=(0,m.qj)({text:x});return(0,m.YP)(x,e=>{J.text=e}),(0,m.YP)(()=>J.text,e=>{x.value=e}),(0,m.bv)(function(){let l=a.value;if(o.width=l.offsetWidth,o.height=l.offsetHeight,!e.isLook){let e=t.value.getStage();e.on("mousedown",E),e.on("mousemove",A),e.on("mouseup",L),e.on("mouseleave",L),e.on("mouseover",e=>{if(D.value){let t=e.target.getStage().getPointerPosition();if(t){var l,a;k.x=t.x,k.y=t.y,null==(a=i.value)||null==(l=a.batchDraw)||l.call(a)}}}),window.addEventListener("keydown",M)}let n=localStorage.getItem("logs");if(n)try{var d,u;let e=JSON.parse(n);b.length=0,e.forEach(e=>b.push({...e})),z(),null==(u=i.value)||null==(d=u.batchDraw)||d.call(u)}catch(e){}}),(0,m.SK)(()=>{window.removeEventListener("keydown",M)}),(c,f)=>{let S=_.Z,Z=U.Z,I=s.Z,H=h.Z,P=n.Z,z=(0,m.up)("v-line"),q=(0,m.up)("v-rect"),E=(0,m.up)("v-text"),A=(0,m.up)("v-transformer"),L=(0,m.up)("v-circle"),M=(0,m.up)("v-layer"),O=(0,m.up)("v-stage"),Q=g.ZP,ee=y.Z,el=w.Z,ea=v.Z;return(0,m.wg)(),(0,m.iD)("div",{ref_key:"csvRef",ref:a,class:"csv-wrap"},[e.isLook?(0,m.kq)("",!0):((0,m.wg)(),(0,m.j4)(P,{key:0,class:"csv-tool"},{default:(0,m.w5)(()=>[(0,m.Wm)(S,{modelValue:(0,m.SU)(u),"onUpdate:modelValue":f[0]||(f[0]=e=>(0,m.dq)(u)?u.value=e:null),"disabled-alpha":"",format:"hex"},null,8,["modelValue"]),(0,m.Wm)(Z,{modelValue:(0,m.SU)(r),"onUpdate:modelValue":f[1]||(f[1]=e=>(0,m.dq)(r)?r.value=e:null),min:1,max:20,"show-input":"","show-ticks":"",style:l},null,8,["modelValue"]),(0,m.Wm)(H,{type:"primary"},{default:(0,m.w5)(()=>[(0,m.Wm)(I,{disabled:(0,m.SU)(j)("line"),onClick:f[2]||(f[2]=e=>T("line"))},{default:(0,m.w5)(()=>f[10]||(f[10]=[(0,m.Uk)(" 画笔 ",-1)])),_:1,__:[10]},8,["disabled"]),(0,m.Wm)(I,{disabled:(0,m.SU)(j)("rect"),onClick:f[3]||(f[3]=e=>T("rect"))},{default:(0,m.w5)(()=>f[11]||(f[11]=[(0,m.Uk)(" 矩形 ",-1)])),_:1,__:[11]},8,["disabled"]),(0,m.Wm)(I,{disabled:(0,m.SU)(j)("text"),onClick:f[4]||(f[4]=e=>T("text"))},{default:(0,m.w5)(()=>f[12]||(f[12]=[(0,m.Uk)(" 文本 ",-1)])),_:1,__:[12]},8,["disabled"]),(0,m.Wm)(I,{disabled:(0,m.SU)(j)("select"),onClick:f[5]||(f[5]=e=>T("select"))},{default:(0,m.w5)(()=>f[13]||(f[13]=[(0,m.Uk)(" 选择 ",-1)])),_:1,__:[13]},8,["disabled"]),(0,m.Wm)(I,{disabled:(0,m.SU)(j)("eraser"),onClick:f[6]||(f[6]=e=>T("eraser"))},{default:(0,m.w5)(()=>f[14]||(f[14]=[(0,m.Uk)(" 橡皮擦 ",-1)])),_:1,__:[14]},8,["disabled"])]),_:1}),(0,m.Wm)(H,{type:"primary"},{default:(0,m.w5)(()=>[(0,m.Wm)(I,{status:"warning",onClick:$},{default:(0,m.w5)(()=>f[15]||(f[15]=[(0,m.Uk)(" 撤销 ",-1)])),_:1,__:[15]}),(0,m.Wm)(I,{status:"warning",onClick:B},{default:(0,m.w5)(()=>f[16]||(f[16]=[(0,m.Uk)(" 重做 ",-1)])),_:1,__:[16]})]),_:1}),(0,m.Wm)(I,{type:"primary",status:"danger",onClick:G},{default:(0,m.w5)(()=>f[17]||(f[17]=[(0,m.Uk)(" 清空 ",-1)])),_:1,__:[17]}),(0,m.Wm)(I,{type:"primary",onClick:X},{default:(0,m.w5)(()=>f[18]||(f[18]=[(0,m.Uk)(" 保存 ",-1)])),_:1,__:[18]})]),_:1})),(0,m.Wm)(O,{ref_key:"stageRef",ref:t,config:(0,m.SU)(o),"hit-stroke-width":0},{default:(0,m.w5)(()=>[(0,m.Wm)(M,{ref_key:"layerRef",ref:i},{default:(0,m.w5)(()=>[((0,m.wg)(!0),(0,m.iD)(m.HY,null,(0,m.Ko)((0,m.SU)(b).filter(e=>"line"===e.type),(e,l)=>((0,m.wg)(),(0,m.j4)(z,{key:`line-${l}`,points:e.points,stroke:e.stroke,"stroke-width":e.strokeWidth,tension:.5,"line-cap":e.lineCap,"line-join":e.lineJoin},null,8,["points","stroke","stroke-width","line-cap","line-join"]))),128)),((0,m.wg)(!0),(0,m.iD)(m.HY,null,(0,m.Ko)((0,m.SU)(b).filter(e=>"rect"===e.type),(l,a)=>((0,m.wg)(),(0,m.j4)(q,{key:`rect-${a}`,config:{x:l.x,y:l.y,width:l.width,height:l.height,stroke:l.stroke,strokeWidth:l.strokeWidth,draggable:!e.isLook,id:l.id||`rect-${a}`},onDragend:N,onClick:F},null,8,["config"]))),128)),((0,m.wg)(!0),(0,m.iD)(m.HY,null,(0,m.Ko)((0,m.SU)(b).filter(e=>"text"===e.type),(l,a)=>((0,m.wg)(),(0,m.iD)(m.HY,{key:`text-wrap-${a}`},[(0,m.Wm)(q,{config:{x:l.x-4,y:l.y-4,width:l.width||100,height:l.height||32,stroke:"#1890ff",strokeWidth:1,dash:[4,2],draggable:!e.isLook,id:`${l.id}-border`},onDragend:e=>R(e,l.id),onDblclick:()=>K(l.id)},null,8,["config","onDragend","onDblclick"]),(0,m.Wm)(E,{config:{x:l.x,y:l.y,text:l.text,fontSize:l.fontSize||16,fill:l.stroke,draggable:!e.isLook,id:l.id},onDragend:e=>R(e,l.id),onDblclick:()=>K(l.id)},null,8,["config","onDragend","onDblclick"])],64))),128)),(0,m.SU)(W).width>0?((0,m.wg)(),(0,m.j4)(q,{key:0,config:{x:(0,m.SU)(W).x,y:(0,m.SU)(W).y,width:(0,m.SU)(W).width,height:(0,m.SU)(W).height,stroke:(0,m.SU)(u).value,strokeWidth:(0,m.SU)(r).value}},null,8,["config"])):(0,m.kq)("",!0),(0,m.SU)(p)?((0,m.wg)(),(0,m.j4)(A,{key:1,ref_key:"transformerRef",ref:d,config:{borderDash:[3,3],borderStroke:"#00F",anchorStroke:"#00F",anchorFill:"#FFF",anchorSize:8}},null,512)):(0,m.kq)("",!0),(0,m.SU)(D)&&0!==(0,m.SU)(k).x?((0,m.wg)(),(0,m.j4)(L,{key:2,config:{x:(0,m.SU)(k).x,y:(0,m.SU)(k).y,radius:(0,m.SU)(C),stroke:"#000",strokeWidth:1,dash:[5,5]}},null,8,["config"])):(0,m.kq)("",!0)]),_:1},512)]),_:1},8,["config"]),(0,m.Wm)(ea,{visible:(0,m.SU)(V),"onUpdate:visible":f[8]||(f[8]=e=>(0,m.dq)(V)?V.value=e:null),title:"编辑文本",onOk:Y,onCancel:f[9]||(f[9]=e=>x.value="")},{default:(0,m.w5)(()=>[(0,m.Wm)(el,{layout:"vertical",model:(0,m.SU)(J)},{default:(0,m.w5)(()=>[(0,m.Wm)(ee,{label:"文本内容"},{default:(0,m.w5)(()=>[(0,m.Wm)(Q,{modelValue:(0,m.SU)(x),"onUpdate:modelValue":f[7]||(f[7]=e=>(0,m.dq)(x)?x.value=e:null),placeholder:"请输入文本内容"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])],512)}}});var b=a(8163);let S=(0,b.default)(k,[["__scopeId","data-v-5eb883a8"]]);var W=a(30530),V=a(23565);let x={class:"page-wrap"},Z=["src"],I=(0,m.aZ)({__name:"flow",setup(e){let l=(0,f.F)(),{itemsType:a}=(0,W.Jk)(l),{fileUpload:v}=(0,p.V)(),w=[{align:"center",title:"文件名",dataIndex:"fileName"},{align:"center",title:"文件格式",dataIndex:"fileExtension"},{align:"center",title:"状态",dataIndex:"convertStatus",render:e=>{let{record:l}=e;return 0===l.convertStatus?"未转码":1===l.convertStatus?"转换中":2===l.convertStatus?"转换成功":"转换失败"}},{align:"center",width:100,title:"查看",slotName:"custom"}],y=(0,m.XI)([]),g=(0,m.qj)({current:1,total:0}),h=["edit","delete"],U=[".pdf",".png",".jpg",".jpeg"],_=(0,m.iH)(!1),k=(0,m.iH)(!1),b=(0,m.iH)(!1),I=(0,m.iH)(!0),H=(0,m.iH)(!1),P=(0,m.iH)(1),j=(0,m.iH)(10),z=(0,m.iH)("https://p1-arco.byteimg.com/tos-cn-i-uwbnlip3yd/a8c8cdb109cb051163646151a4a5083b.png~tplv-uwbnlip3yd-webp.webp"),q=(0,m.iH)({id:"",fileId:"",name:""}),T=(0,m.Fl)(()=>I.value?"查看流程图":"编辑流程图");async function D(e){_.value||(_.value=!0);try{let l=a.value,t=e?{...e,projectId:l}:{pageNo:1,pageSize:10,projectId:l},o=await (0,c.Ko)("/processFlowDiagram/queryByPage",t);if(200===o.code){y.value.length>0&&y.value.splice(0);let{records:e,total:l,current:a}=o.result||{};y.value=e||[],g.total=l||0,g.current=a||1}}finally{_.value=!1}}async function C(e){_.value=!0;try{let l=await (0,c.Ko)("/processFlowDiagram/deleteBatch",e);200===l.code&&(V.Z.success("删除成功"),await D())}catch(e){_.value=!1}}function F(e){let{item:l}=e,{id:a,fileId:t,name:o}=l;Object.assign(q.value,{id:a,fileId:t,name:o}),I.value=!1,k.value=!0}async function N(e){let{fileItem:l}=e,{file:t}=l,o=t.type.split("/")[1];if(!U.join().includes(o))return V.Z.error("上传文件格式不支持");b.value=!0;try{let e,l=await v(t,!1);await (e={...l,projectId:a.value},(0,c.Ko)("/processFlowDiagram/uploading",e)),D()}finally{b.value=!1}}async function E(e){H.value=!0;let l=P.value;-1===e||1===e?l+=e:l=e;try{let e,a,t=await (e=fileItem.id,a=l,(0,c.kA)(`/processFlowDiagram/getImageSvg/${e}/${a}`));200===t.code&&(P.value=l,H.value=!1)}catch(e){H.value=!1}}return(0,m.bv)(()=>{D()}),(e,l)=>{let a=s.Z,c=r.Z,p=u.Z,f=d.ZP,v=i.Z,W=n.Z,V=o.Z,A=t.Z;return(0,m.wg)(),(0,m.iD)(m.HY,null,[(0,m.Wm)(f,{class:"page-card",title:"工艺流程图"},{default:(0,m.w5)(()=>[(0,m.Wm)(p,{loading:(0,m.SU)(_),columns:w,data:(0,m.SU)(y),total:(0,m.SU)(g).total,current:(0,m.SU)(g).current,"action-items":h,onQuery:D,onUpdate:F,onDelete:C},{button:(0,m.w5)(()=>[(0,m.Wm)(c,{"show-file-list":!1,accept:U.join(),disabled:(0,m.SU)(b),"custom-request":N},{"upload-button":(0,m.w5)(()=>[(0,m.Wm)(a,{type:"primary",loading:(0,m.SU)(b)},{default:(0,m.w5)(()=>l[3]||(l[3]=[(0,m.Uk)(" 上传文件 ",-1)])),_:1,__:[3]},8,["loading"])]),_:1},8,["accept","disabled"])]),custom:(0,m.w5)(e=>{let{record:t}=e;return[(0,m.Wm)(a,{type:"text",status:"warning",onClick:e=>(function(e){let{id:l,fileId:a,name:t}=e;Object.assign(q.value,{id:l,fileId:a,name:t}),I.value=!0,k.value=!0})(t)},{default:(0,m.w5)(()=>l[4]||(l[4]=[(0,m.Uk)(" 查看 ",-1)])),_:2,__:[4]},1032,["onClick"])]}),_:1},8,["loading","data","total","current"])]),_:1}),(0,m.Wm)(A,{visible:(0,m.SU)(k),"onUpdate:visible":l[2]||(l[2]=e=>(0,m.dq)(k)?k.value=e:null),title:(0,m.SU)(T),width:"1080px",footer:!1,"is-space":!1,"is-header":""},{header:(0,m.w5)(()=>[(0,m.Wm)(W,null,{default:(0,m.w5)(()=>[(0,m.Wm)(a,{type:"outline",disabled:1===(0,m.SU)(P),onClick:l[0]||(l[0]=e=>E(-1))},{default:(0,m.w5)(()=>l[5]||(l[5]=[(0,m.Uk)(" 上一页 ",-1)])),_:1,__:[5]},8,["disabled"]),(0,m.Wm)(v,{class:"page-bar","model-value":(0,m.SU)(P),min:1,max:(0,m.SU)(j),"hide-button":"",onChange:E},null,8,["model-value","max"]),l[7]||(l[7]=(0,m._)("span",null,"/",-1)),(0,m.Wm)(v,{class:"page-bar","model-value":(0,m.SU)(j),"hide-button":"",disabled:""},null,8,["model-value"]),(0,m.Wm)(a,{type:"outline",disabled:(0,m.SU)(P)===(0,m.SU)(j),onClick:l[1]||(l[1]=e=>E(1))},{default:(0,m.w5)(()=>l[6]||(l[6]=[(0,m.Uk)(" 下一页 ",-1)])),_:1,__:[6]},8,["disabled"])]),_:1,__:[7]})]),default:(0,m.w5)(()=>[(0,m._)("div",x,[(0,m.Wm)(V,{loading:(0,m.SU)(H),tip:"数据加载中"},{default:(0,m.w5)(()=>[(0,m._)("img",{src:(0,m.SU)(z),draggable:"false"},null,8,Z),(0,m.Wm)(S,{"is-look":(0,m.SU)(I)},null,8,["is-look"])]),_:1},8,["loading"])])]),_:1},8,["visible","title"])],64)}}}),H=(0,b.default)(I,[["__scopeId","data-v-39fe3a0a"]])},60098:function(e,l,a){a.r(l),a.d(l,{default:()=>p});var t=a(34945),o=a(40098);a(86911);var n=a(10849),i=a(74953);a(38499);var d=a(36178);a(45264);var u=a(56655),r=a(65754),s=a(27900),m=a(9286),c=a(23565);let p=(0,r.aZ)({__name:"guide",setup(e){let l=(0,m.F)(),a=[{title:"引导词",dataIndex:"word"},{title:"含义",dataIndex:"meaning"},{title:"备注",dataIndex:"remark"}],p=(0,r.XI)([]),f=(0,r.qj)({total:0,current:1}),v=(0,r.XI)(!1),w=(0,r.XI)(!1),y=(0,r.XI)(!1),g=(0,r.XI)(),h={word:"",meaning:"",remark:""},U=(0,r.iH)({...h}),_={required:!0,message:"必填项不能为空",trigger:"blur"},k=(0,r.Fl)(()=>y.value?"新建引导词":"编辑引导词");async function b(e){v.value||(v.value=!0);try{let a=e?{...e,projectId:l.itemsType}:{pageNo:1,pageSize:10,projectId:l.itemsType},t=await (0,s.Dq)(a);if(p.value.length>0&&p.value.splice(0),200===t.code){let{records:e,total:l,current:a}=t.result||{};f.total=l||0,f.current=a||1,p.value=e||[]}}finally{v.value=!1}}function S(e){let{isEdit:a,item:t}=e;y.value=!1===a,U.value=y.value?{...h,projectId:l.itemsType}:{...t},w.value=!0}async function W(e){v.value=!0;try{let l=await (0,s.K)(e);200===l.code&&(c.Z.success("删除成功"),await b())}finally{v.value=!1}}async function V(){v.value=!0;try{let e={...U.value},l=y.value?await (0,s.y5)(e):await (0,s.uc)({...e,id:e.id});200===l.code&&(c.Z.success("保存成功"),w.value=!1,await b())}finally{v.value=!1}}return b(),(e,l)=>{let s=u.Z,m=d.ZP,c=i.ZP,y=n.Z,h=o.Z,x=t.Z;return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r.Wm)(m,{class:"page-card",title:"引导词"},{default:(0,r.w5)(()=>[(0,r.Wm)(s,{loading:(0,r.SU)(v),columns:a,data:(0,r.SU)(p),total:(0,r.SU)(f).total,current:(0,r.SU)(f).current,"add-text":"新建引导词",onQuery:b,onUpdate:S,onDelete:W},null,8,["loading","data","total","current"])]),_:1}),(0,r.Wm)(x,{modelValue:(0,r.SU)(w),"onUpdate:modelValue":l[3]||(l[3]=e=>(0,r.dq)(w)?w.value=e:null),"form-ref":(0,r.SU)(g),title:(0,r.SU)(k),"ok-loading":(0,r.SU)(v),onOk:V},{default:(0,r.w5)(()=>[(0,r.Wm)(h,{ref_key:"formRef",ref:g,model:(0,r.SU)(U),"auto-label-width":""},{default:(0,r.w5)(()=>[(0,r.Wm)(y,{label:"引导词",field:"word","show-colon":"",rules:_},{default:(0,r.w5)(()=>[(0,r.Wm)(c,{modelValue:(0,r.SU)(U).word,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,r.SU)(U).word=e),modelModifiers:{trim:!0},"max-length":50,"allow-clear":""},null,8,["modelValue"])]),_:1},8,["rules"]),(0,r.Wm)(y,{label:"含义",field:"meaning","show-colon":""},{default:(0,r.w5)(()=>[(0,r.Wm)(c,{modelValue:(0,r.SU)(U).meaning,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,r.SU)(U).meaning=e),modelModifiers:{trim:!0},"max-length":50,"allow-clear":""},null,8,["modelValue"])]),_:1}),(0,r.Wm)(y,{label:"备注",field:"remark","show-colon":""},{default:(0,r.w5)(()=>[(0,r.Wm)(c,{modelValue:(0,r.SU)(U).remark,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,r.SU)(U).remark=e),modelModifiers:{trim:!0},"max-length":50,"allow-clear":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","form-ref","title","ok-loading"])],64)}}})},3249:function(e,l,a){a.r(l),a.d(l,{default:()=>W});var t=a(36347);a(53857);var o=a(25185),n=a(65754),i=a(34945),d=a(40098);a(86911);var u=a(10849),r=a(74953);a(38499);var s=a(36178);a(45264);var m=a(56655),c=a(10043),p=a(9286),f=a(30530),v=a(23565);let w=(0,n.aZ)({__name:"mx-notice-frequency",setup(e){let l=(0,p.F)(),{matrixType:a}=(0,f.Jk)(l),t=[{align:"center",title:"频率",dataIndex:"frequency"},{align:"center",width:128,title:"频率值",dataIndex:"frequencyValue"},{title:"描述",dataIndex:"remark"}],o=(0,n.iH)([]),w=(0,n.iH)(!1),y=(0,n.iH)(!1),g=(0,n.iH)(!1),h=(0,n.iH)(null),U={id:null,frequency:"",remark:""},_=(0,n.iH)({...U}),k={required:!0,message:"必填项不能为空",trigger:"blur"},b=[{required:!0,message:"必填项不能为空",trigger:"blur"},{validator:(e,l)=>{e.trim()?/^(?:\d+~\d+|\d+[<≤＞≥]|[<≤＞≥]\d+|\d+)$/.test(e)?l():l("请输入大于等于0的整数,~、<、≤、>、≥、符号两端至少有一端有数字"):l("必填项不能为空")}}],S=(0,n.Fl)(()=>g.value?"新建频率":"编辑频率");function W(){V(a.value)}async function V(e){if(w.value||(w.value=!0),o.value.length>0&&o.value.splice(0),!e){w.value=!1;return}try{let l=await (0,c._Z)(e);200===l.code&&(o.value=l.result||[])}finally{w.value=!1}}function x(e){let{isEdit:l,item:t}=e;if(g.value=!1===l,g.value){let e=a.value;_.value={...U,matrixId:e},y.value=!0}else(0,c.tV)(t.id).then(e=>{_.value={...e.result||{}},y.value=!0})}async function Z(e){w.value=!0;try{let l=await (0,c.Fz)(e);200===l.code&&(v.Z.success("删除成功"),W())}catch(e){w.value=!1}}async function I(){w.value=!0;try{let e={..._.value},l=g.value?await (0,c.v9)(e):await (0,c.Ne)(e);200===l.code&&(v.Z.success("保存成功"),y.value=!1,W())}finally{w.value=!1}}return(0,n.YP)(()=>l.matrixType,V,{immediate:!0}),(e,l)=>{let a=m.Z,c=s.ZP,p=r.ZP,f=u.Z,v=d.Z,g=i.Z;return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(c,{title:"频率说明"},{default:(0,n.w5)(()=>[(0,n.Wm)(a,{loading:(0,n.SU)(w),columns:t,data:(0,n.SU)(o),"hide-page":"","add-text":"新建频率",onQuery:W,onUpdate:x,onDelete:Z},null,8,["loading","data"])]),_:1}),(0,n.Wm)(g,{modelValue:(0,n.SU)(y),"onUpdate:modelValue":l[3]||(l[3]=e=>(0,n.dq)(y)?y.value=e:null),"form-ref":(0,n.SU)(h),title:(0,n.SU)(S),"ok-loading":(0,n.SU)(w),onOk:I},{default:(0,n.w5)(()=>[(0,n.Wm)(v,{ref_key:"formRef",ref:h,model:(0,n.SU)(_),"auto-label-width":""},{default:(0,n.w5)(()=>[(0,n.Wm)(f,{label:"频率",field:"frequency","show-colon":"",rules:k},{default:(0,n.w5)(()=>[(0,n.Wm)(p,{modelValue:(0,n.SU)(_).frequency,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,n.SU)(_).frequency=e),modelModifiers:{trim:!0},"max-length":50,"allow-clear":""},null,8,["modelValue"])]),_:1},8,["rules"]),(0,n.Wm)(f,{label:"频率值",field:"frequencyValue","show-colon":"",rules:b},{default:(0,n.w5)(()=>[(0,n.Wm)(p,{modelValue:(0,n.SU)(_).frequencyValue,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,n.SU)(_).frequencyValue=e),modelModifiers:{trim:!0},"max-length":50,"allow-clear":""},null,8,["modelValue"])]),_:1},8,["rules"]),(0,n.Wm)(f,{label:"描述",field:"remark","show-colon":""},{default:(0,n.w5)(()=>[(0,n.Wm)(p,{modelValue:(0,n.SU)(_).remark,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,n.SU)(_).remark=e),modelModifiers:{trim:!0},"max-length":50,"allow-clear":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","form-ref","title","ok-loading"])],64)}}});var y=a(98760);let g=(0,n.aZ)({__name:"mx-notice-severity",setup(e){let l=(0,p.F)(),{matrixType:a}=(0,f.Jk)(l),t=(0,n.iH)(!1),o=(0,n.qj)([]),i=(0,n.qj)([]);async function d(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],l=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=async()=>{o.splice(0);try{let e=await (0,c.hg)(a.value);if(200===e.code){let l=e.result||{},a={required:!1,title:"",dataIndex:""},t=[];for(let e in l)if(Object.prototype.hasOwnProperty.call(l,e)){let o=l[e],n=Object.assign({align:"center"},a,{required:"1"===e,dataIndex:e,title:o});t.push(n)}o.push(...t)}}finally{t.value=!1}},d=async()=>{i.splice(0);try{let e=await (0,c.TO)(a.value);if(200===e.code){let l=e.result||[];i.push(...l)}}finally{t.value=!1}};t.value||(t.value=!0);try{e&&await n(),l&&await d()}finally{t.value=!1}}async function u(e){let{isColumn:l,isData:a}=e;await d(l,a)}async function r(e){t.value=!0;try{let l=await (0,c.yD)(e.rowId);200===l.code&&(v.Z.success("删除成功"),await d(!1,!0))}catch(e){t.value=!1}}return(0,n.YP)(()=>l.matrixType,function(e){e?d():(t.value=!1,o.splice(0),i.splice(0))},{immediate:!0}),(e,l)=>{let a=s.ZP;return(0,n.wg)(),(0,n.j4)(a,{title:"严重性说明",loading:(0,n.SU)(t)},{default:(0,n.w5)(()=>[(0,n.Wm)(y.Z,{columns:(0,n.SU)(o),data:(0,n.SU)(i),type:"severity",onUpdate:u,onDelete:r},null,8,["columns","data"])]),_:1},8,["loading"])}}});var h=a(17305);a(86314);let U=(0,n.aZ)({__name:"mx-set-risk",setup(e){let l=(0,p.F)(),{matrixType:a}=(0,f.Jk)(l),t=[{align:"center",width:160,title:"级别",dataIndex:"level"},{align:"center",width:120,title:"颜色",slotName:"custom"},{title:"备注",dataIndex:"remark"}],o=(0,n.iH)([]),w=(0,n.iH)(!1),y=(0,n.iH)(!1),g=(0,n.iH)(!1),U=(0,n.iH)(null),_={id:null,level:"",color:"",remark:""},k=(0,n.iH)({..._}),b={required:!0,message:"必填项不能为空",trigger:"blur"},S=(0,n.Fl)(()=>g.value?"新建风险等级":"编辑风险等级");function W(){V(a.value)}async function V(e){if(w.value||(w.value=!0),o.value.length>0&&o.value.splice(0),!e){w.value=!1;return}try{let a=await (0,c.uD)(e);if(200===a.code){let e=a.result||[];o.value=e,l.changeColor(e)}}finally{w.value=!1}}function x(e){let{isEdit:a,item:t}=e;if(g.value=!1===a,g.value){let e=l.matrixType;k.value={..._,matrixId:e},y.value=!0}else(0,c.uV)(t.id).then(e=>{k.value={...e.result||{}},y.value=!0})}async function Z(e){w.value=!0;try{let l=await (0,c.TI)(e);200===l.code&&(v.Z.success("删除成功"),W())}finally{w.value=!1}}async function I(){w.value=!0;try{let e={...k.value},l=g.value?await (0,c.GA)(e):await (0,c.qT)(e);200===l.code&&(v.Z.success("保存成功"),y.value=!1,W())}finally{w.value=!1}}return(0,n.YP)(()=>l.matrixType,V,{immediate:!0}),(e,l)=>{let a=h.Z,c=m.Z,p=s.ZP,f=r.ZP,v=u.Z,g=d.Z,_=i.Z;return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(p,{title:"风险等级设置"},{default:(0,n.w5)(()=>[(0,n.Wm)(c,{loading:(0,n.SU)(w),columns:t,data:(0,n.SU)(o),"show-index":!1,"hide-page":"","add-text":"新建风险等级",onQuery:W,onUpdate:x,onDelete:Z},{custom:(0,n.w5)(e=>{let{record:l}=e;return[(0,n.Wm)(a,{disabled:"","default-value":l.color},null,8,["default-value"])]}),_:1},8,["loading","data"])]),_:1}),(0,n.Wm)(_,{modelValue:(0,n.SU)(y),"onUpdate:modelValue":l[3]||(l[3]=e=>(0,n.dq)(y)?y.value=e:null),"form-ref":(0,n.SU)(U),title:(0,n.SU)(S),"ok-loading":(0,n.SU)(w),onOk:I},{default:(0,n.w5)(()=>[(0,n.Wm)(g,{ref_key:"formRef",ref:U,model:(0,n.SU)(k),"auto-label-width":""},{default:(0,n.w5)(()=>[(0,n.Wm)(v,{label:"级别",field:"level","show-colon":"",rules:b},{default:(0,n.w5)(()=>[(0,n.Wm)(f,{modelValue:(0,n.SU)(k).level,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,n.SU)(k).level=e),modelModifiers:{trim:!0},"max-length":50,"allow-clear":""},null,8,["modelValue"])]),_:1},8,["rules"]),(0,n.Wm)(v,{label:"颜色",field:"color","show-colon":""},{default:(0,n.w5)(()=>[(0,n.Wm)(a,{modelValue:(0,n.SU)(k).color,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,n.SU)(k).color=e),format:"hex","show-text":""},null,8,["modelValue"])]),_:1}),(0,n.Wm)(v,{label:"备注",field:"remark","show-colon":""},{default:(0,n.w5)(()=>[(0,n.Wm)(f,{modelValue:(0,n.SU)(k).remark,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,n.SU)(k).remark=e),modelModifiers:{trim:!0},"max-length":50,"allow-clear":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","form-ref","title","ok-loading"])],64)}}});var _=a(72090),k=a(2421);a(3498);var b=a(30932);let S=(0,n.aZ)({__name:"mx-type-list",setup(e){let l=(0,p.F)(),{matrixType:a}=(0,f.Jk)(l),t=(0,n.Fl)(()=>l.matrixList),o=[{align:"center",title:"矩阵名称",dataIndex:"name"},{align:"center",title:"矩阵描述",dataIndex:"description"}],w=(0,n.iH)([]),y=(0,n.iH)(!1),g=(0,n.iH)(!1),h=(0,n.iH)(!1),U=(0,n.iH)(null),_={id:null,name:"",description:""},S=(0,n.iH)({..._}),W={required:!0,message:"必填项不能为空",trigger:"blur"},V=(0,n.Fl)(()=>h.value?"新建矩阵":"编辑矩阵");async function x(e){let a=t.value.find(l=>l.id===e);if(a)try{await (0,c._e)(e)}finally{l.setMatrixType(a)}}async function Z(){y.value||(y.value=!0),w.value.length>0&&w.value.splice(0);try{let e=await (0,c.Rk)();if(200===e.code){let a=e.result||[];w.value=a,l.setMatrixList(a)}}finally{y.value=!1}}function I(e){let{isEdit:a,item:t}=e;h.value=!1===a,S.value=h.value?{..._,projectId:l.itemsType}:{...t,projectId:l.itemsType},g.value=!0}async function H(e){y.value=!0;try{let l=await (0,c.F4)(e);200===l.code&&(v.Z.success("删除成功"),await Z())}finally{y.value=!1}}async function P(){y.value=!0;try{let e={...S.value},l=h.value?await (0,c.S0)(e):await (0,c._c)(e);200===l.code&&(g.value=!1,v.Z.success("保存成功"),await Z())}finally{y.value=!1}}return(0,n.bv)(()=>{Z()}),(e,l)=>{let c=b.Z,p=k.ZP,f=m.Z,v=s.ZP,h=r.ZP,_=u.Z,j=d.Z,z=i.Z;return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(v,{title:"矩阵信息设置"},{extra:(0,n.w5)(()=>[(0,n.Wm)(p,{class:"w-200","model-value":(0,n.SU)(a),placeholder:"请选择矩阵类型",onChange:x},{default:(0,n.w5)(()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)((0,n.SU)(t),e=>((0,n.wg)(),(0,n.j4)(c,{key:e.id,value:e.id},{default:(0,n.w5)(()=>[(0,n.Uk)((0,n.zw)(e.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["model-value"])]),default:(0,n.w5)(()=>[(0,n.Wm)(f,{loading:(0,n.SU)(y),columns:o,data:(0,n.SU)(w),"hide-page":"","add-text":"新建矩阵",onQuery:Z,onUpdate:I,onDelete:H},null,8,["loading","data"])]),_:1}),(0,n.Wm)(z,{modelValue:(0,n.SU)(g),"onUpdate:modelValue":l[2]||(l[2]=e=>(0,n.dq)(g)?g.value=e:null),"form-ref":(0,n.SU)(U),title:(0,n.SU)(V),"ok-loading":(0,n.SU)(y),onOk:P},{default:(0,n.w5)(()=>[(0,n.Wm)(j,{ref_key:"formRef",ref:U,model:(0,n.SU)(S),"auto-label-width":""},{default:(0,n.w5)(()=>[(0,n.Wm)(_,{label:"矩阵名称",field:"name","show-colon":"",rules:W},{default:(0,n.w5)(()=>[(0,n.Wm)(h,{modelValue:(0,n.SU)(S).name,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,n.SU)(S).name=e),modelModifiers:{trim:!0},"max-length":50,"allow-clear":""},null,8,["modelValue"])]),_:1},8,["rules"]),(0,n.Wm)(_,{label:"矩阵描述",field:"description","show-colon":""},{default:(0,n.w5)(()=>[(0,n.Wm)(h,{modelValue:(0,n.SU)(S).description,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,n.SU)(S).description=e),modelModifiers:{trim:!0},"max-length":50,"allow-clear":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","form-ref","title","ok-loading"])],64)}}}),W=(0,n.aZ)({__name:"matrix",setup(e){let l=(0,n.iH)(10),a=(0,n.iH)({xxl:14,xl:24,lg:24}),i=(0,n.iH)({xxl:10,xl:24,lg:24});return(e,d)=>{let u=o.Z,r=t.ZP;return(0,n.wg)(),(0,n.j4)(r,{"col-gap":(0,n.SU)(l),"row-gap":(0,n.SU)(l)},{default:(0,n.w5)(()=>[(0,n.Wm)(u,{span:24},{default:(0,n.w5)(()=>[(0,n.Wm)(S)]),_:1}),(0,n.Wm)(u,{span:(0,n.SU)(i)},{default:(0,n.w5)(()=>[(0,n.Wm)(U)]),_:1},8,["span"]),(0,n.Wm)(u,{span:(0,n.SU)(a)},{default:(0,n.w5)(()=>[(0,n.Wm)(_.Z)]),_:1},8,["span"]),(0,n.Wm)(u,{span:(0,n.SU)(i)},{default:(0,n.w5)(()=>[(0,n.Wm)(w)]),_:1},8,["span"]),(0,n.Wm)(u,{span:(0,n.SU)(a)},{default:(0,n.w5)(()=>[(0,n.Wm)(g)]),_:1},8,["span"])]),_:1},8,["col-gap","row-gap"])}}})},72090:function(e,l,a){a.d(l,{Z:()=>h});var t=a(36178);a(45264);var o=a(86033);a(15745);var n=a(38699);a(87265);var i=a(2421);a(3498);var d=a(30932),u=a(59643);a(30858);var r=a(94140);a(76270);var s=a(65754),m=a(10043),c=a(7061),p=a(9286),f=a(30530),v=a(23565);let w={key:0,class:"mx-x"},y={key:1,class:"mx-y"},g=(0,s.aZ)({__name:"mx-set-second",props:{isProgram:{type:Boolean,default:!1},projectId:{type:String,default:""},matrixId:{type:String,default:""}},emits:["update"],setup(e,l){let{expose:a,emit:g}=l,h=(0,p.F)(),{itemsType:U,matrixType:_,levelList:k,levelColor:b,printList:S,printColor:W}=(0,f.Jk)(h),{snapUpload:V}=(0,c.V)(),x=(0,s.iH)(!1),Z=(0,s.iH)(!1),I=(0,s.iH)(null),H={padding:"5px"},P=(0,s.iH)(0),j=(0,s.iH)(0),z=(0,s.iH)([]),q=(0,s.Fl)(()=>e.isProgram?S.value:k.value),T=(0,s.Fl)(()=>(l,a)=>{var t,o,n;let i=(null==(n=z.value)||null==(o=n[l])||null==(t=o[a])?void 0:t.levelId)||"";return{background:(e.isProgram?W.value[i]:b.value[i])||"#fff"}}),D=(0,s.Fl)(()=>0===z.value.length);function C(){Z.value&&(Z.value=!1),N(_.value)}async function F(){if(e.isProgram){x.value=!0;try{let l=await (0,m.fy)(e.matrixId,e.projectId);if(200===l.code){let e=l.result||[];if(h.changeColor(e,!0),e.length>0){let l={};e.forEach(e=>l[e.id]=e.color),g("update",l)}C()}}catch(e){x.value=!1}}}async function N(l){x.value||(x.value=!0);let a=e.isProgram?e.matrixId:l;if(!a){z.value.length>0&&z.value.splice(0),x.value=!1;return}try{let e=await (0,m.ps)(a);if(200===e.code){let l=e.result||[];P.value=l[0].length+1,j.value=l.length+1,z.value=l}}finally{x.value=!1}}async function E(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],l=async()=>{x.value=!0;try{let e={matrixId:_.value,cells:[...z.value]},l=await (0,m.hj)(e);200===l.code&&(Z.value=!1,v.Z.success("保存成功"),C())}finally{x.value=!1}};e?await l():C()}function A(){Z.value=!0}async function L(){try{let l=`${e.projectId?e.projectId:U.value}-matrix.png`,a=await V(I.value,l);if(a)return a}catch(e){throw Error("MatrixChart: 保存图片失败")}}return(0,s.YP)(()=>h.levelList,()=>{e.isProgram||C()},{deep:!0}),(0,s.YP)(()=>h.matrixType,l=>{e.isProgram||N(l)},{immediate:!0}),(0,s.bv)(()=>{F()}),a({uploadImage:L}),(l,a)=>{let m=r.Z,c=u.Z,p=d.Z,f=i.ZP,v=n.Z,g=o.Z,h=t.ZP;return(0,s.wg)(),(0,s.j4)(h,{title:"严重性/频率设置","header-style":H,"body-style":H},{extra:(0,s.w5)(()=>[(0,s.Wm)(c,null,{default:(0,s.w5)(()=>[(0,s.SU)(Z)?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s.Wm)(m,{type:"primary",onClick:a[0]||(a[0]=e=>E(!0))},{default:(0,s.w5)(()=>a[2]||(a[2]=[(0,s.Uk)(" 保存数据 ",-1)])),_:1,__:[2]}),(0,s.Wm)(m,{type:"primary",onClick:a[1]||(a[1]=e=>E(!1))},{default:(0,s.w5)(()=>a[3]||(a[3]=[(0,s.Uk)(" 取消保存 ",-1)])),_:1,__:[3]})],64)):((0,s.wg)(),(0,s.iD)(s.HY,{key:1},[e.isProgram?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(m,{key:0,type:"primary",disabled:(0,s.SU)(D),onClick:A},{default:(0,s.w5)(()=>a[4]||(a[4]=[(0,s.Uk)(" 编辑数据 ",-1)])),_:1,__:[4]},8,["disabled"])),(0,s.Wm)(m,{type:"primary",disabled:(0,s.SU)(D),onClick:C},{default:(0,s.w5)(()=>a[5]||(a[5]=[(0,s.Uk)(" 刷新 ",-1)])),_:1,__:[5]},8,["disabled"])],64))]),_:1})]),default:(0,s.w5)(()=>[(0,s.Wm)(g,{loading:(0,s.SU)(x)},{default:(0,s.w5)(()=>[(0,s.SU)(z).length>0?((0,s.wg)(),(0,s.iD)("table",{key:0,ref_key:"tableRef",ref:I,class:"mx-table"},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)((0,s.SU)(j),e=>((0,s.wg)(),(0,s.iD)("tr",{key:e},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)((0,s.SU)(P),l=>((0,s.wg)(),(0,s.iD)(s.HY,{key:l},[e===(0,s.SU)(j)?((0,s.wg)(),(0,s.iD)("th",w,(0,s.zw)(l-1),1)):1===l?((0,s.wg)(),(0,s.iD)("th",y,(0,s.zw)((0,s.SU)(j)-e),1)):((0,s.wg)(),(0,s.iD)("td",{key:2,style:(0,s.j5)((0,s.SU)(T)((0,s.SU)(j)-e-1,l-2))},[(0,s.Wm)(f,{modelValue:(0,s.SU)(z)[(0,s.SU)(j)-e-1][l-2].levelId,"onUpdate:modelValue":a=>(0,s.SU)(z)[(0,s.SU)(j)-e-1][l-2].levelId=a,disabled:!(0,s.SU)(Z),onChange:a=>(function(e,l){let a=z.value[e][l];a&&(z.value[e][l]={...a,levelName:a.levelName})})((0,s.SU)(j)-e-1,l-2)},{default:(0,s.w5)(()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)((0,s.SU)(q),e=>((0,s.wg)(),(0,s.j4)(p,{key:e.id,value:e.id},{default:(0,s.w5)(()=>[(0,s.Uk)((0,s.zw)(e.level),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","onChange"])],4))],64))),128))]))),128))],512)):(0,s.kq)("",!0),(0,s.SU)(D)?((0,s.wg)(),(0,s.j4)(v,{key:1})):(0,s.kq)("",!0)]),_:1},8,["loading"])]),_:1})}}}),h=(0,a(8163).default)(g,[["__scopeId","data-v-049a71c0"]])},72827:function(e,l,a){a.r(l),a.d(l,{default:()=>y});var t=a(34945),o=a(40098);a(86911);var n=a(2421);a(3498);var i=a(30932),d=a(32374);a(38427);var u=a(10849),r=a(74953);a(38499);var s=a(36178);a(45264);var m=a(56655),c=a(65754),p=a(74623),f=a(95974),v=a(9286),w=a(23565);let y=(0,c.aZ)({__name:"meeting",setup(e){let l=(0,v.F)().itemsType,y=(0,c.XI)(!1),g=(0,c.XI)(!1),h=(0,c.XI)(!1),U=(0,c.XI)(),_={id:"",address:"",beginTime:"",endTime:"",chairmanId:"",secretaryId:"",participantIds:[],projectId:"",name:""},k=(0,c.iH)({..._}),b=(0,c.iH)([]),S=(0,c.iH)([]),W=(0,c.iH)([]),V=[{align:"center",title:"会议名称",dataIndex:"name"},{align:"center",title:"会议开始时间",dataIndex:"meetingTime"}],x=(0,c.XI)([]),Z={required:!0,message:"必填项不能为空",trigger:"blur"},I={required:!0,message:"时间不能为空",trigger:"change"},H={required:!0,message:"必选项不能为空",trigger:"change"},P=(0,c.Fl)(()=>h.value?"会议信息录入":"会议信息编辑"),j=(0,c.Fl)(()=>e=>1===e.chairman?"（主席）":e.jobTitle?`\u{FF08}${e.jobTitle}\u{FF09}`:""),z=(0,c.Fl)(()=>(e,l)=>{var a;return 0===e||1===e?null==(a=k.value.participantIds)?void 0:a.includes(l):2===e&&(k.value.chairmanId===l||k.value.secretaryId===l)});async function q(){try{b.value.length>0&&b.value.splice(0);let e=await (0,f.UL)(0);if(200===e.code){let l=e.result||[];b.value.push(...l)}S.value.length>0&&S.value.splice(0);let l=await (0,f.UL)(1);if(200===l.code){let e=l.result||[];S.value.push(...e)}W.value.length>0&&W.value.splice(0);let a=await (0,f.UL)(2);if(200===a.code){let e=a.result||[];W.value.push(...e)}}finally{y.value=!1}}async function T(){y.value||(y.value=!0),x.value.length>0&&x.value.splice(0);try{let e=await (0,p.Hi)();200===e.code&&(x.value=e.result||[])}finally{y.value=!1}}function D(e){let{isEdit:l,item:a}=e;h.value=!1===l,h.value?(k.value={..._},g.value=!0):(0,p.Ho)(a.id).then(e=>{let{id:l,name:a="",address:t="",beginTime:o="",endTime:n="",chairmanId:i="",secretaryId:d="",projectId:u="",participants:r}=e.result||{};k.value={id:l,name:a,address:t,beginTime:o,endTime:n,chairmanId:i,secretaryId:d,projectId:u,participantIds:r},g.value=!0})}async function C(e){y.value=!0;try{let l=await (0,p.zz)(e);200===l.code&&(w.Z.success("删除成功"),await T())}finally{y.value=!1}}async function F(){y.value=!0;try{let e={...k.value,projectId:l},a=h.value?await (0,p.jc)(e):await (0,p.$y)({...e,id:e.id});200===a.code&&(g.value=!1,w.Z.success("保存成功"),await T())}finally{y.value=!1}}async function N(e){try{let l,t=await (0,p.Ho)(e.id);if(200!==t.code)return void w.Z.error("获取会议信息失败");let o=t.result,n=await (0,p.ft)(e.id);if(200!==n.code)return void w.Z.error("获取会议人员信息失败");let i=n.result||[];try{l=await Promise.resolve().then(a.bind(a,9621))}catch(e){w.Z.error("请先安装docx库：npm install docx");return}let{Document:d,Packer:u,Paragraph:r,Table:s,TableRow:m,TableCell:c,TextRun:f,AlignmentType:v,WidthType:y,BorderStyle:g}=l,h=[];h.push(new r({children:[new f({text:"会议签到表",bold:!0,size:32})],alignment:v.CENTER,spacing:{after:400}})),h.push(new r({children:[new f({text:`\u{4F1A}\u{8BAE}\u{540D}\u{79F0}\u{FF1A}${o.name||""}`})],spacing:{after:200}})),h.push(new r({children:[new f({text:`\u{4F1A}\u{8BAE}\u{5730}\u{70B9}\u{FF1A}${o.address||""}`})],spacing:{after:200}})),h.push(new r({children:[new f({text:`\u{65E5}\u{671F}\u{FF1A}${o.beginTime?o.beginTime.split(" ")[0]:""}`})],spacing:{after:400}}));let U=[];U.push(new m({height:{value:400,rule:"atLeast"},children:[new c({children:[new r({children:[new f({text:"序号",bold:!0})],alignment:v.CENTER})],width:{size:8,type:y.PERCENTAGE},verticalAlign:"center"}),new c({children:[new r({children:[new f({text:"*姓名",bold:!0})],alignment:v.CENTER})],width:{size:15,type:y.PERCENTAGE},verticalAlign:"center"}),new c({children:[new r({children:[new f({text:"专业",bold:!0})],alignment:v.CENTER})],width:{size:12,type:y.PERCENTAGE},verticalAlign:"center"}),new c({children:[new r({children:[new f({text:"职务",bold:!0})],alignment:v.CENTER})],width:{size:12,type:y.PERCENTAGE},verticalAlign:"center"}),new c({children:[new r({children:[new f({text:"*项目角色",bold:!0})],alignment:v.CENTER})],width:{size:15,type:y.PERCENTAGE},verticalAlign:"center"}),new c({children:[new r({children:[new f({text:"公司",bold:!0})],alignment:v.CENTER})],width:{size:18,type:y.PERCENTAGE},verticalAlign:"center"}),new c({children:[new r({children:[new f({text:"*签名",bold:!0})],alignment:v.CENTER})],width:{size:20,type:y.PERCENTAGE},verticalAlign:"center"})]})),i.forEach((e,l)=>{U.push(new m({height:{value:400,rule:"atLeast"},children:[new c({children:[new r({text:(l+1).toString(),alignment:v.CENTER})],width:{size:8,type:y.PERCENTAGE},verticalAlign:"center"}),new c({children:[new r({text:e.name||"",alignment:v.CENTER})],width:{size:15,type:y.PERCENTAGE},verticalAlign:"center"}),new c({children:[new r({text:e.major||"",alignment:v.CENTER})],width:{size:12,type:y.PERCENTAGE},verticalAlign:"center"}),new c({children:[new r({text:e.jobTitle||"",alignment:v.CENTER})],width:{size:12,type:y.PERCENTAGE},verticalAlign:"center"}),new c({children:[new r({text:e.projectRole||"",alignment:v.CENTER})],width:{size:15,type:y.PERCENTAGE},verticalAlign:"center"}),new c({children:[new r({text:e.companyName||"",alignment:v.CENTER})],width:{size:18,type:y.PERCENTAGE},verticalAlign:"center"}),new c({children:[new r({text:""})],width:{size:20,type:y.PERCENTAGE},verticalAlign:"center"})]}))});for(let e=0;e<5;e++)U.push(new m({height:{value:400,rule:"atLeast"},children:[new c({children:[new r({text:""})],width:{size:8,type:y.PERCENTAGE},verticalAlign:"center"}),new c({children:[new r({text:""})],width:{size:15,type:y.PERCENTAGE},verticalAlign:"center"}),new c({children:[new r({text:""})],width:{size:12,type:y.PERCENTAGE},verticalAlign:"center"}),new c({children:[new r({text:""})],width:{size:12,type:y.PERCENTAGE},verticalAlign:"center"}),new c({children:[new r({text:""})],width:{size:15,type:y.PERCENTAGE},verticalAlign:"center"}),new c({children:[new r({text:""})],width:{size:18,type:y.PERCENTAGE},verticalAlign:"center"}),new c({children:[new r({text:""})],width:{size:20,type:y.PERCENTAGE},verticalAlign:"center"})]}));let _=new s({rows:U,width:{size:100,type:y.PERCENTAGE},borders:{top:{style:g.SINGLE,size:1},bottom:{style:g.SINGLE,size:1},left:{style:g.SINGLE,size:1},right:{style:g.SINGLE,size:1},insideHorizontal:{style:g.SINGLE,size:1},insideVertical:{style:g.SINGLE,size:1}}}),k=new d({sections:[{children:[...h,_]}]}),b=await u.toBlob(k),S=URL.createObjectURL(b),W=document.createElement("a");W.href=S,W.download=`${o.name||"会议"}_\u{7B7E}\u{5230}\u{8868}.docx`,document.body.appendChild(W),W.click(),document.body.removeChild(W),URL.revokeObjectURL(S),w.Z.success("导出成功")}catch(e){w.Z.error("导出失败，请重试")}}function E(e){w.Z.info("上传功能待实现")}function A(e){w.Z.info("电子签名功能待实现")}return(0,c.bv)(()=>{T(),q()}),(e,l)=>{let a=m.Z,p=s.ZP,f=r.ZP,v=u.Z,w=d.ZP,h=i.Z,_=n.ZP,q=o.Z,L=t.Z;return(0,c.wg)(),(0,c.iD)(c.HY,null,[(0,c.Wm)(p,{class:"page-card",title:"会议-创建会议流程"},{default:(0,c.w5)(()=>[(0,c.Wm)(a,{loading:(0,c.SU)(y),columns:V,data:(0,c.SU)(x),"hide-page":"","add-text":"新建","show-export":!0,"show-upload":!0,"show-signature":!0,"optional-width":400,onQuery:T,onUpdate:D,onDelete:C,onExport:N,onUpload:E,onSignature:A},null,8,["loading","data"])]),_:1}),(0,c.Wm)(L,{modelValue:(0,c.SU)(g),"onUpdate:modelValue":l[7]||(l[7]=e=>(0,c.dq)(g)?g.value=e:null),"form-ref":(0,c.SU)(U),title:(0,c.SU)(P),"ok-loading":(0,c.SU)(y),onOk:F},{default:(0,c.w5)(()=>[(0,c.Wm)(q,{ref_key:"formRef",ref:U,model:(0,c.SU)(k),"auto-label-width":""},{default:(0,c.w5)(()=>[(0,c.Wm)(v,{label:"会议名称",field:"name","show-colon":"",rules:Z},{default:(0,c.w5)(()=>[(0,c.Wm)(f,{modelValue:(0,c.SU)(k).name,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,c.SU)(k).name=e),modelModifiers:{trim:!0},"max-length":50,"allow-clear":""},null,8,["modelValue"])]),_:1},8,["rules"]),(0,c.Wm)(v,{label:"会议地点",field:"address","show-colon":""},{default:(0,c.w5)(()=>[(0,c.Wm)(f,{modelValue:(0,c.SU)(k).address,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,c.SU)(k).address=e),modelModifiers:{trim:!0},"max-length":50,"allow-clear":""},null,8,["modelValue"])]),_:1}),(0,c.Wm)(v,{label:"会议开始时间",field:"beginTime","show-colon":"",rules:I},{default:(0,c.w5)(()=>[(0,c.Wm)(w,{modelValue:(0,c.SU)(k).beginTime,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,c.SU)(k).beginTime=e),class:"w-100","show-time":"",format:"YYYY-MM-DD HH:mm"},null,8,["modelValue"])]),_:1},8,["rules"]),(0,c.Wm)(v,{label:"会议结束时间",field:"endTime","show-colon":"",rules:I},{default:(0,c.w5)(()=>[(0,c.Wm)(w,{modelValue:(0,c.SU)(k).endTime,"onUpdate:modelValue":l[3]||(l[3]=e=>(0,c.SU)(k).endTime=e),class:"w-100","show-time":"",format:"YYYY-MM-DD HH:mm"},null,8,["modelValue"])]),_:1},8,["rules"]),(0,c.Wm)(v,{label:"主席",field:"chairmanId","show-colon":"",rules:H},{default:(0,c.w5)(()=>[(0,c.Wm)(_,{modelValue:(0,c.SU)(k).chairmanId,"onUpdate:modelValue":l[4]||(l[4]=e=>(0,c.SU)(k).chairmanId=e),"allow-search":"","allow-clear":""},{default:(0,c.w5)(()=>[((0,c.wg)(!0),(0,c.iD)(c.HY,null,(0,c.Ko)((0,c.SU)(b),e=>((0,c.wg)(),(0,c.j4)(h,{key:e.id,value:e.id,label:e.name,disabled:(0,c.SU)(z)(0,e.id)},{default:(0,c.w5)(()=>[(0,c.Uk)((0,c.zw)(e.name)+(0,c.zw)((0,c.SU)(j)(e))+(0,c.zw)(e.companyName),1)]),_:2},1032,["value","label","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["rules"]),(0,c.Wm)(v,{label:"记录员",field:"secretaryId","show-colon":"",rules:H},{default:(0,c.w5)(()=>[(0,c.Wm)(_,{modelValue:(0,c.SU)(k).secretaryId,"onUpdate:modelValue":l[5]||(l[5]=e=>(0,c.SU)(k).secretaryId=e),"allow-search":"","allow-clear":""},{default:(0,c.w5)(()=>[((0,c.wg)(!0),(0,c.iD)(c.HY,null,(0,c.Ko)((0,c.SU)(S),e=>((0,c.wg)(),(0,c.j4)(h,{key:e.id,value:e.id,disabled:(0,c.SU)(z)(1,e.id)},{default:(0,c.w5)(()=>[(0,c.Uk)((0,c.zw)(e.name)+(0,c.zw)((0,c.SU)(j)(e))+(0,c.zw)(e.companyName),1)]),_:2},1032,["value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["rules"]),(0,c.Wm)(v,{label:"参会人员",field:"participantIds","show-colon":"",rules:H},{default:(0,c.w5)(()=>[(0,c.Wm)(_,{modelValue:(0,c.SU)(k).participantIds,"onUpdate:modelValue":l[6]||(l[6]=e=>(0,c.SU)(k).participantIds=e),multiple:"","allow-search":"","allow-clear":""},{default:(0,c.w5)(()=>[((0,c.wg)(!0),(0,c.iD)(c.HY,null,(0,c.Ko)((0,c.SU)(W),e=>((0,c.wg)(),(0,c.j4)(h,{key:e.id,value:e.id,disabled:(0,c.SU)(z)(2,e.id)},{default:(0,c.w5)(()=>[(0,c.Uk)((0,c.zw)(e.name)+(0,c.zw)((0,c.SU)(j)(e))+(0,c.zw)(e.companyName),1)]),_:2},1032,["value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1},8,["model"])]),_:1},8,["modelValue","form-ref","title","ok-loading"])],64)}}})},52404:function(e,l,a){a.r(l),a.d(l,{default:()=>p});var t=a(34945),o=a(40098);a(86911);var n=a(10849),i=a(74953);a(38499);var d=a(36178);a(45264);var u=a(56655),r=a(65754),s=a(39908),m=a(9286),c=a(23565);let p=(0,r.aZ)({__name:"params",setup(e){let l=(0,m.F)().itemsType,a=(0,r.iH)(!1),p=(0,r.iH)(!1),f=(0,r.iH)(!1),v=(0,r.iH)(null),w=(0,r.iH)({name:"",remark:""}),y=[{title:"参数",dataIndex:"name"},{title:"备注",dataIndex:"remark"}],g=(0,r.iH)([]),h=(0,r.qj)({total:0,current:1}),U={required:!0,message:"必填项不能为空",trigger:"blur"},_=(0,r.Fl)(()=>f.value?"新建参数":"编辑参数");async function k(e){a.value||(a.value=!0),g.value.length>0&&g.value.splice(0);try{let a=e?{...e,projectId:l}:{pageNo:1,pageSize:10,projectId:l},t=await (0,s.OW)(a);if(200===t.code){let{records:e,total:l,current:a}=t.result||{};h.total=l||0,h.current=a||1,g.value.push(...e||[])}}finally{a.value=!1}}function b(e){let{isEdit:a,item:t}=e;f.value=!1===a,w.value={...f.value?{name:"",remark:"",projectId:l}:{...t}},p.value=!0}async function S(e){a.value=!0;try{let l=await (0,s.Kr)(e);200===l.code&&(c.Z.success("删除成功"),await k())}catch(e){a.value=!1}}async function W(){a.value=!0;try{let e={...w.value},l=f.value?await (0,s.VJ)(e):await (0,s.oE)(e);200===l.code&&(c.Z.success("保存成功"),p.value=!1,await k())}catch(e){a.value=!1}}return(0,r.bv)(()=>{k()}),(e,l)=>{let s=u.Z,m=d.ZP,c=i.ZP,f=n.Z,V=o.Z,x=t.Z;return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r.Wm)(m,{class:"page-card",title:"参数-添加分析所用参数"},{default:(0,r.w5)(()=>[(0,r.Wm)(s,{loading:(0,r.SU)(a),columns:y,data:(0,r.SU)(g),total:(0,r.SU)(h).total,current:(0,r.SU)(h).current,"add-text":"新建参数",onQuery:k,onUpdate:b,onDelete:S},null,8,["loading","data","total","current"])]),_:1}),(0,r.Wm)(x,{modelValue:(0,r.SU)(p),"onUpdate:modelValue":l[2]||(l[2]=e=>(0,r.dq)(p)?p.value=e:null),"form-ref":(0,r.SU)(v),title:(0,r.SU)(_),"ok-loading":(0,r.SU)(a),onOk:W},{default:(0,r.w5)(()=>[(0,r.Wm)(V,{ref_key:"formRef",ref:v,model:(0,r.SU)(w),"auto-label-width":""},{default:(0,r.w5)(()=>[(0,r.Wm)(f,{label:"参数",field:"name","show-colon":"",rules:U},{default:(0,r.w5)(()=>[(0,r.Wm)(c,{modelValue:(0,r.SU)(w).name,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,r.SU)(w).name=e),modelModifiers:{trim:!0},"max-length":50,"allow-clear":""},null,8,["modelValue"])]),_:1},8,["rules"]),(0,r.Wm)(f,{label:"备注",field:"remark","show-colon":""},{default:(0,r.w5)(()=>[(0,r.Wm)(c,{modelValue:(0,r.SU)(w).remark,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,r.SU)(w).remark=e),modelModifiers:{trim:!0},"max-length":50,"allow-clear":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","form-ref","title","ok-loading"])],64)}}})},70658:function(e,l,a){a.r(l),a.d(l,{default:()=>h});var t=a(34945),o=a(40098);a(86911);var n=a(57501);a(88372);var i=a(2421);a(3498);var d=a(10849),u=a(74953);a(38499);var r=a(36178);a(45264);var s=a(56299);a(53857);var m=a(56655),c=a(35586),p=a(23490),f=a(65754),v=a(29640),w=a(95974),y=a(9286),g=a(23565);let h=(0,f.aZ)({__name:"staff",setup(e){let l=(0,y.F)().itemsType,a=(0,f.iH)(["0"]),h=(0,f.XI)(!1),U=(0,f.XI)(!1),_=(0,f.XI)(!1),k=(0,f.XI)(),b=[{label:"HAZOP分析主席",value:"HAZOP分析主席"},{label:"工艺工程师",value:"工艺工程师"},{label:"仪表工程师",value:"仪表工程师"},{label:"操作专家",value:"操作专家"},{label:"记录员",value:"记录员"},{label:"安全工程师",value:"安全工程师"},{label:"专利商或供货商代表",value:"专利商或供货商代表"},{label:"其他专业人员",value:"其他专业人员"}],S=[{label:"工艺",value:"工艺"},{label:"仪表",value:"仪表"},{label:"设备",value:"设备"},{label:"安全",value:"安全"},{label:"操作",value:"操作"}],W=[{label:"工艺工程师",value:"工艺工程师"},{label:"仪表工程师",value:"仪表工程师"},{label:"机械工程师",value:"机械工程师"},{label:"安全工程师",value:"安全工程师"},{label:"经理",value:"经理"},{label:"主管",value:"主管"},{label:"EHS总监",value:"EHS总监"},{label:"设备技术员",value:"设备技术员"},{label:"仪表维护工程师",value:"仪表维护工程师"},{label:"现场安全员",value:"现场安全员"}],V={key:"id",title:"name"},x={id:"",name:"",chairman:0,major:"",jobTitle:"",projectRole:"",phone:"",department:"",companyId:""},Z=(0,f.iH)({...x}),I=(0,f.XI)([]),H=[{align:"center",title:"姓名",dataIndex:"name"},{align:"center",title:"公司名称",dataIndex:"companyName"},{align:"center",title:"专业",dataIndex:"major"},{align:"center",title:"职务",dataIndex:"jobTitle"},{align:"center",title:"单位",dataIndex:"department"},{align:"center",title:"主席",dataIndex:"chairman",render:e=>{let{record:l}=e;return 1===l.chairman?"是":"否"}}],P=(0,f.XI)([]),j=(0,f.qj)({total:0,current:1}),z={required:!0,message:"必填项不能为空",trigger:"blur"},q=(0,f.Fl)(()=>_.value?"人员信息录入":"人员信息编辑");async function T(e){h.value||(h.value=!0),P.value.length>0&&P.value.splice(0);try{let l=a.value[0],t=e?{...e,companyId:l}:{companyId:l},o=await (0,w.mv)(t);if(200===o.code){let{records:e,total:l,current:a}=o.result||{};j.total=l||0,j.current=a||1,P.value=e||[]}}finally{h.value=!1}}async function D(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,l=async()=>{h.value=!0;try{let e=await (0,w.Di)();if(200===e.code){let l=e.result||[];I.value.length>0&&I.value.splice(0),a.value[0]=l[0].id,I.value=l,await T()}}finally{h.value=!1}};e?T():l()}async function C(e){let{data:a,isEdit:t}=e;h.value=!0;let o=!1===t,n={...a,allowDelete:1,projectId:l};try{o||delete n.allowDelete;let e=o?await (0,w.XZ)(n):await (0,w.w4)(n);200===e.code&&(g.Z.success("保存成功"),await D())}catch(e){h.value=!1}}async function F(e){h.value=!0;try{let l=await (0,w.Px)(e.id);200===l.code&&(g.Z.success("删除成功"),await D())}catch(e){h.value=!1}}function N(e){let{isEdit:l,item:a}=e;_.value=!1===l,_.value?(Z.value={...x},U.value=!0):(0,w.xS)(a.id).then(e=>{Z.value=(0,v.Z)(e.result,["id","companyId","name","major","jobTitle","chairman","projectRole","department","phone"]),U.value=!0})}async function E(e){h.value=!0;try{let l=await (0,w.Op)(e);200===l.code&&(g.Z.success("删除成功"),await T())}catch(e){h.value=!1}}async function A(){h.value=!0;let e=a.value[0],l={...Z.value,companyId:e};try{let e=_.value?await (0,w.jW)(l):await (0,w.o_)({...l,id:l.id});200===e.code&&(U.value=!1,g.Z.success("保存成功"),await T())}catch(e){h.value=!1}}return(0,f.bv)(()=>{D()}),(e,l)=>{let v=p.Z,w=c.Z,y=m.Z,g=s.Z,_=r.ZP,x=u.ZP,L=d.Z,M=i.ZP,R=n.Z,K=o.Z,Y=t.Z;return(0,f.wg)(),(0,f.iD)(f.HY,null,[(0,f.Wm)(_,{class:"page-card",title:"人员-录入人员基本信息"},{default:(0,f.w5)(()=>[(0,f.Wm)(g,{class:"page-card-lr"},{default:(0,f.w5)(()=>[(0,f.Wm)(w,{class:"pcl",xl:{span:6},lg:{span:8},md:{span:8}},{default:(0,f.w5)(()=>[(0,f.Wm)(v,{modelValue:(0,f.SU)(a),"onUpdate:modelValue":l[0]||(l[0]=e=>(0,f.dq)(a)?a.value=e:null),data:(0,f.SU)(I),"field-names":V,"add-title":"新建团队","edit-title":"编辑团队",onQuery:D,onUpdate:C,onDelete:F},null,8,["modelValue","data"])]),_:1}),(0,f.Wm)(w,{class:"pcr",xl:{span:18},lg:{span:16},md:{span:16}},{default:(0,f.w5)(()=>[(0,f.Wm)(y,{loading:(0,f.SU)(h),columns:H,data:(0,f.SU)(P),total:(0,f.SU)(j).total,current:(0,f.SU)(j).current,"add-text":"添加",onQuery:T,onUpdate:N,onDelete:E},null,8,["loading","data","total","current"])]),_:1})]),_:1})]),_:1}),(0,f.Wm)(Y,{modelValue:(0,f.SU)(U),"onUpdate:modelValue":l[8]||(l[8]=e=>(0,f.dq)(U)?U.value=e:null),"form-ref":(0,f.SU)(k),title:(0,f.SU)(q),"ok-loading":(0,f.SU)(h),onOk:A},{default:(0,f.w5)(()=>[(0,f.Wm)(K,{ref_key:"formRef",ref:k,model:(0,f.SU)(Z),"auto-label-width":""},{default:(0,f.w5)(()=>[(0,f.Wm)(L,{label:"姓名",field:"name","show-colon":"",rules:z},{default:(0,f.w5)(()=>[(0,f.Wm)(x,{modelValue:(0,f.SU)(Z).name,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,f.SU)(Z).name=e),modelModifiers:{trim:!0},"max-length":50,"allow-clear":""},null,8,["modelValue"])]),_:1},8,["rules"]),(0,f.Wm)(L,{label:"专业",field:"major","show-colon":""},{default:(0,f.w5)(()=>[(0,f.Wm)(M,{modelValue:(0,f.SU)(Z).major,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,f.SU)(Z).major=e),options:S,"allow-search":"","allow-create":"","allow-clear":"",placeholder:"请选择或输入专业"},null,8,["modelValue"])]),_:1}),(0,f.Wm)(L,{label:"职务",field:"jobTitle","show-colon":""},{default:(0,f.w5)(()=>[(0,f.Wm)(M,{modelValue:(0,f.SU)(Z).jobTitle,"onUpdate:modelValue":l[3]||(l[3]=e=>(0,f.SU)(Z).jobTitle=e),options:W,"allow-search":"","allow-create":"","allow-clear":"",placeholder:"请选择或输入职务"},null,8,["modelValue"])]),_:1}),(0,f.Wm)(L,{label:"联系方式",field:"phone","show-colon":""},{default:(0,f.w5)(()=>[(0,f.Wm)(x,{modelValue:(0,f.SU)(Z).phone,"onUpdate:modelValue":l[4]||(l[4]=e=>(0,f.SU)(Z).phone=e),modelModifiers:{trim:!0},"max-length":20,"allow-clear":""},null,8,["modelValue"])]),_:1}),(0,f.Wm)(L,{label:"项目角色",field:"projectRole","show-colon":"",rules:z},{default:(0,f.w5)(()=>[(0,f.Wm)(M,{modelValue:(0,f.SU)(Z).projectRole,"onUpdate:modelValue":l[5]||(l[5]=e=>(0,f.SU)(Z).projectRole=e),options:b,"allow-search":"","allow-create":"","allow-clear":"",placeholder:"请选择或输入项目角色"},null,8,["modelValue"])]),_:1},8,["rules"]),(0,f.Wm)(L,{label:"单位",field:"department","show-colon":""},{default:(0,f.w5)(()=>[(0,f.Wm)(x,{modelValue:(0,f.SU)(Z).department,"onUpdate:modelValue":l[6]||(l[6]=e=>(0,f.SU)(Z).department=e),modelModifiers:{trim:!0},"max-length":50,"allow-clear":""},null,8,["modelValue"])]),_:1}),(0,f.Wm)(L,{label:"主席",field:"chairman","show-colon":""},{default:(0,f.w5)(()=>[(0,f.Wm)(R,{modelValue:(0,f.SU)(Z).chairman,"onUpdate:modelValue":l[7]||(l[7]=e=>(0,f.SU)(Z).chairman=e),"checked-value":1,"unchecked-value":0},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","form-ref","title","ok-loading"])],64)}}})},46663:function(e,l,a){a.r(l),a.d(l,{default:()=>U});var t=a(56299);a(53857);var o=a(40098);a(86911);var n=a(59643);a(30858);var i=a(94140);a(76270);var d=a(10849),u=a(74953);a(38499);var r=a(7316);a(92920);var s=a(35586),m=a(36178);a(45264);var c=a(65754);let p=a.p+"static/image/avatar.8a7bbc12.png";var f=a(97562),v=a(30530),w=a(23565);let y={class:"ac-l"},g=["src"],h=(0,c.aZ)({__name:"user",setup(e){let l=(0,f.L)(),{user:a}=(0,v.Jk)(l),h={workNo:[{required:!0,message:"请输入账号"}],username:[{required:!0,message:"请输入姓名"}],email:[{required:!0,message:"请输入邮箱"}]},U=(0,c.qj)({workNo:a.value.workNo||"",username:a.value.realname||"",email:a.value.email||""}),_=(0,c.iH)(!1),k=(0,c.iH)(),b=(0,c.Fl)(()=>{var e;return(null==(e=a.value)?void 0:e.avatarUrl)||p});function S(e){_.value=!0,setTimeout(()=>{_.value=!1,w.Z.success("更新成功")},500)}function W(){k.value.resetFields(),w.Z.success("重置成功")}return(e,l)=>{let a=m.ZP,p=s.Z,f=r.Z,v=u.ZP,w=d.Z,V=i.Z,x=n.Z,Z=o.Z,I=t.Z;return(0,c.wg)(),(0,c.j4)(a,{class:"app-card",title:"个人中心"},{default:(0,c.w5)(()=>[(0,c.Wm)(I,{gutter:16},{default:(0,c.w5)(()=>[(0,c.Wm)(p,{span:8},{default:(0,c.w5)(()=>[(0,c.Wm)(a,null,{default:(0,c.w5)(()=>[(0,c._)("div",y,[(0,c._)("img",{src:(0,c.SU)(b),draggable:"false"},null,8,g)])]),_:1})]),_:1}),(0,c.Wm)(p,{span:16},{default:(0,c.w5)(()=>[(0,c.Wm)(a,null,{default:(0,c.w5)(()=>[(0,c.Wm)(f,{title:"用户信息"}),(0,c.Wm)(Z,{ref_key:"userFormRef",ref:k,model:(0,c.SU)(U),rules:h,"auto-label-width":"",onSubmitSuccess:S},{default:(0,c.w5)(()=>[(0,c.Wm)(w,{field:"workNo",label:"账号"},{default:(0,c.w5)(()=>[(0,c.Wm)(v,{modelValue:(0,c.SU)(U).workNo,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,c.SU)(U).workNo=e),modelModifiers:{trim:!0},readonly:""},null,8,["modelValue"])]),_:1}),(0,c.Wm)(w,{field:"username",label:"姓名"},{default:(0,c.w5)(()=>[(0,c.Wm)(v,{modelValue:(0,c.SU)(U).username,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,c.SU)(U).username=e),modelModifiers:{trim:!0},"max-length":32,"allow-clear":"",readonly:""},null,8,["modelValue"])]),_:1}),(0,c.Wm)(w,{field:"email",label:"邮箱"},{default:(0,c.w5)(()=>[(0,c.Wm)(v,{modelValue:(0,c.SU)(U).email,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,c.SU)(U).email=e),modelModifiers:{trim:!0},"max-length":64,"allow-clear":"",readonly:""},null,8,["modelValue"])]),_:1}),(0,c.Wm)(w,null,{default:(0,c.w5)(()=>[(0,c.Wm)(x,null,{default:(0,c.w5)(()=>[(0,c.Wm)(V,{type:"primary","html-type":"submit",disabled:"",loading:(0,c.SU)(_)},{default:(0,c.w5)(()=>l[3]||(l[3]=[(0,c.Uk)(" 更新 ",-1)])),_:1,__:[3]},8,["loading"]),(0,c.Wm)(V,{disabled:"",onClick:W},{default:(0,c.w5)(()=>l[4]||(l[4]=[(0,c.Uk)(" 重置 ",-1)])),_:1,__:[4]})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})]),_:1})]),_:1})}}}),U=(0,a(8163).default)(h,[["__scopeId","data-v-2d0c52a3"]])},94289:function(e,l,a){a.d(l,{Z:()=>v});var t=a(65754),o=a(57546),n=a(14863),i=a(78970),d=a(45334),u=a(70392),r=a(16810),s=a(57282),m=a(59551),c=a(7061),p=a(9286),f=a(30530);let v=(0,t.aZ)({__name:"chart-pie",props:{data:{type:Array,default:()=>[]},type:{type:String,default:"name"},projectId:{type:String,default:""}},setup(e,l){let{expose:a}=l;u.D([n.N,i.N,d.N,o.N,m.N,s.T]);let v=(0,p.F)(),{itemsType:w}=(0,f.Jk)(v),{snapUpload:y}=(0,c.V)(),g=null,h=(0,t.iH)(null),U={tooltip:{trigger:"item"},legend:{orient:"horizontal",bottom:"bottom"},series:{label:{show:!0,position:"outside",formatter:"{b}：{c}（{d}%）"},name:"HAZOP结果分析",type:"pie",radius:"75%",data:[],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}};function _(e){Object.assign(U.series,{data:e}),g||(g=r.S1(h.value)),g.setOption(U)}function k(){g&&g.resize()}async function b(){try{let l=`${e.projectId?e.projectId:w.value}-pie-chart.png`,a=await y(h.value,l);if(a)return a}catch(e){throw Error("PieChart: 保存图片失败")}}return(0,t.bv)(()=>{(0,t.Y3)(()=>_(e.data)),addEventListener("resize",k)}),(0,t.ic)(()=>{_(e.data)}),(0,t.Jd)(()=>{g&&g.dispose(),removeEventListener("resize",k)}),a({uploadImage:b}),(e,l)=>((0,t.wg)(),(0,t.iD)("div",{ref_key:"chartRef",ref:h,style:{width:"100%",height:"400px"}},null,512))}})},82127:function(e,l,a){a.r(l),a.d(l,{default:()=>c});var t=a(86033);a(15745);var o=a(65754),n=a(36186),i=a(52603),d=a(99008),u=a(89847),r=a(57032),s=a(23565);let m=(0,o.aZ)({__name:"hazop",setup(e){let{configStore:l,dataStore:a,baseData:m}=(0,r.d)(),c=(0,o.iH)(null),p=(0,o.iH)(!1),f=(0,o.iH)(!0),v=(0,o.iH)(!0),w=(0,o.iH)(["0"]),y=(0,o.iH)([]),g=(0,o.iH)(["0"]),h=(0,o.iH)(null),U=(0,o.iH)(null),_=(0,o.Fl)(()=>f.value||v.value?!f.value&&v.value?"hl":f.value&&!v.value?"hr":"":"hlr");async function k(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],l=async e=>{p.value=!1},t=async()=>{try{let e=await (0,n.iX)();if(200===e.code){let t=e.result||{},n=(null==t?void 0:t.children)||[];a.setHazopList(n),y.value.length>0&&y.value.splice(0),y.value.push(t),(null==t?void 0:t.children.length)>0&&l(t.children[0].key),(0,o.Y3)(()=>null==c?void 0:c.value.handleFold(!0))}}finally{p.value=!1}};p.value||(p.value=!0);let i=e.length?e[0]:"";i?await l(i):await t(),p.value=!1}async function b(e){p.value=!0;try{let l=await (0,n.vf)(e.key);200===l.code&&(s.Z.success("删除成功"),await k())}catch(e){p.value=!1}}async function S(){p.value=!0,f.value=l.status.tree,v.value=l.status.form,await m(),await k()}function W(e){h.value=e.nodeId,U.value=e.nodeType}return(0,o.bv)(()=>{S()}),(e,l)=>{let a=t.Z;return(0,o.wg)(),(0,o.j4)(a,{loading:(0,o.SU)(p),dot:"",tip:"数据加载中"},{default:(0,o.w5)(()=>[(0,o._)("div",{class:(0,o.C_)(["page-wrap",(0,o.SU)(_)])},[(0,o.wy)((0,o.Wm)(u.Z,{ref_key:"oTreeRef",ref:c,modelValue:(0,o.SU)(w),"onUpdate:modelValue":l[0]||(l[0]=e=>(0,o.dq)(w)?w.value=e:null),title:"HAZOP分析",data:(0,o.SU)(y),expand:(0,o.SU)(g),"is-hazop":"",onQuery:k,onDelete:b},null,8,["modelValue","data","expand"]),[[o.F8,(0,o.SU)(f)]]),(0,o.Wm)(i.Z,{tree:(0,o.SU)(f),"onUpdate:tree":l[1]||(l[1]=e=>(0,o.dq)(f)?f.value=e:null),form:(0,o.SU)(v),"onUpdate:form":l[2]||(l[2]=e=>(0,o.dq)(v)?v.value=e:null),"is-hazop":"",onUpdate:W},null,8,["tree","form"]),(0,o.SU)(v)?((0,o.wg)(),(0,o.j4)(d.Z,{key:0,"node-id":(0,o.SU)(h),"node-type":(0,o.SU)(U),"is-hazop":""},null,8,["node-id","node-type"])):(0,o.kq)("",!0)],2)]),_:1},8,["loading"])}}}),c=(0,a(8163).default)(m,[["__scopeId","data-v-aef87a00"]])},6612:function(e,l,a){a.d(l,{Z:()=>i});var t=a(77504);a(15480);var o=a(65754),n=a(2330);let i=(0,o.aZ)({__name:"jump-device",props:{modelValue:{},modelModifiers:{}},emits:(0,o.Vf)(["update"],["update:modelValue"]),setup(e,l){let{emit:a}=l,i=(0,o.tT)(e,"modelValue"),d=(0,o.qj)({height:"94dvh",width:"75dvw"}),u=(0,o.qj)({padding:"5px",height:"calc(100% - 66px)"});function r(){a("update")}return(e,l)=>{let a=t.Z;return(0,o.wg)(),(0,o.j4)(a,{visible:i.value,"onUpdate:visible":l[0]||(l[0]=e=>i.value=e),"modal-style":(0,o.SU)(d),"body-style":(0,o.SU)(u),"unmount-on-close":!0,"mask-closable":!1,closable:!1,"esc-to-close":!1,"hide-title":!0,onClose:r},{default:(0,o.w5)(()=>[(0,o.Wm)(n.default)]),_:1},8,["visible","modal-style","body-style"])}}})},51956:function(e,l,a){a.r(l),a.d(l,{default:()=>h});var t=a(34945),o=a(40098);a(86911);var n=a(10849),i=a(74953);a(38499);var d=a(36178);a(45264);var u=a(56299);a(53857);var r=a(56655),s=a(94140);a(76270);var m=a(35586),c=a(23490),p=a(65754),f=a(35214),v=a(35373),w=a(9286),y=a(6612),g=a(23565);let h=(0,p.aZ)({__name:"reason",setup(e){let l=(0,w.F)().itemsType,a=[],h=(0,p.iH)(["0"]),U=(0,p.iH)(!1),_=(0,p.iH)(!1),k=(0,p.iH)(!1),b=(0,p.iH)(!1),S=(0,p.iH)(null),W={key:"id",title:"name"},V={id:null,knowledgeData:"",knowledgeValue:""},x=(0,p.iH)({...V}),Z={required:!0,message:"必填项不能为空",trigger:"blur"},I=(0,p.iH)([]),H=[{title:"原因",dataIndex:"knowledgeData"},{align:"center",title:"发生概率/a^-1",width:128,dataIndex:"knowledgeValue"}],P=(0,p.iH)([]),j=(0,p.qj)({total:0,current:1}),z=(0,p.Fl)(()=>b.value?"新建原因":"编辑原因");async function q(e){let l=async()=>{U.value=!0;try{let e=await (0,f.GV)();if(200===e.code){let l=e.result||[];I.value.length>0&&I.value.splice(0),h.value[0]="0",l.length>0?(I.value=[{id:"0",name:"一般原因"},...l],await T()):U.value=!1}}finally{U.value=!1}};e?T():l()}async function T(e){U.value||(U.value=!0),P.value.length>0&&P.value.splice(0);try{let l=h.value[0],a=e?{...e,deviceId:l}:{deviceId:l},t=await (0,v.a0)(a);if(200===t.code){let{records:e,total:l,current:a}=t.result||{};j.total=l||0,j.current=a||1,P.value=e||[]}}finally{U.value=!1}}function D(e){let{isEdit:a,item:t}=e;if(b.value=!1===a,b.value){let e=h.value[0];x.value={...V,projectId:l,deviceId:e},_.value=!0}else(0,v.c9)(t.id).then(e=>{x.value={...e.result||{}},_.value=!0})}async function C(e){U.value=!0;try{let l=await (0,v.yp)(e);200===l.code&&(g.Z.success("删除成功"),await T())}catch(e){U.value=!1}}function F(){k.value=!0}async function N(){U.value=!0;try{let e={...x.value},l=b.value?await (0,v._Z)(e):await (0,v.KD)(e);200===l.code&&(_.value=!1,g.Z.success("保存成功"),await T())}catch(e){U.value=!1}}return(0,p.bv)(()=>{q()}),(e,l)=>{let f=c.Z,v=m.Z,w=s.Z,g=r.Z,b=u.Z,V=d.ZP,E=i.ZP,A=n.Z,L=o.Z,M=t.Z;return(0,p.wg)(),(0,p.iD)(p.HY,null,[(0,p.Wm)(V,{class:"page-card",title:"原因-常见初始原因知识库"},{default:(0,p.w5)(()=>[(0,p.Wm)(b,{class:"page-card-lr"},{default:(0,p.w5)(()=>[(0,p.Wm)(v,{class:"pcl",xl:{span:6},lg:{span:8},md:{span:8}},{default:(0,p.w5)(()=>[(0,p.Wm)(f,{modelValue:(0,p.SU)(h),"onUpdate:modelValue":l[0]||(l[0]=e=>(0,p.dq)(h)?h.value=e:null),auth:a,data:(0,p.SU)(I),"field-names":W,onQuery:q},null,8,["modelValue","data"])]),_:1}),(0,p.Wm)(v,{class:"pcr",xl:{span:18},lg:{span:16},md:{span:16}},{default:(0,p.w5)(()=>[(0,p.Wm)(g,{loading:(0,p.SU)(U),columns:H,data:(0,p.SU)(P),total:(0,p.SU)(j).total,current:(0,p.SU)(j).current,"add-text":"新建原因",onQuery:T,onUpdate:D,onDelete:C},{button:(0,p.w5)(()=>[(0,p.Wm)(w,{type:"primary",status:"warning",onClick:F},{default:(0,p.w5)(()=>l[5]||(l[5]=[(0,p.Uk)(" 转到设备库 ",-1)])),_:1,__:[5]})]),_:1},8,["loading","data","total","current"])]),_:1})]),_:1})]),_:1}),(0,p.Wm)(M,{modelValue:(0,p.SU)(_),"onUpdate:modelValue":l[3]||(l[3]=e=>(0,p.dq)(_)?_.value=e:null),"form-ref":(0,p.SU)(S),title:(0,p.SU)(z),"ok-loading":(0,p.SU)(U),onOk:N},{default:(0,p.w5)(()=>[(0,p.Wm)(L,{ref_key:"formRef",ref:S,model:(0,p.SU)(x),"auto-label-width":""},{default:(0,p.w5)(()=>[(0,p.Wm)(A,{label:"原因",field:"knowledgeData","show-colon":"",rules:Z},{default:(0,p.w5)(()=>[(0,p.Wm)(E,{modelValue:(0,p.SU)(x).knowledgeData,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,p.SU)(x).knowledgeData=e),modelModifiers:{trim:!0},"max-length":100,"allow-clear":""},null,8,["modelValue"])]),_:1},8,["rules"]),(0,p.Wm)(A,{label:"发生概率/a^-1",field:"knowledgeValue","show-colon":"",rules:Z},{default:(0,p.w5)(()=>[(0,p.Wm)(E,{modelValue:(0,p.SU)(x).knowledgeValue,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,p.SU)(x).knowledgeValue=e),modelModifiers:{trim:!0},"max-length":100,"allow-clear":""},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1},8,["model"])]),_:1},8,["modelValue","form-ref","title","ok-loading"]),(0,p.Wm)(y.Z,{modelValue:(0,p.SU)(k),"onUpdate:modelValue":l[4]||(l[4]=e=>(0,p.dq)(k)?k.value=e:null),onUpdate:q},null,8,["modelValue"])],64)}}})},76599:function(e,l,a){a.r(l),a.d(l,{default:()=>h});var t=a(34945),o=a(40098);a(86911);var n=a(10849),i=a(74953);a(38499);var d=a(36178);a(45264);var u=a(56299);a(53857);var r=a(56655),s=a(94140);a(76270);var m=a(35586),c=a(23490),p=a(65754),f=a(35214),v=a(27140),w=a(9286),y=a(6612),g=a(23565);let h=(0,p.aZ)({__name:"result",setup(e){let l=(0,w.F)().itemsType,a=[],h=(0,p.iH)(["0"]),U=(0,p.iH)(!1),_=(0,p.iH)(!1),k=(0,p.iH)(!1),b=(0,p.iH)(!1),S=(0,p.iH)(null),W={key:"id",title:"name"},V={id:null,knowledgeData:""},x=(0,p.iH)({...V}),Z={required:!0,message:"必填项不能为空",trigger:"blur"},I=(0,p.iH)([]),H=[{title:"后果",dataIndex:"knowledgeData"}],P=(0,p.iH)([]),j=(0,p.qj)({total:0,current:1}),z=(0,p.Fl)(()=>b.value?"新建不利后果":"编辑不利后果");async function q(e){let l=async()=>{U.value=!0;try{let e=await (0,f.GV)();if(200===e.code){let l=e.result||[];I.value.length>0&&I.value.splice(0),h.value[0]="0",l.length>0?(I.value=[{id:"0",name:"一般后果"},...l],await T()):U.value=!1}}finally{U.value=!1}};e?T():l()}async function T(e){U.value||(U.value=!0),P.value.length>0&&P.value.splice(0);try{let l=h.value[0],a=e?{...e,deviceId:l}:{deviceId:l},t=await (0,v.Mo)(a);if(200===t.code){let{records:e,total:l,current:a}=t.result||{};j.total=l||0,j.current=a||1,P.value=e||[]}}finally{U.value=!1}}function D(e){let{isEdit:a,item:t}=e;if(b.value=!1===a,b.value){let e=h.value[0];x.value={...V,projectId:l,deviceId:e},_.value=!0}else(0,v.wu)(t.id).then(e=>{x.value={...e.result||{}},_.value=!0})}async function C(e){U.value=!0;try{let l=await (0,v.TE)(e);200===l.code&&(g.Z.success("删除成功"),await T())}catch(e){U.value=!1}}function F(){k.value=!0}async function N(){U.value=!0;try{let e={...x.value},l=b.value?await (0,v.JF)(e):await (0,v.Op)(e);200===l.code&&(_.value=!1,g.Z.success("保存成功"),await T())}catch(e){U.value=!1}}return(0,p.bv)(()=>{q()}),(e,l)=>{let f=c.Z,v=m.Z,w=s.Z,g=r.Z,b=u.Z,V=d.ZP,E=i.ZP,A=n.Z,L=o.Z,M=t.Z;return(0,p.wg)(),(0,p.iD)(p.HY,null,[(0,p.Wm)(V,{class:"page-card",title:"不利后果-常见不利后果知识库"},{default:(0,p.w5)(()=>[(0,p.Wm)(b,{class:"page-card-lr"},{default:(0,p.w5)(()=>[(0,p.Wm)(v,{class:"pcl",xl:{span:6},lg:{span:8},md:{span:8}},{default:(0,p.w5)(()=>[(0,p.Wm)(f,{modelValue:(0,p.SU)(h),"onUpdate:modelValue":l[0]||(l[0]=e=>(0,p.dq)(h)?h.value=e:null),auth:a,data:(0,p.SU)(I),"field-names":W,onQuery:q},null,8,["modelValue","data"])]),_:1}),(0,p.Wm)(v,{class:"pcr",xl:{span:18},lg:{span:16},md:{span:16}},{default:(0,p.w5)(()=>[(0,p.Wm)(g,{loading:(0,p.SU)(U),columns:H,data:(0,p.SU)(P),total:(0,p.SU)(j).total,current:(0,p.SU)(j).current,"add-text":"新建不利后果",onQuery:T,onUpdate:D,onDelete:C},{button:(0,p.w5)(()=>[(0,p.Wm)(w,{type:"primary",status:"warning",onClick:F},{default:(0,p.w5)(()=>l[4]||(l[4]=[(0,p.Uk)(" 转到设备库 ",-1)])),_:1,__:[4]})]),_:1},8,["loading","data","total","current"])]),_:1})]),_:1})]),_:1}),(0,p.Wm)(M,{modelValue:(0,p.SU)(_),"onUpdate:modelValue":l[2]||(l[2]=e=>(0,p.dq)(_)?_.value=e:null),"form-ref":(0,p.SU)(S),title:(0,p.SU)(z),"ok-loading":(0,p.SU)(U),onOk:N},{default:(0,p.w5)(()=>[(0,p.Wm)(L,{ref_key:"formRef",ref:S,model:(0,p.SU)(x),"auto-label-width":""},{default:(0,p.w5)(()=>[(0,p.Wm)(L,{ref_key:"formRef",ref:S,model:(0,p.SU)(x),"auto-label-width":""},{default:(0,p.w5)(()=>[(0,p.Wm)(A,{label:"不利后果",field:"knowledgeData","show-colon":"",rules:Z},{default:(0,p.w5)(()=>[(0,p.Wm)(E,{modelValue:(0,p.SU)(x).knowledgeData,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,p.SU)(x).knowledgeData=e),modelModifiers:{trim:!0},"max-length":100,"allow-clear":""},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1},8,["model"])]),_:1},8,["model"])]),_:1},8,["modelValue","form-ref","title","ok-loading"]),(0,p.Wm)(y.Z,{modelValue:(0,p.SU)(k),"onUpdate:modelValue":l[3]||(l[3]=e=>(0,p.dq)(k)?k.value=e:null),onUpdate:q},null,8,["modelValue"])],64)}}})},31940:function(e,l,a){a.r(l),a.d(l,{default:()=>h});var t=a(34945),o=a(40098);a(86911);var n=a(10849),i=a(74953);a(38499);var d=a(36178);a(45264);var u=a(56299);a(53857);var r=a(56655),s=a(94140);a(76270);var m=a(35586),c=a(23490),p=a(65754),f=a(35214),v=a(22570),w=a(9286),y=a(6612),g=a(23565);let h=(0,p.aZ)({__name:"safety",setup(e){let l=(0,w.F)().itemsType,a=[],h=(0,p.iH)(["0"]),U=(0,p.iH)(!1),_=(0,p.iH)(!1),k=(0,p.iH)(!1),b=(0,p.iH)(!1),S=(0,p.iH)(null),W={key:"id",title:"name"},V={id:null,knowledgeData:"",knowledgeValue:""},x=(0,p.iH)({...V}),Z={required:!0,message:"必填项不能为空",trigger:"blur"},I=(0,p.iH)([]),H=[{title:"措施",dataIndex:"knowledgeData"},{align:"center",title:"频率消减因子",width:128,dataIndex:"knowledgeValue"}],P=(0,p.iH)([]),j=(0,p.qj)({total:0,current:1}),z=(0,p.Fl)(()=>b.value?"新建措施":"编辑措施");async function q(e){let l=async()=>{U.value=!0;try{let e=await (0,f.GV)();if(200===e.code){let l=e.result||[];I.value.length>0&&I.value.splice(0),h.value[0]="0",l.length>0?(I.value=[{id:"0",name:"一般安全措施"},...l],await T()):U.value=!1}}finally{U.value=!1}};e?T():l()}async function T(e){U.value||(U.value=!0),P.value.length>0&&P.value.splice(0);try{let l=h.value[0],a=e?{...e,deviceId:l}:{deviceId:l},t=await (0,v.MX)(a);if(200===t.code){let{records:e,total:l,current:a}=t.result||{};j.total=l||0,j.current=a||1,P.value=e||[]}}finally{U.value=!1}}function D(e){let{isEdit:a,item:t}=e;if(b.value=!1===a,b.value){let e=h.value[0];x.value={...V,projectId:l,deviceId:e},_.value=!0}else(0,v.PP)(t.id).then(e=>{x.value={...e.result||{}},_.value=!0})}async function C(e){U.value=!0;try{let l=await (0,v.M8)(e);200===l.code&&(g.Z.success("删除成功"),await T())}catch(e){U.value=!1}}function F(){k.value=!0}async function N(){U.value=!0;try{let e={...x.value},l=b.value?await (0,v.pc)(e):await (0,v.$b)(e);200===l.code&&(_.value=!1,g.Z.success("保存成功"),await T())}catch(e){U.value=!1}}return(0,p.bv)(()=>{q()}),(e,l)=>{let f=c.Z,v=m.Z,w=s.Z,g=r.Z,b=u.Z,V=d.ZP,E=i.ZP,A=n.Z,L=o.Z,M=t.Z;return(0,p.wg)(),(0,p.iD)(p.HY,null,[(0,p.Wm)(V,{class:"page-card",title:"安全措施-常见安全措施知识库"},{default:(0,p.w5)(()=>[(0,p.Wm)(b,{class:"page-card-lr"},{default:(0,p.w5)(()=>[(0,p.Wm)(v,{class:"pcl",xl:{span:6},lg:{span:8},md:{span:8}},{default:(0,p.w5)(()=>[(0,p.Wm)(f,{modelValue:(0,p.SU)(h),"onUpdate:modelValue":l[0]||(l[0]=e=>(0,p.dq)(h)?h.value=e:null),auth:a,data:(0,p.SU)(I),"field-names":W,onQuery:q},null,8,["modelValue","data"])]),_:1}),(0,p.Wm)(v,{class:"pcr",xl:{span:18},lg:{span:16},md:{span:16}},{default:(0,p.w5)(()=>[(0,p.Wm)(g,{loading:(0,p.SU)(U),columns:H,data:(0,p.SU)(P),total:(0,p.SU)(j).total,current:(0,p.SU)(j).current,"add-text":"新建措施",onQuery:T,onUpdate:D,onDelete:C},{button:(0,p.w5)(()=>[(0,p.Wm)(w,{type:"primary",status:"warning",onClick:F},{default:(0,p.w5)(()=>l[5]||(l[5]=[(0,p.Uk)(" 转到设备库 ",-1)])),_:1,__:[5]})]),_:1},8,["loading","data","total","current"])]),_:1})]),_:1})]),_:1}),(0,p.Wm)(M,{modelValue:(0,p.SU)(_),"onUpdate:modelValue":l[3]||(l[3]=e=>(0,p.dq)(_)?_.value=e:null),"form-ref":(0,p.SU)(S),title:(0,p.SU)(z),"ok-loading":(0,p.SU)(U),onOk:N},{default:(0,p.w5)(()=>[(0,p.Wm)(L,{ref_key:"formRef",ref:S,model:(0,p.SU)(x),"auto-label-width":""},{default:(0,p.w5)(()=>[(0,p.Wm)(A,{label:"措施",field:"knowledgeData","show-colon":"",rules:Z},{default:(0,p.w5)(()=>[(0,p.Wm)(E,{modelValue:(0,p.SU)(x).knowledgeData,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,p.SU)(x).knowledgeData=e),modelModifiers:{trim:!0},"max-length":100,"allow-clear":""},null,8,["modelValue"])]),_:1},8,["rules"]),(0,p.Wm)(A,{label:"频率消减因子",field:"knowledgeValue","show-colon":"",rules:Z},{default:(0,p.w5)(()=>[(0,p.Wm)(E,{modelValue:(0,p.SU)(x).knowledgeValue,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,p.SU)(x).knowledgeValue=e),modelModifiers:{trim:!0},"max-length":100,"allow-clear":""},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1},8,["model"])]),_:1},8,["modelValue","form-ref","title","ok-loading"]),(0,p.Wm)(y.Z,{modelValue:(0,p.SU)(k),"onUpdate:modelValue":l[4]||(l[4]=e=>(0,p.dq)(k)?k.value=e:null),onUpdate:q},null,8,["modelValue"])],64)}}})},5042:function(e,l,a){a.r(l),a.d(l,{default:()=>S});var t=a(251);a(84595);var o=a(36178);a(45264);var n=a(40098);a(86911);var i=a(94140);a(76270);var d=a(93749);a(65470);var u=a(34406),r=a(1221);a(38499);var s=a(1385),m=a(10849),c=a(74953),p=a(18593),f=a(65754),v=a(91229),w=a(47164),y=a(97562),g=a(85674),h=a(52979),U=a(30530);let _={class:"app-login"},k=["src"],b=(0,f.aZ)({__name:"login",setup(e){let l=(0,h.tv)(),a=(0,y.L)(),{login:b}=(0,U.Jk)(a),S=(0,f.iH)(!1),W=(0,f.qj)({username:"",password:"",code:""}),V=(0,f.qj)({open:!1,img:"",uuid:""}),x={username:[{required:!0,message:"请输入账号"}],password:[{required:!0,message:"请输入密码"}]},Z=(0,f.qj)({span:0}),I=(0,f.qj)({span:24}),H=(0,v.Z)(async()=>{let e=await (0,w.Xs)();if(200===e.code){let{captchaEnabled:l,img:a,uuid:t}=e.result||{};Object.assign(V,{open:l,img:`data:image/png;base64,${a}`,uuid:t})}},200);async function P(e){S.value=!0;try{let t={checkCode:e.code,captchaUUID:V.uuid,username:e.username,password:(0,g.IA)(e.password,b.value.k,b.value.v)},o=await (0,w.yE)(t);if(200===o.code){let{token:e,userInfo:t}=o.result||{};(0,g.o4)(e),a.setToken(e),a.setUser(t),l.replace("/")}}catch(e){H()}finally{S.value=!1}}return(0,f.wF)(()=>{H()}),(e,l)=>{let a=p.Z,v=c.ZP,w=m.Z,y=s.Z,g=r.Z,h=u.Z,U=d.Z,b=i.Z,j=n.Z,z=o.ZP,q=t.Z;return(0,f.wg)(),(0,f.iD)("main",_,[(0,f.Wm)(z,{class:"app-login-card"},{title:(0,f.w5)(()=>l[4]||(l[4]=[(0,f._)("div",{class:"al-title"}," 系统登录 ",-1)])),default:(0,f.w5)(()=>[(0,f.Wm)(j,{model:(0,f.SU)(W),rules:x,disabled:(0,f.SU)(S),"label-col-props":(0,f.SU)(Z),"wrapper-col-props":(0,f.SU)(I),"auto-label-width":"",size:"large",onSubmitSuccess:P},{default:(0,f.w5)(()=>[(0,f.Wm)(w,{field:"username","hide-asterisk":""},{default:(0,f.w5)(()=>[(0,f.Wm)(v,{modelValue:(0,f.SU)(W).username,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,f.SU)(W).username=e),modelModifiers:{trim:!0},"max-length":32,placeholder:"账号","allow-clear":""},{prefix:(0,f.w5)(()=>[(0,f.Wm)(a)]),_:1},8,["modelValue"])]),_:1}),(0,f.Wm)(w,{field:"password","hide-asterisk":""},{default:(0,f.w5)(()=>[(0,f.Wm)(g,{modelValue:(0,f.SU)(W).password,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,f.SU)(W).password=e),modelModifiers:{trim:!0},"max-length":32,placeholder:"密码","allow-clear":""},{prefix:(0,f.w5)(()=>[(0,f.Wm)(y)]),_:1},8,["modelValue"])]),_:1}),(0,f.Wm)(w,{field:"code","hide-asterisk":""},{default:(0,f.w5)(()=>[(0,f.SU)(V).open?((0,f.wg)(),(0,f.j4)(v,{key:0,modelValue:(0,f.SU)(W).code,"onUpdate:modelValue":l[3]||(l[3]=e=>(0,f.SU)(W).code=e),modelModifiers:{trim:!0},"max-length":4,placeholder:"验证码","allow-clear":""},{prefix:(0,f.w5)(()=>[(0,f.Wm)(h)]),append:(0,f.w5)(()=>[(0,f.Wm)(U,{content:"点击更换验证码",position:"tr"},{default:(0,f.w5)(()=>[(0,f._)("img",{class:"al-code",src:(0,f.SU)(V).img,draggable:"false",onClick:l[2]||(l[2]=(0,f.iM)(function(){for(var e=arguments.length,l=Array(e),a=0;a<e;a++)l[a]=arguments[a];return(0,f.SU)(H)&&(0,f.SU)(H)(...l)},["stop"]))},null,8,k)]),_:1})]),_:1},8,["modelValue"])):(0,f.kq)("",!0)]),_:1}),(0,f.Wm)(w,null,{default:(0,f.w5)(()=>[(0,f.Wm)(b,{type:"primary",long:"","html-type":"submit",loading:(0,f.SU)(S)},{default:(0,f.w5)(()=>l[5]||(l[5]=[(0,f.Uk)(" 登录 ",-1)])),_:1,__:[5]},8,["loading"])]),_:1})]),_:1},8,["model","disabled","label-col-props","wrapper-col-props"])]),_:1}),(0,f.Wm)(q,{class:"app-login-footer"},{default:(0,f.w5)(()=>l[6]||(l[6]=[(0,f._)("span",null,"\xa9 北京欧倍尔软件技术开发有限公司",-1)])),_:1,__:[6]})])}}}),S=(0,a(8163).default)(b,[["__scopeId","data-v-8fbc274e"]])},73477:function(e,l,a){a.r(l),a.d(l,{default:()=>m});var t=a(86033);a(15745);var o=a(65754),n=a(83689),i=a(52603),d=a(99008),u=a(89847),r=a(57032);let s=(0,o.aZ)({__name:"lopa",setup(e){let{configStore:l,dataStore:a,baseData:s}=(0,r.d)(),m=(0,o.iH)(null),c=(0,o.iH)(!1),p=(0,o.iH)(!0),f=(0,o.iH)(!0),v=(0,o.iH)(["0"]),w=(0,o.iH)([]),y=(0,o.iH)([]),g=(0,o.iH)(["0"]),h=(0,o.iH)(null),U=(0,o.iH)(null),_=(0,o.Fl)(()=>p.value||f.value?!p.value&&f.value?"hl":p.value&&!f.value?"hr":"":"hlr");async function k(){c.value||(c.value=!0);try{let t=await (0,n.uJ)(),i="";if(200===t.code){var e,l;let a=t.result||{};y.value.length>0&&y.value.splice(0),y.value.push(a),v.value=[a.key],i=(null==(l=a.children[0])||null==(e=l.children[0])?void 0:e.parentId)||"",(0,o.Y3)(()=>null==m?void 0:m.value.handleFold(!0))}a.setLopaId(i)}finally{c.value=!1}}function b(e){}async function S(){c.value=!0,p.value=l.status.tree,f.value=l.status.form,await s(),await k()}function W(e){h.value=e.nodeId,U.value=e.nodeType}return(0,o.bv)(()=>{S()}),(e,l)=>{let a=t.Z;return(0,o.wg)(),(0,o.j4)(a,{loading:(0,o.SU)(c),dot:"",tip:"数据加载中"},{default:(0,o.w5)(()=>[(0,o._)("div",{class:(0,o.C_)(["page-wrap",(0,o.SU)(_)])},[(0,o.wy)((0,o.Wm)(u.Z,{ref_key:"oTreeRef",ref:m,modelValue:(0,o.SU)(v),"onUpdate:modelValue":l[0]||(l[0]=e=>(0,o.dq)(v)?v.value=e:null),title:"LOPA分析",data:(0,o.SU)(y),auth:(0,o.SU)(w),expand:(0,o.SU)(g),onQuery:b},null,8,["modelValue","data","auth","expand"]),[[o.F8,(0,o.SU)(p)]]),(0,o.Wm)(i.Z,{tree:(0,o.SU)(p),"onUpdate:tree":l[1]||(l[1]=e=>(0,o.dq)(p)?p.value=e:null),form:(0,o.SU)(f),"onUpdate:form":l[2]||(l[2]=e=>(0,o.dq)(f)?f.value=e:null),onUpdate:W},null,8,["tree","form"]),(0,o.SU)(f)?((0,o.wg)(),(0,o.j4)(d.Z,{key:0,"node-id":(0,o.SU)(h),"node-type":(0,o.SU)(U)},null,8,["node-id","node-type"])):(0,o.kq)("",!0)],2)]),_:1},8,["loading"])}}}),m=(0,a(8163).default)(s,[["__scopeId","data-v-46c75930"]])}},l={};function a(t){var o=l[t];if(void 0!==o)return o.exports;var n=l[t]={exports:{}};return e[t].call(n.exports,n,n.exports,a),n.exports}a.m=e,a.n=e=>{var l=e&&e.__esModule?()=>e.default:()=>e;return a.d(l,{a:l}),l},a.d=(e,l)=>{for(var t in l)a.o(l,t)&&!a.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:l[t]})},a.g=(()=>{if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(e){if("object"==typeof window)return window}})(),a.o=(e,l)=>Object.prototype.hasOwnProperty.call(e,l),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e=[];a.O=(l,t,o,n)=>{if(t){n=n||0;for(var i=e.length;i>0&&e[i-1][2]>n;i--)e[i]=e[i-1];e[i]=[t,o,n];return}for(var d=1/0,i=0;i<e.length;i++){for(var[t,o,n]=e[i],u=!0,r=0;r<t.length;r++)(!1&n||d>=n)&&Object.keys(a.O).every(e=>a.O[e](t[r]))?t.splice(r--,1):(u=!1,n<d&&(d=n));if(u){e.splice(i--,1);var s=o();void 0!==s&&(l=s)}}return l}})(),a.p="/",(()=>{var e={980:0};a.O.j=l=>0===e[l];var l=(l,t)=>{var o,n,[i,d,u]=t,r=0;if(i.some(l=>0!==e[l])){for(o in d)a.o(d,o)&&(a.m[o]=d[o]);if(u)var s=u(a)}for(l&&l(t);r<i.length;r++)n=i[r],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return a.O(s)},t=self.webpackChunkhazop_fe=self.webpackChunkhazop_fe||[];t.forEach(l.bind(null,0)),t.push=l.bind(null,t.push.bind(t))})();var t=a.O(void 0,["797","314","53","805","122","845","454","12","887","961","634"],function(){return a(92094)});t=a.O(t)})();